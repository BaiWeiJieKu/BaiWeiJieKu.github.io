I"ïI<ul id="markdown-toc">
  <li><a href="#è¯­æ³•ç‰¹ç‚¹" id="markdown-toc-è¯­æ³•ç‰¹ç‚¹">è¯­æ³•ç‰¹ç‚¹</a></li>
  <li><a href="#æ ‡é‡å­æŸ¥è¯¢" id="markdown-toc-æ ‡é‡å­æŸ¥è¯¢">æ ‡é‡å­æŸ¥è¯¢</a></li>
  <li><a href="#åˆ—å­æŸ¥è¯¢" id="markdown-toc-åˆ—å­æŸ¥è¯¢">åˆ—å­æŸ¥è¯¢</a></li>
  <li><a href="#è¡Œå­æŸ¥è¯¢" id="markdown-toc-è¡Œå­æŸ¥è¯¢">è¡Œå­æŸ¥è¯¢</a></li>
  <li><a href="#selectå" id="markdown-toc-selectå">selectå</a></li>
  <li><a href="#fromå" id="markdown-toc-fromå">fromå</a></li>
  <li><a href="#existså" id="markdown-toc-existså">existså</a></li>
  <li><a href="#ç»ƒä¹ " id="markdown-toc-ç»ƒä¹ ">ç»ƒä¹ </a></li>
</ul>
<h2 id="è¯­æ³•ç‰¹ç‚¹">è¯­æ³•ç‰¹ç‚¹</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å«ä¹‰ï¼š
å‡ºç°åœ¨å…¶ä»–è¯­å¥ä¸­çš„selectè¯­å¥ï¼Œç§°ä¸ºå­æŸ¥è¯¢æˆ–å†…æŸ¥è¯¢
å¤–éƒ¨çš„æŸ¥è¯¢è¯­å¥ï¼Œç§°ä¸ºä¸»æŸ¥è¯¢æˆ–å¤–æŸ¥è¯¢

åˆ†ç±»ï¼š
æŒ‰å­æŸ¥è¯¢å‡ºç°çš„ä½ç½®ï¼š
	selectåé¢ï¼š
		ä»…ä»…æ”¯æŒæ ‡é‡å­æŸ¥è¯¢
	
	fromåé¢ï¼š
		æ”¯æŒè¡¨å­æŸ¥è¯¢
	whereæˆ–havingåé¢ï¼šâ˜…
		æ ‡é‡å­æŸ¥è¯¢ï¼ˆå•è¡Œï¼‰ âˆš
		åˆ—å­æŸ¥è¯¢  ï¼ˆå¤šè¡Œï¼‰ âˆš
		
		è¡Œå­æŸ¥è¯¢
		
	existsåé¢ï¼ˆç›¸å…³å­æŸ¥è¯¢ï¼‰
		è¡¨å­æŸ¥è¯¢
æŒ‰ç»“æœé›†çš„è¡Œåˆ—æ•°ä¸åŒï¼š
	æ ‡é‡å­æŸ¥è¯¢ï¼ˆç»“æœé›†åªæœ‰ä¸€è¡Œä¸€åˆ—ï¼‰
	åˆ—å­æŸ¥è¯¢ï¼ˆç»“æœé›†åªæœ‰ä¸€åˆ—å¤šè¡Œï¼‰
	è¡Œå­æŸ¥è¯¢ï¼ˆç»“æœé›†æœ‰ä¸€è¡Œå¤šåˆ—ï¼‰
	è¡¨å­æŸ¥è¯¢ï¼ˆç»“æœé›†ä¸€èˆ¬ä¸ºå¤šè¡Œå¤šåˆ—ï¼‰
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#ä¸€ã€whereæˆ–havingåé¢
/*
1ã€æ ‡é‡å­æŸ¥è¯¢ï¼ˆå•è¡Œå­æŸ¥è¯¢ï¼‰
2ã€åˆ—å­æŸ¥è¯¢ï¼ˆå¤šè¡Œå­æŸ¥è¯¢ï¼‰

3ã€è¡Œå­æŸ¥è¯¢ï¼ˆå¤šåˆ—å¤šè¡Œï¼‰

ç‰¹ç‚¹ï¼š
â‘ å­æŸ¥è¯¢æ”¾åœ¨å°æ‹¬å·å†…
â‘¡å­æŸ¥è¯¢ä¸€èˆ¬æ”¾åœ¨æ¡ä»¶çš„å³ä¾§
â‘¢æ ‡é‡å­æŸ¥è¯¢ï¼Œä¸€èˆ¬æ­é…ç€å•è¡Œæ“ä½œç¬¦ä½¿ç”¨
&gt; &lt; &gt;= &lt;= = &lt;&gt;

åˆ—å­æŸ¥è¯¢ï¼Œä¸€èˆ¬æ­é…ç€å¤šè¡Œæ“ä½œç¬¦ä½¿ç”¨
inã€any/someã€all

â‘£å­æŸ¥è¯¢çš„æ‰§è¡Œä¼˜å…ˆäºä¸»æŸ¥è¯¢æ‰§è¡Œï¼Œä¸»æŸ¥è¯¢çš„æ¡ä»¶ç”¨åˆ°äº†å­æŸ¥è¯¢çš„ç»“æœ

*/
</code></pre></div></div>

<h2 id="æ ‡é‡å­æŸ¥è¯¢">æ ‡é‡å­æŸ¥è¯¢</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#1.æ ‡é‡å­æŸ¥è¯¢â˜…

#æ¡ˆä¾‹1ï¼šè°çš„å·¥èµ„æ¯” Abel é«˜?

#â‘ æŸ¥è¯¢Abelçš„å·¥èµ„
SELECT salary
FROM employees
WHERE last_name = 'Abel'

#â‘¡æŸ¥è¯¢å‘˜å·¥çš„ä¿¡æ¯ï¼Œæ»¡è¶³ salary&gt;â‘ ç»“æœ
SELECT *
FROM employees
WHERE salary&gt;(

	SELECT salary
	FROM employees
	WHERE last_name = 'Abel'

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹2ï¼šè¿”å›job_idä¸141å·å‘˜å·¥ç›¸åŒï¼Œsalaryæ¯”143å·å‘˜å·¥å¤šçš„å‘˜å·¥ å§“åï¼Œjob_id å’Œå·¥èµ„

#â‘ æŸ¥è¯¢141å·å‘˜å·¥çš„job_id
SELECT job_id
FROM employees
WHERE employee_id = 141

#â‘¡æŸ¥è¯¢143å·å‘˜å·¥çš„salary
SELECT salary
FROM employees
WHERE employee_id = 143

#â‘¢æŸ¥è¯¢å‘˜å·¥çš„å§“åï¼Œjob_id å’Œå·¥èµ„ï¼Œè¦æ±‚job_id=â‘ å¹¶ä¸”salary&gt;â‘¡

SELECT last_name,job_id,salary
FROM employees
WHERE job_id = (
	SELECT job_id
	FROM employees
	WHERE employee_id = 141
) AND salary&gt;(
	SELECT salary
	FROM employees
	WHERE employee_id = 143

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹3ï¼šè¿”å›å…¬å¸å·¥èµ„æœ€å°‘çš„å‘˜å·¥çš„last_name,job_idå’Œsalary

#â‘ æŸ¥è¯¢å…¬å¸çš„ æœ€ä½å·¥èµ„
SELECT MIN(salary)
FROM employees

#â‘¡æŸ¥è¯¢last_name,job_idå’Œsalaryï¼Œè¦æ±‚salary=â‘ 
SELECT last_name,job_id,salary
FROM employees
WHERE salary=(
	SELECT MIN(salary)
	FROM employees
);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹4ï¼šæŸ¥è¯¢æœ€ä½å·¥èµ„å¤§äº50å·éƒ¨é—¨æœ€ä½å·¥èµ„çš„éƒ¨é—¨idå’Œå…¶æœ€ä½å·¥èµ„

#â‘ æŸ¥è¯¢50å·éƒ¨é—¨çš„æœ€ä½å·¥èµ„
SELECT  MIN(salary)
FROM employees
WHERE department_id = 50

#â‘¡æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„æœ€ä½å·¥èµ„

SELECT MIN(salary),department_id
FROM employees
GROUP BY department_id

#â‘¢ åœ¨â‘¡åŸºç¡€ä¸Šç­›é€‰ï¼Œæ»¡è¶³min(salary)&gt;â‘ 
SELECT MIN(salary),department_id
FROM employees
GROUP BY department_id
HAVING MIN(salary)&gt;(
	SELECT  MIN(salary)
	FROM employees
	WHERE department_id = 50


);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#éæ³•ä½¿ç”¨æ ‡é‡å­æŸ¥è¯¢

SELECT MIN(salary),department_id
FROM employees
GROUP BY department_id
HAVING MIN(salary)&gt;(
	SELECT  salary
	FROM employees
	WHERE department_id = 250


);
</code></pre></div></div>

<h2 id="åˆ—å­æŸ¥è¯¢">åˆ—å­æŸ¥è¯¢</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#2.åˆ—å­æŸ¥è¯¢ï¼ˆå¤šè¡Œå­æŸ¥è¯¢ï¼‰â˜…
#æ¡ˆä¾‹1ï¼šè¿”å›location_idæ˜¯1400æˆ–1700çš„éƒ¨é—¨ä¸­çš„æ‰€æœ‰å‘˜å·¥å§“å

#â‘ æŸ¥è¯¢location_idæ˜¯1400æˆ–1700çš„éƒ¨é—¨ç¼–å·
SELECT DISTINCT department_id
FROM departments
WHERE location_id IN(1400,1700)

#â‘¡æŸ¥è¯¢å‘˜å·¥å§“åï¼Œè¦æ±‚éƒ¨é—¨å·æ˜¯â‘ åˆ—è¡¨ä¸­çš„æŸä¸€ä¸ª

SELECT last_name
FROM employees
WHERE department_id  &lt;&gt;ALL(
	SELECT DISTINCT department_id
	FROM departments
	WHERE location_id IN(1400,1700)

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹2ï¼šè¿”å›å…¶å®ƒå·¥ç§ä¸­æ¯”job_idä¸ºâ€˜IT_PROGâ€™å·¥ç§ä»»ä¸€å·¥èµ„ä½çš„å‘˜å·¥çš„å‘˜å·¥å·ã€å§“åã€job_id ä»¥åŠsalary

#â‘ æŸ¥è¯¢job_idä¸ºâ€˜IT_PROGâ€™éƒ¨é—¨ä»»ä¸€å·¥èµ„

SELECT DISTINCT salary
FROM employees
WHERE job_id = 'IT_PROG'

#â‘¡æŸ¥è¯¢å‘˜å·¥å·ã€å§“åã€job_id ä»¥åŠsalaryï¼Œsalary&lt;(â‘ )çš„ä»»æ„ä¸€ä¸ª
SELECT last_name,employee_id,job_id,salary
FROM employees
WHERE salary&lt;ANY(
	SELECT DISTINCT salary
	FROM employees
	WHERE job_id = 'IT_PROG'

) AND job_id&lt;&gt;'IT_PROG';

#æˆ–
SELECT last_name,employee_id,job_id,salary
FROM employees
WHERE salary&lt;(
	SELECT MAX(salary)
	FROM employees
	WHERE job_id = 'IT_PROG'

) AND job_id&lt;&gt;'IT_PROG';
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹3ï¼šè¿”å›å…¶å®ƒéƒ¨é—¨ä¸­æ¯”job_idä¸ºâ€˜IT_PROGâ€™éƒ¨é—¨æ‰€æœ‰å·¥èµ„éƒ½ä½çš„å‘˜å·¥   çš„å‘˜å·¥å·ã€å§“åã€job_id ä»¥åŠsalary

SELECT last_name,employee_id,job_id,salary
FROM employees
WHERE salary&lt;ALL(
	SELECT DISTINCT salary
	FROM employees
	WHERE job_id = 'IT_PROG'

) AND job_id&lt;&gt;'IT_PROG';

#æˆ–

SELECT last_name,employee_id,job_id,salary
FROM employees
WHERE salary&lt;(
	SELECT MIN( salary)
	FROM employees
	WHERE job_id = 'IT_PROG'

) AND job_id&lt;&gt;'IT_PROG';
</code></pre></div></div>

<h2 id="è¡Œå­æŸ¥è¯¢">è¡Œå­æŸ¥è¯¢</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#3ã€è¡Œå­æŸ¥è¯¢ï¼ˆç»“æœé›†ä¸€è¡Œå¤šåˆ—æˆ–å¤šè¡Œå¤šåˆ—ï¼‰

#æ¡ˆä¾‹ï¼šæŸ¥è¯¢å‘˜å·¥ç¼–å·æœ€å°å¹¶ä¸”å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯



SELECT * 
FROM employees
WHERE (employee_id,salary)=(
	SELECT MIN(employee_id),MAX(salary)
	FROM employees
);

#â‘ æŸ¥è¯¢æœ€å°çš„å‘˜å·¥ç¼–å·
SELECT MIN(employee_id)
FROM employees


#â‘¡æŸ¥è¯¢æœ€é«˜å·¥èµ„
SELECT MAX(salary)
FROM employees


#â‘¢æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯
SELECT *
FROM employees
WHERE employee_id=(
	SELECT MIN(employee_id)
	FROM employees


)AND salary=(
	SELECT MAX(salary)
	FROM employees

);
</code></pre></div></div>

<h2 id="selectå">selectå</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ä»…ä»…æ”¯æŒæ ‡é‡å­æŸ¥è¯¢
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥ä¸ªæ•°


SELECT d.*,(

	SELECT COUNT(*)
	FROM employees e
	WHERE e.department_id = d.`department_id`
 ) ä¸ªæ•°
 FROM departments d;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹2ï¼šæŸ¥è¯¢å‘˜å·¥å·=102çš„éƒ¨é—¨å
 
SELECT (
	SELECT department_name,e.department_id
	FROM departments d
	INNER JOIN employees e
	ON d.department_id=e.department_id
	WHERE e.employee_id=102
	
) éƒ¨é—¨å;
</code></pre></div></div>

<h2 id="fromå">fromå</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>å°†å­æŸ¥è¯¢ç»“æœå……å½“ä¸€å¼ è¡¨ï¼Œè¦æ±‚å¿…é¡»èµ·åˆ«å
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹ï¼šæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„çš„å·¥èµ„ç­‰çº§
#â‘ æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id


SELECT * FROM job_grades;


#â‘¡è¿æ¥â‘ çš„ç»“æœé›†å’Œjob_gradesè¡¨ï¼Œç­›é€‰æ¡ä»¶å¹³å‡å·¥èµ„ between lowest_sal and highest_sal

SELECT  ag_dep.*,g.`grade_level`
FROM (
	SELECT AVG(salary) ag,department_id
	FROM employees
	GROUP BY department_id
) ag_dep
INNER JOIN job_grades g
ON ag_dep.ag BETWEEN lowest_sal AND highest_sal;
</code></pre></div></div>

<h2 id="existså">existså</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è¯­æ³•ï¼š
exists(å®Œæ•´çš„æŸ¥è¯¢è¯­å¥)
ç»“æœï¼š
1æˆ–0
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹1ï¼šæŸ¥è¯¢æœ‰å‘˜å·¥çš„éƒ¨é—¨å

#in
SELECT department_name
FROM departments d
WHERE d.`department_id` IN(
	SELECT department_id
	FROM employees

)

#exists

SELECT department_name
FROM departments d
WHERE EXISTS(
	SELECT *
	FROM employees e
	WHERE d.`department_id`=e.`department_id`


);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#æ¡ˆä¾‹2ï¼šæŸ¥è¯¢æ²¡æœ‰å¥³æœ‹å‹çš„ç”·ç¥ä¿¡æ¯

#in

SELECT bo.*
FROM boys bo
WHERE bo.id NOT IN(
	SELECT boyfriend_id
	FROM beauty
)

#exists
SELECT bo.*
FROM boys bo
WHERE NOT EXISTS(
	SELECT boyfriend_id
	FROM beauty b
	WHERE bo.`id`=b.`boyfriend_id`

);
</code></pre></div></div>

<h2 id="ç»ƒä¹ ">ç»ƒä¹ </h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#1.	æŸ¥è¯¢å’ŒZlotkeyç›¸åŒéƒ¨é—¨çš„å‘˜å·¥å§“åå’Œå·¥èµ„

#â‘ æŸ¥è¯¢Zlotkeyçš„éƒ¨é—¨
SELECT department_id
FROM employees
WHERE last_name = 'Zlotkey'

#â‘¡æŸ¥è¯¢éƒ¨é—¨å·=â‘ çš„å§“åå’Œå·¥èµ„
SELECT last_name,salary
FROM employees
WHERE department_id = (
	SELECT department_id
	FROM employees
	WHERE last_name = 'Zlotkey'

)
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#2.æŸ¥è¯¢å·¥èµ„æ¯”å…¬å¸å¹³å‡å·¥èµ„é«˜çš„å‘˜å·¥çš„å‘˜å·¥å·ï¼Œå§“åå’Œå·¥èµ„ã€‚

#â‘ æŸ¥è¯¢å¹³å‡å·¥èµ„
SELECT AVG(salary)
FROM employees

#â‘¡æŸ¥è¯¢å·¥èµ„&gt;â‘ çš„å‘˜å·¥å·ï¼Œå§“åå’Œå·¥èµ„ã€‚

SELECT last_name,employee_id,salary
FROM employees
WHERE salary&gt;(

	SELECT AVG(salary)
	FROM employees
);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#3.æŸ¥è¯¢å„éƒ¨é—¨ä¸­å·¥èµ„æ¯”æœ¬éƒ¨é—¨å¹³å‡å·¥èµ„é«˜çš„å‘˜å·¥çš„å‘˜å·¥å·, å§“åå’Œå·¥èµ„
#â‘ æŸ¥è¯¢å„éƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id

#â‘¡è¿æ¥â‘ ç»“æœé›†å’Œemployeesè¡¨ï¼Œè¿›è¡Œç­›é€‰
SELECT employee_id,last_name,salary,e.department_id
FROM employees e
INNER JOIN (
	SELECT AVG(salary) ag,department_id
	FROM employees
	GROUP BY department_id


) ag_dep
ON e.department_id = ag_dep.department_id
WHERE salary&gt;ag_dep.ag ;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#4.	æŸ¥è¯¢å’Œå§“åä¸­åŒ…å«å­—æ¯uçš„å‘˜å·¥åœ¨ç›¸åŒéƒ¨é—¨çš„å‘˜å·¥çš„å‘˜å·¥å·å’Œå§“å
#â‘ æŸ¥è¯¢å§“åä¸­åŒ…å«å­—æ¯uçš„å‘˜å·¥çš„éƒ¨é—¨

SELECT  DISTINCT department_id
FROM employees
WHERE last_name LIKE '%u%'

#â‘¡æŸ¥è¯¢éƒ¨é—¨å·=â‘ ä¸­çš„ä»»æ„ä¸€ä¸ªçš„å‘˜å·¥å·å’Œå§“å
SELECT last_name,employee_id
FROM employees
WHERE department_id IN(
	SELECT  DISTINCT department_id
	FROM employees
	WHERE last_name LIKE '%u%'
);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#5. æŸ¥è¯¢åœ¨éƒ¨é—¨çš„location_idä¸º1700çš„éƒ¨é—¨å·¥ä½œçš„å‘˜å·¥çš„å‘˜å·¥å·

#â‘ æŸ¥è¯¢location_idä¸º1700çš„éƒ¨é—¨

SELECT DISTINCT department_id
FROM departments 
WHERE location_id  = 1700


#â‘¡æŸ¥è¯¢éƒ¨é—¨å·=â‘ ä¸­çš„ä»»æ„ä¸€ä¸ªçš„å‘˜å·¥å·
SELECT employee_id
FROM employees
WHERE department_id =ANY(
	SELECT DISTINCT department_id
	FROM departments 
	WHERE location_id  = 1700

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#6.æŸ¥è¯¢ç®¡ç†è€…æ˜¯Kingçš„å‘˜å·¥å§“åå’Œå·¥èµ„

#â‘ æŸ¥è¯¢å§“åä¸ºkingçš„å‘˜å·¥ç¼–å·
SELECT employee_id
FROM employees
WHERE last_name  = 'K_ing'

#â‘¡æŸ¥è¯¢å“ªä¸ªå‘˜å·¥çš„manager_id = â‘ 
SELECT last_name,salary
FROM employees
WHERE manager_id IN(
	SELECT employee_id
	FROM employees
	WHERE last_name  = 'K_ing'

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#7.æŸ¥è¯¢å·¥èµ„æœ€é«˜çš„å‘˜å·¥çš„å§“åï¼Œè¦æ±‚first_nameå’Œlast_nameæ˜¾ç¤ºä¸ºä¸€åˆ—ï¼Œåˆ—åä¸º å§“.å


#â‘ æŸ¥è¯¢æœ€é«˜å·¥èµ„
SELECT MAX(salary)
FROM employees

#â‘¡æŸ¥è¯¢å·¥èµ„=â‘ çš„å§“.å

SELECT CONCAT(first_name,last_name) "å§“.å"
FROM employees
WHERE salary=(
	SELECT MAX(salary)
	FROM employees

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 1. æŸ¥è¯¢å·¥èµ„æœ€ä½çš„å‘˜å·¥ä¿¡æ¯: last_name, salary

#â‘ æŸ¥è¯¢æœ€ä½çš„å·¥èµ„
SELECT MIN(salary)
FROM employees

#â‘¡æŸ¥è¯¢last_name,salaryï¼Œè¦æ±‚salary=â‘ 
SELECT last_name,salary
FROM employees
WHERE salary=(
	SELECT MIN(salary)
	FROM employees
);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 2. æŸ¥è¯¢å¹³å‡å·¥èµ„æœ€ä½çš„éƒ¨é—¨ä¿¡æ¯

#æ–¹å¼ä¸€ï¼š
#â‘ å„éƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id
#â‘¡æŸ¥è¯¢â‘ ç»“æœä¸Šçš„æœ€ä½å¹³å‡å·¥èµ„
SELECT MIN(ag)
FROM (
	SELECT AVG(salary) ag,department_id
	FROM employees
	GROUP BY department_id
) ag_dep
#â‘¢æŸ¥è¯¢å“ªä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„=â‘¡

SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id
HAVING AVG(salary)=(
	SELECT MIN(ag)
	FROM (
		SELECT AVG(salary) ag,department_id
		FROM employees
		GROUP BY department_id
	) ag_dep

);

#â‘£æŸ¥è¯¢éƒ¨é—¨ä¿¡æ¯

SELECT d.*
FROM departments d
WHERE d.`department_id`=(
	SELECT department_id
	FROM employees
	GROUP BY department_id
	HAVING AVG(salary)=(
		SELECT MIN(ag)
		FROM (
			SELECT AVG(salary) ag,department_id
			FROM employees
			GROUP BY department_id
		) ag_dep

	)

);


#æ–¹å¼äºŒï¼š
#â‘ å„éƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id

#â‘¡æ±‚å‡ºæœ€ä½å¹³å‡å·¥èµ„çš„éƒ¨é—¨ç¼–å·
SELECT department_id
FROM employees
GROUP BY department_id
ORDER BY AVG(salary) 
LIMIT 1;

#â‘¢æŸ¥è¯¢éƒ¨é—¨ä¿¡æ¯
SELECT *
FROM departments
WHERE department_id=(
	SELECT department_id
	FROM employees
	GROUP BY department_id
	ORDER BY AVG(salary) 
	LIMIT 1
);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 3. æŸ¥è¯¢å¹³å‡å·¥èµ„æœ€ä½çš„éƒ¨é—¨ä¿¡æ¯å’Œè¯¥éƒ¨é—¨çš„å¹³å‡å·¥èµ„
#â‘ å„éƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id
#â‘¡æ±‚å‡ºæœ€ä½å¹³å‡å·¥èµ„çš„éƒ¨é—¨ç¼–å·
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id
ORDER BY AVG(salary) 
LIMIT 1;
#â‘¢æŸ¥è¯¢éƒ¨é—¨ä¿¡æ¯
SELECT d.*,ag
FROM departments d
JOIN (
	SELECT AVG(salary) ag,department_id
	FROM employees
	GROUP BY department_id
	ORDER BY AVG(salary) 
	LIMIT 1

) ag_dep
ON d.`department_id`=ag_dep.department_id;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 4. æŸ¥è¯¢å¹³å‡å·¥èµ„æœ€é«˜çš„ job ä¿¡æ¯
#â‘ æŸ¥è¯¢æœ€é«˜çš„jobçš„å¹³å‡å·¥èµ„
SELECT AVG(salary),job_id
FROM employees
GROUP BY job_id
ORDER BY AVG(salary) DESC
LIMIT 1

#â‘¡æŸ¥è¯¢jobä¿¡æ¯
SELECT * 
FROM jobs
WHERE job_id=(
	SELECT job_id
	FROM employees
	GROUP BY job_id
	ORDER BY AVG(salary) DESC
	LIMIT 1

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 5. æŸ¥è¯¢å¹³å‡å·¥èµ„é«˜äºå…¬å¸å¹³å‡å·¥èµ„çš„éƒ¨é—¨æœ‰å“ªäº›?

#â‘ æŸ¥è¯¢å¹³å‡å·¥èµ„
SELECT AVG(salary)
FROM employees

#â‘¡æŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨çš„å¹³å‡å·¥èµ„
SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id

#â‘¢ç­›é€‰â‘¡ç»“æœé›†ï¼Œæ»¡è¶³å¹³å‡å·¥èµ„&gt;â‘ 

SELECT AVG(salary),department_id
FROM employees
GROUP BY department_id
HAVING AVG(salary)&gt;(
	SELECT AVG(salary)
	FROM employees

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 6. æŸ¥è¯¢å‡ºå…¬å¸ä¸­æ‰€æœ‰ manager çš„è¯¦ç»†ä¿¡æ¯.
#â‘ æŸ¥è¯¢æ‰€æœ‰managerçš„å‘˜å·¥ç¼–å·
SELECT DISTINCT manager_id
FROM employees

#â‘¡æŸ¥è¯¢è¯¦ç»†ä¿¡æ¯ï¼Œæ»¡è¶³employee_id=â‘ 
SELECT *
FROM employees
WHERE employee_id =ANY(
	SELECT DISTINCT manager_id
	FROM employees

);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 7. å„ä¸ªéƒ¨é—¨ä¸­ æœ€é«˜å·¥èµ„ä¸­æœ€ä½çš„é‚£ä¸ªéƒ¨é—¨çš„ æœ€ä½å·¥èµ„æ˜¯å¤šå°‘

#â‘ æŸ¥è¯¢å„éƒ¨é—¨çš„æœ€é«˜å·¥èµ„ä¸­æœ€ä½çš„éƒ¨é—¨ç¼–å·
SELECT department_id
FROM employees
GROUP BY department_id
ORDER BY MAX(salary)
LIMIT 1


#â‘¡æŸ¥è¯¢â‘ ç»“æœçš„é‚£ä¸ªéƒ¨é—¨çš„æœ€ä½å·¥èµ„

SELECT MIN(salary) ,department_id
FROM employees
WHERE department_id=(
	SELECT department_id
	FROM employees
	GROUP BY department_id
	ORDER BY MAX(salary)
	LIMIT 1


);
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 8. æŸ¥è¯¢å¹³å‡å·¥èµ„æœ€é«˜çš„éƒ¨é—¨çš„ manager çš„è¯¦ç»†ä¿¡æ¯: last_name, department_id, email, salary
#â‘ æŸ¥è¯¢å¹³å‡å·¥èµ„æœ€é«˜çš„éƒ¨é—¨ç¼–å·
SELECT 
    department_id 
FROM
    employees 
GROUP BY department_id 
ORDER BY AVG(salary) DESC 
LIMIT 1 

#â‘¡å°†employeeså’Œdepartmentsè¿æ¥æŸ¥è¯¢ï¼Œç­›é€‰æ¡ä»¶æ˜¯â‘ 
    SELECT 
        last_name, d.department_id, email, salary 
    FROM
        employees e 
        INNER JOIN departments d 
            ON d.manager_id = e.employee_id 
    WHERE d.department_id = 
        (SELECT 
            department_id 
        FROM
            employees 
        GROUP BY department_id 
        ORDER BY AVG(salary) DESC 
        LIMIT 1) ;
</code></pre></div></div>

:ET