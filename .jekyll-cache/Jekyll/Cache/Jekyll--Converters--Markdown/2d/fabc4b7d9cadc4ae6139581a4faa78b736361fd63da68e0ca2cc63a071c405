I"ê÷<ul id="markdown-toc">
  <li><a href="#å·¥å…·ç±»ä¸­æ— æ³•æ³¨å…¥mapper" id="markdown-toc-å·¥å…·ç±»ä¸­æ— æ³•æ³¨å…¥mapper">å·¥å…·ç±»ä¸­æ— æ³•æ³¨å…¥mapper</a></li>
  <li><a href="#ä½¿ç”¨java8æ‹¼æ¥å•æ—¥æ’ç­æ¨¡æ¿ä¿¡æ¯" id="markdown-toc-ä½¿ç”¨java8æ‹¼æ¥å•æ—¥æ’ç­æ¨¡æ¿ä¿¡æ¯">ä½¿ç”¨java8æ‹¼æ¥å•æ—¥æ’ç­æ¨¡æ¿ä¿¡æ¯</a></li>
  <li><a href="#æ—¶é—´å·¥å…·ç±»" id="markdown-toc-æ—¶é—´å·¥å…·ç±»">æ—¶é—´å·¥å…·ç±»</a></li>
  <li><a href="#éšæœºæ•°å·¥å…·ç±»" id="markdown-toc-éšæœºæ•°å·¥å…·ç±»">éšæœºæ•°å·¥å…·ç±»</a></li>
  <li><a href="#dateå­—ç¬¦ä¸²è½¬date" id="markdown-toc-dateå­—ç¬¦ä¸²è½¬date">Dateå­—ç¬¦ä¸²è½¬Date</a></li>
  <li><a href="#æ»¡åœ°å‘çš„liståˆ—è¡¨" id="markdown-toc-æ»¡åœ°å‘çš„liståˆ—è¡¨">æ»¡åœ°å‘çš„Liståˆ—è¡¨</a>    <ul>
      <li><a href="#arraysaslist" id="markdown-toc-arraysaslist">Arrays.asList</a></li>
      <li><a href="#ä½¿ç”¨-listsublistä¼šoom" id="markdown-toc-ä½¿ç”¨-listsublistä¼šoom">ä½¿ç”¨ List.subListä¼šOOM</a></li>
      <li><a href="#é€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„" id="markdown-toc-é€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„">é€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„</a>        <ul>
          <li><a href="#listvsmap" id="markdown-toc-listvsmap">ListVSMap</a></li>
          <li><a href="#arrayvslinked" id="markdown-toc-arrayvslinked">ArrayVSLinked</a></li>
        </ul>
      </li>
      <li><a href="#å…³äºremoveæ–¹æ³•" id="markdown-toc-å…³äºremoveæ–¹æ³•">å…³äºremoveæ–¹æ³•</a></li>
    </ul>
  </li>
  <li><a href="#çƒ¦äººçš„ç©ºæŒ‡é’ˆ" id="markdown-toc-çƒ¦äººçš„ç©ºæŒ‡é’ˆ">çƒ¦äººçš„ç©ºæŒ‡é’ˆ</a>    <ul>
      <li><a href="#ä¿®å¤å’Œå®šä½ç©ºæŒ‡é’ˆ" id="markdown-toc-ä¿®å¤å’Œå®šä½ç©ºæŒ‡é’ˆ">ä¿®å¤å’Œå®šä½ç©ºæŒ‡é’ˆ</a></li>
      <li><a href="#å®ä½“ä¸­å±æ€§çš„null" id="markdown-toc-å®ä½“ä¸­å±æ€§çš„null">å®ä½“ä¸­å±æ€§çš„null</a></li>
      <li><a href="#mysqlä¸­çš„nullå‘" id="markdown-toc-mysqlä¸­çš„nullå‘">MySQLä¸­çš„nullå‘</a></li>
    </ul>
  </li>
</ul>
<h3 id="å·¥å…·ç±»ä¸­æ— æ³•æ³¨å…¥mapper">å·¥å…·ç±»ä¸­æ— æ³•æ³¨å…¥mapper</h3>

<ul>
  <li>å› ä¸ºä¸€èˆ¬æƒ…å†µä¸‹å·¥å…·ç±»æ˜¯ä¸å½’springå®¹å™¨ç®¡ç†çš„ï¼Œè¿™æ—¶å€™ä½¿ç”¨@Autowiredæ³¨è§£å»æ³¨å…¥mapperæ˜¯ä¸ç®¡ç”¨çš„</li>
  <li>ä½¿ç”¨@PostConstructæ³¨è§£å£°æ˜ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•</li>
  <li>å£°æ˜ä¸€ä¸ªæœ¬å·¥å…·ç±»çš„é™æ€å˜é‡</li>
  <li>åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­åˆå§‹åŒ–mapper</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MysqlDateUtils</span> <span class="o">{</span>
	<span class="nd">@Autowired</span>
	<span class="kd">private</span> <span class="nc">SysUserMapper</span> <span class="n">sysUserMapper</span><span class="o">;</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">MysqlDateUtils</span> <span class="n">mysqlDateUtils</span><span class="o">;</span> 
	
	<span class="nd">@PostConstruct</span>  
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>  
		<span class="n">mysqlDateUtils</span> <span class="o">=</span> <span class="k">this</span><span class="o">;</span>  
		<span class="n">mysqlDateUtils</span><span class="o">.</span><span class="na">sysUserMapper</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">sysUserMapper</span><span class="o">;</span>  
    <span class="o">}</span>
	
	<span class="cm">/**
	 * è·å–æ•°æ®åº“å½“å‰çš„å¹´æœˆæ—¥ï¼ˆyyyy-MM-dd HH:mm:ssï¼‰
	 * @return Date
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getMysqlNowDate</span><span class="o">()</span> <span class="o">{</span>
		
		<span class="k">return</span> <span class="nf">parseMysqlDateToStr</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">,</span><span class="n">mysqlDateUtils</span><span class="o">.</span><span class="na">sysUserMapper</span><span class="o">.</span><span class="na">getMysqlNowDate</span><span class="o">());</span>
	<span class="o">}</span>
    <span class="cm">/**
	 * è·å–æ•°æ®åº“å½“å‰çš„å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼ˆyyyy-MM-dd HH:mm:ssï¼‰
	 * @return DateTime
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getMysqlNowDateTime</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="nf">parseMysqlDateToStr</span><span class="o">(</span><span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">,</span><span class="n">mysqlDateUtils</span><span class="o">.</span><span class="na">sysUserMapper</span><span class="o">.</span><span class="na">getMysqlNowDate</span><span class="o">());</span>
	<span class="o">}</span>
	
	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">parseMysqlDateToStr</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">format</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Date</span> <span class="n">date</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">SimpleDateFormat</span><span class="o">(</span><span class="n">format</span><span class="o">).</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="ä½¿ç”¨java8æ‹¼æ¥å•æ—¥æ’ç­æ¨¡æ¿ä¿¡æ¯">ä½¿ç”¨java8æ‹¼æ¥å•æ—¥æ’ç­æ¨¡æ¿ä¿¡æ¯</h3>

<ul>
  <li>ä»æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°çš„åŸå§‹æ•°æ®</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">é™¢çº§æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">é™¢çº§æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¦‡äº§ç§‘æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¦‡äº§ç§‘æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¼ ä¸‰æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="w"> </span><span class="mi">05</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¼ ä¸‰æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">é™¢çº§æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">08</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">é™¢çº§æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">16</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¦‡äº§ç§‘æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">08</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¦‡äº§ç§‘æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">16</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">52</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¼ ä¸‰æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">15</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">16</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸‹åˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">18</span><span class="err">:</span><span class="w"> </span><span class="mi">30</span><span class="w">
</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">auto_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="err">admStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">07</span><span class="err">:</span><span class="w"> </span><span class="mi">01</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">source_allot_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">48</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">å¼ ä¸‰æ¨¡æ¿</span><span class="p">,</span><span class="w">
    </span><span class="err">maintain_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="err">amsStart</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">06</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">admEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">08</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="p">,</span><span class="w">
    </span><span class="err">classes_name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">ä¸Šåˆ</span><span class="p">,</span><span class="w">
    </span><span class="err">source_number</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w">
    </span><span class="err">amsEnd</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">11</span><span class="err">:</span><span class="w"> </span><span class="mi">00</span><span class="w">
</span><span class="p">}]</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>æœ€ç»ˆè¦æ±‚æ•ˆæœï¼š</li>
</ul>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"æ“ä½œæˆåŠŸ"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amsStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06:00"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"segmentdata"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"08:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"08:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"07:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"08:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸Šåˆ"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"amsEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11:00"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"amsStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:30"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"segmentdata"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14:05:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14:05:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14:05:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"admStart"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:01:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"admEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16:00:00"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"source_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"classes_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ä¸‹åˆ"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"amsEnd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"18:30"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>ä»£ç å¤„ç†</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">AjaxResult</span> <span class="nf">selectDayTemplateByMoreOperation</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span>
			<span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"scheludingclass"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">scheludingclass</span><span class="o">,</span>
			<span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"deptId"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">deptId</span><span class="o">,</span>
			<span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"arsDocId"</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="nc">String</span> <span class="n">arsDocId</span><span class="o">)</span> <span class="o">{</span>
    
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">arsDayMaintainService</span><span class="o">.</span><span class="na">selectDayTemplateByMoreOperation</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">deptId</span><span class="o">,</span> <span class="n">arsDocId</span><span class="o">);</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"åŸå§‹æ•°æ®ï¼š"</span> <span class="o">+</span> <span class="n">list</span><span class="o">);</span>
		<span class="c1">// ç­›é€‰listä¸­çš„mapï¼Œè®©æ¯ä¸ªmapåªåŒ…å«ç­æ¬¡åç§°ï¼Œå¼€å§‹æ—¶é—´ï¼Œç»“æŸæ—¶é—´ä¸‰ä¸ªå­—æ®µ</span>
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">allList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;();</span>
		<span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">map</span> <span class="o">-&gt;</span> <span class="o">{</span>
			<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">collect</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">entrySet</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
					<span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">m</span> <span class="o">-&gt;</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"classes_name"</span><span class="o">)</span> <span class="o">||</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"amsStart"</span><span class="o">)</span>
							<span class="o">||</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"amsEnd"</span><span class="o">))</span>
					<span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toMap</span><span class="o">(</span><span class="n">h</span> <span class="o">-&gt;</span> <span class="n">h</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">h</span> <span class="o">-&gt;</span> <span class="n">h</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
			<span class="n">allList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">collect</span><span class="o">);</span>
		<span class="o">});</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"æ²¡å»é‡ä¹‹å‰ï¼š"</span> <span class="o">+</span> <span class="n">allList</span><span class="o">);</span>
		<span class="c1">// é’ˆå¯¹ç­›é€‰å®Œæˆåçš„listä¸­çš„mapå»é‡</span>
		<span class="cm">/*
		  å»é‡åï¼š
		 [{
		    amsStart = 06: 00,
		    classes_name = ä¸Šåˆ,
		    amsEnd = 11: 00
		  }, 
		  {
		    amsStart = 15: 30,
		    classes_name = ä¸‹åˆ,
		    amsEnd = 18: 30
		  }
		]  
		*/</span> 
		<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">distinctcollect</span> <span class="o">=</span> <span class="n">allList</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">distinct</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å»é‡ä¹‹å"</span> <span class="o">+</span> <span class="n">distinctcollect</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">distinctcollect</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="c1">// è·å–å½“å‰çš„ç­æ¬¡åç§°</span>
			<span class="nc">Object</span> <span class="n">classesName</span> <span class="o">=</span> <span class="n">distinctcollect</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">"classes_name"</span><span class="o">);</span>
			<span class="c1">// å¼€å§‹å°è£…ç¬¬äºŒå±‚</span>
			<span class="c1">// ç­›é€‰listä¸­çš„mapï¼Œè®©æ¯ä¸ªmapåªåŒ…å«åˆ†æ®µå¼€å§‹æ—¶é—´ï¼Œåˆ†æ®µç»“æŸæ—¶é—´ï¼Œå·æºæ•°ä¸‰ä¸ªå­—æ®µ</span>
			<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">segmentList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;();</span>
			<span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">map</span> <span class="o">-&gt;</span> <span class="o">{</span>
				<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">collect</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">entrySet</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
						<span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">m</span> <span class="o">-&gt;</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"admStart"</span><span class="o">)</span> <span class="o">||</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"admEnd"</span><span class="o">)</span>
								<span class="o">||</span> <span class="n">m</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"source_number"</span><span class="o">)</span> <span class="o">||</span> <span class="n">m</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">classesName</span><span class="o">))</span>
						<span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toMap</span><span class="o">(</span><span class="n">h</span> <span class="o">-&gt;</span> <span class="n">h</span><span class="o">.</span><span class="na">getKey</span><span class="o">(),</span> <span class="n">h</span> <span class="o">-&gt;</span> <span class="n">h</span><span class="o">.</span><span class="na">getValue</span><span class="o">()));</span>
				<span class="c1">// å¼€å§‹è¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤æ‰mapä¸­æ²¡æœ‰classes_nameè¿™ä¸ªkeyçš„map</span>
				<span class="k">if</span> <span class="o">(</span><span class="n">collect</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="s">"classes_name"</span><span class="o">))</span> <span class="o">{</span>
					<span class="n">segmentList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">collect</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">});</span>
			<span class="c1">// æŠŠåˆ†æ®µæ•°æ®æŒ‚åˆ°ç›¸åº”çš„ç­æ¬¡ä¸‹é¢</span>
			<span class="n">distinctcollect</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">put</span><span class="o">(</span><span class="s">"segmentdata"</span><span class="o">,</span> <span class="n">segmentList</span><span class="o">);</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">classesName</span><span class="o">.</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">"ç­æ¬¡ä¸­çš„æ‰€æœ‰åˆ†æ®µæ•°æ®ï¼š"</span> <span class="o">+</span> <span class="n">segmentList</span><span class="o">);</span>
		<span class="o">}</span>

		<span class="k">return</span> <span class="nc">AjaxResult</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">distinctcollect</span><span class="o">);</span>
	<span class="o">}</span>
</code></pre></div></div>

<h3 id="æ—¶é—´å·¥å…·ç±»">æ—¶é—´å·¥å…·ç±»</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * æ—¶é—´å·¥å…·ç±»
 * 
 * @author msunsoft
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DateUtils</span> <span class="kd">extends</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">commons</span><span class="o">.</span><span class="na">lang3</span><span class="o">.</span><span class="na">time</span><span class="o">.</span><span class="na">DateUtils</span>
<span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">YYYY</span> <span class="o">=</span> <span class="s">"yyyy"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">YYYY_MM</span> <span class="o">=</span> <span class="s">"yyyy-MM"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">YYYY_MM_DD</span> <span class="o">=</span> <span class="s">"yyyy-MM-dd"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">YYYYMMDDHHMMSS</span> <span class="o">=</span> <span class="s">"yyyyMMddHHmmss"</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="no">YYYY_MM_DD_HH_MM_SS</span> <span class="o">=</span> <span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">;</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span><span class="o">[]</span> <span class="n">parsePatterns</span> <span class="o">=</span> <span class="o">{</span>
            <span class="s">"yyyy-MM-dd"</span><span class="o">,</span> <span class="s">"yyyy-MM-dd HH:mm:ss"</span><span class="o">,</span> <span class="s">"yyyy-MM-dd HH:mm"</span><span class="o">,</span> <span class="s">"yyyy-MM"</span><span class="o">,</span> 
            <span class="s">"yyyy/MM/dd"</span><span class="o">,</span> <span class="s">"yyyy/MM/dd HH:mm:ss"</span><span class="o">,</span> <span class="s">"yyyy/MM/dd HH:mm"</span><span class="o">,</span> <span class="s">"yyyy/MM"</span><span class="o">,</span>
            <span class="s">"yyyy.MM.dd"</span><span class="o">,</span> <span class="s">"yyyy.MM.dd HH:mm:ss"</span><span class="o">,</span> <span class="s">"yyyy.MM.dd HH:mm"</span><span class="o">,</span> <span class="s">"yyyy.MM"</span><span class="o">};</span>

    <span class="cm">/**
     * è·å–å½“å‰Dateå‹æ—¥æœŸ
     * 
     * @return Date() å½“å‰æ—¥æœŸ
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Date</span> <span class="nf">getNowDate</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Date</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è·å–å½“å‰æ—¥æœŸ, é»˜è®¤æ ¼å¼ä¸ºyyyy-MM-dd
     * 
     * @return String
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getDate</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="nf">dateTimeNow</span><span class="o">(</span><span class="no">YYYY_MM_DD</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">getTime</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="nf">dateTimeNow</span><span class="o">(</span><span class="no">YYYY_MM_DD_HH_MM_SS</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">dateTimeNow</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="nf">dateTimeNow</span><span class="o">(</span><span class="no">YYYYMMDDHHMMSS</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">dateTimeNow</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">format</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="nf">parseDateToStr</span><span class="o">(</span><span class="n">format</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">dateTime</span><span class="o">(</span><span class="kd">final</span> <span class="nc">Date</span> <span class="n">date</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="nf">parseDateToStr</span><span class="o">(</span><span class="no">YYYY_MM_DD</span><span class="o">,</span> <span class="n">date</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">parseDateToStr</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">format</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">Date</span> <span class="n">date</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">SimpleDateFormat</span><span class="o">(</span><span class="n">format</span><span class="o">).</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Date</span> <span class="nf">dateTime</span><span class="o">(</span><span class="kd">final</span> <span class="nc">String</span> <span class="n">format</span><span class="o">,</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">ts</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">try</span>
        <span class="o">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nf">SimpleDateFormat</span><span class="o">(</span><span class="n">format</span><span class="o">).</span><span class="na">parse</span><span class="o">(</span><span class="n">ts</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">ParseException</span> <span class="n">e</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * æ—¥æœŸè·¯å¾„ å³å¹´/æœˆ/æ—¥ å¦‚2018/08/08
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">datePath</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">Date</span> <span class="n">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
        <span class="k">return</span> <span class="nc">DateFormatUtils</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">now</span><span class="o">,</span> <span class="s">"yyyy/MM/dd"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * æ—¥æœŸè·¯å¾„ å³å¹´/æœˆ/æ—¥ å¦‚20180808
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nf">dateTime</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">Date</span> <span class="n">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
        <span class="k">return</span> <span class="nc">DateFormatUtils</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">now</span><span class="o">,</span> <span class="s">"yyyyMMdd"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * æ—¥æœŸå‹å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ—¥æœŸ æ ¼å¼
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Date</span> <span class="nf">parseDate</span><span class="o">(</span><span class="nc">Object</span> <span class="n">str</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">try</span>
        <span class="o">{</span>
            <span class="k">return</span> <span class="nf">parseDate</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">parsePatterns</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="nc">ParseException</span> <span class="n">e</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="cm">/**
     * è·å–æœåŠ¡å™¨å¯åŠ¨æ—¶é—´
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">Date</span> <span class="nf">getServerStartDate</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="kt">long</span> <span class="n">time</span> <span class="o">=</span> <span class="nc">ManagementFactory</span><span class="o">.</span><span class="na">getRuntimeMXBean</span><span class="o">().</span><span class="na">getStartTime</span><span class="o">();</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Date</span><span class="o">(</span><span class="n">time</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * è®¡ç®—ä¸¤ä¸ªæ—¶é—´å·®
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getDatePoor</span><span class="o">(</span><span class="nc">Date</span> <span class="n">endDate</span><span class="o">,</span> <span class="nc">Date</span> <span class="n">nowDate</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kt">long</span> <span class="n">nd</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">nh</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="o">;</span>
        <span class="kt">long</span> <span class="n">nm</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span><span class="o">;</span>
        <span class="c1">// long ns = 1000;</span>
        <span class="c1">// è·å¾—ä¸¤ä¸ªæ—¶é—´çš„æ¯«ç§’æ—¶é—´å·®å¼‚</span>
        <span class="kt">long</span> <span class="n">diff</span> <span class="o">=</span> <span class="n">endDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">()</span> <span class="o">-</span> <span class="n">nowDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">();</span>
        <span class="c1">// è®¡ç®—å·®å¤šå°‘å¤©</span>
        <span class="kt">long</span> <span class="n">day</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">nd</span><span class="o">;</span>
        <span class="c1">// è®¡ç®—å·®å¤šå°‘å°æ—¶</span>
        <span class="kt">long</span> <span class="n">hour</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">%</span> <span class="n">nd</span> <span class="o">/</span> <span class="n">nh</span><span class="o">;</span>
        <span class="c1">// è®¡ç®—å·®å¤šå°‘åˆ†é’Ÿ</span>
        <span class="kt">long</span> <span class="n">min</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">%</span> <span class="n">nd</span> <span class="o">%</span> <span class="n">nh</span> <span class="o">/</span> <span class="n">nm</span><span class="o">;</span>
        <span class="c1">// è®¡ç®—å·®å¤šå°‘ç§’//è¾“å‡ºç»“æœ</span>
        <span class="c1">// long sec = diff % nd % nh % nm / ns;</span>
        <span class="k">return</span> <span class="n">day</span> <span class="o">+</span> <span class="s">"å¤©"</span> <span class="o">+</span> <span class="n">hour</span> <span class="o">+</span> <span class="s">"å°æ—¶"</span> <span class="o">+</span> <span class="n">min</span> <span class="o">+</span> <span class="s">"åˆ†é’Ÿ"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * æ ¹æ®æ—¥æœŸè·å–æ˜ŸæœŸ ï¼ˆ2019-05-06 â€”â€”&gt; æ˜ŸæœŸä¸€ï¼‰
     * @param datetime
     * @return
     * qinfen
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">dateToWeek</span><span class="o">(</span><span class="nc">String</span> <span class="n">datetime</span><span class="o">)</span> <span class="o">{</span>

        <span class="nc">SimpleDateFormat</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">);</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">weekDays</span> <span class="o">=</span> <span class="o">{</span><span class="s">"æ˜ŸæœŸæ—¥"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸä¸€"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸäºŒ"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸä¸‰"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸå››"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸäº”"</span><span class="o">,</span> <span class="s">"æ˜ŸæœŸå…­"</span><span class="o">};</span>
        <span class="nc">Calendar</span> <span class="n">cal</span> <span class="o">=</span> <span class="nc">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
        <span class="nc">Date</span> <span class="n">date</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">datetime</span><span class="o">);</span>
            <span class="n">cal</span><span class="o">.</span><span class="na">setTime</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">ParseException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">//ä¸€å‘¨çš„ç¬¬å‡ å¤©</span>
        <span class="kt">int</span> <span class="n">w</span> <span class="o">=</span> <span class="n">cal</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="nc">Calendar</span><span class="o">.</span><span class="na">DAY_OF_WEEK</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">w</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">return</span> <span class="n">weekDays</span><span class="o">[</span><span class="n">w</span><span class="o">];</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="éšæœºæ•°å·¥å…·ç±»">éšæœºæ•°å·¥å…·ç±»</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @ClassName: RandomUtil
 * @Description: éšæœºæ•°å·¥å…·ç±»
 * qinfen
 * (åˆ†åˆ«ä½¿ç”¨java.util.Randomã€Apache Common Math3ã€Apache Common Lang3ã€TreadLocalRandom)
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RandomUtil</span> <span class="o">{</span>
    <span class="cm">/**
     * éšæœºæ•°ç”Ÿæˆæ— è¾¹ç•Œçš„Int
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getRandomForIntegerUnbounded</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">intUnbounded</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextInt</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intUnbounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">intUnbounded</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç”Ÿæˆæœ‰è¾¹ç•Œçš„Int
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getRandomForIntegerBounded</span><span class="o">(</span><span class="kt">int</span> <span class="n">min</span><span class="o">,</span> <span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">intBounded</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="o">((</span><span class="kt">int</span><span class="o">)</span> <span class="o">(</span><span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextFloat</span><span class="o">()</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">)));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intBounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">intBounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Common Math3æ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Int,åŒ…å«1è€Œä¸åŒ…å«10
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getRandomForIntegerBounded2</span><span class="o">(</span><span class="kt">int</span> <span class="n">min</span><span class="o">,</span> <span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">intBounded</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomDataGenerator</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intBounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">intBounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ç”¨Apache Common Lang3çš„å·¥å…·ç±»æ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Int,åŒ…å«1ä¸”åŒ…å«10
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getRandomForIntegerBounded3</span><span class="o">(</span><span class="kt">int</span> <span class="n">min</span><span class="o">,</span> <span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">intBounded</span> <span class="o">=</span> <span class="nc">RandomUtils</span><span class="o">.</span><span class="na">nextInt</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intBounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">intBounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨TreadLocalRandomæ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Int,åŒ…å«minè€Œä¸åŒ…å«max
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getRandomForIntegerBounded4</span><span class="o">(</span><span class="kt">int</span> <span class="n">min</span><span class="o">,</span> <span class="kt">int</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">threadIntBound</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">threadIntBound</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">threadIntBound</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * éšæœºæ•°ç”Ÿæˆæ— è¾¹ç•Œçš„Long
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">getRandomForLongUnbounded</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">unboundedLong</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextLong</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">unboundedLong</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">unboundedLong</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Randomç”Ÿæˆæœ‰è¾¹ç•Œçš„Long
     * å› ä¸ºRandomç±»ä½¿ç”¨çš„ç§å­æ˜¯48bitsï¼Œæ‰€ä»¥nextLongä¸èƒ½è¿”å›æ‰€æœ‰å¯èƒ½çš„longå€¼ï¼Œlongæ˜¯64bits
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">getRandomForLongBounded</span><span class="o">(</span><span class="kt">long</span> <span class="n">min</span><span class="o">,</span> <span class="kt">long</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">rangeLong</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="o">(((</span><span class="kt">long</span><span class="o">)</span> <span class="o">(</span><span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">()</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">))));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rangeLong</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">rangeLong</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Commons Math3æ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Long(RandomDataGeneratorç±»æä¾›çš„ç”Ÿæˆéšæœºæ•°çš„æ–¹æ³•)
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">getRandomForLongBounded2</span><span class="o">(</span><span class="kt">long</span> <span class="n">min</span><span class="o">,</span> <span class="kt">long</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">rangeLong</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomDataGenerator</span><span class="o">().</span><span class="na">nextLong</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">rangeLong</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">rangeLong</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Commons Lang3çš„å·¥å…·ç±»æ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Long(RandomUtilsæä¾›äº†å¯¹java.util.Randomçš„è¡¥å……)
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">getRandomForLongBounded3</span><span class="o">(</span><span class="kt">long</span> <span class="n">min</span><span class="o">,</span> <span class="kt">long</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">longBounded</span> <span class="o">=</span> <span class="nc">RandomUtils</span><span class="o">.</span><span class="na">nextLong</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">longBounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">longBounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨ThreadLocalRandomç”Ÿæˆæœ‰è¾¹ç•Œçš„Long
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">long</span> <span class="nf">getRandomForLongBounded4</span><span class="o">(</span><span class="kt">long</span> <span class="n">min</span><span class="o">,</span> <span class="kt">long</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">long</span> <span class="n">threadLongBound</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextLong</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">threadLongBound</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">threadLongBound</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * éšæœºæ•°Floatçš„ç”Ÿæˆç”Ÿæˆ0.0-1.0ä¹‹é—´çš„Floatéšæœºæ•°
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">float</span> <span class="nf">getRandomForFloat0To1</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">float</span> <span class="n">floatUnbounded</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextFloat</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">floatUnbounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">floatUnbounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä»¥ä¸Šåªä¼šç”ŸæˆåŒ…å«0.0è€Œä¸åŒ…æ‹¬1.0çš„floatç±»å‹éšæœºæ•°ç”Ÿæˆæœ‰è¾¹ç•Œçš„Floatéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">float</span> <span class="nf">getRandomForFloatBounded</span><span class="o">(</span><span class="kt">float</span> <span class="n">min</span><span class="o">,</span> <span class="kt">float</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">float</span> <span class="n">floatBounded</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextFloat</span><span class="o">()</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">floatBounded</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">floatBounded</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Common Mathæ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Floatéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">float</span> <span class="nf">getRandomForFloatBounded2</span><span class="o">(</span><span class="kt">float</span> <span class="n">min</span><span class="o">,</span> <span class="kt">float</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">float</span> <span class="n">randomFloat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomDataGenerator</span><span class="o">().</span><span class="na">getRandomGenerator</span><span class="o">().</span><span class="na">nextFloat</span><span class="o">();</span>
        <span class="kt">float</span> <span class="n">generatedFloat</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="n">randomFloat</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatedFloat</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatedFloat</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Common Langæ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Floatéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">float</span> <span class="nf">getRandomForFloatBounded3</span><span class="o">(</span><span class="kt">float</span> <span class="n">min</span><span class="o">,</span> <span class="kt">float</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">float</span> <span class="n">generatedFloat</span> <span class="o">=</span> <span class="nc">RandomUtils</span><span class="o">.</span><span class="na">nextFloat</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatedFloat</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatedFloat</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// ä½¿ç”¨ThreadLocalRandomç”Ÿæˆæœ‰è¾¹ç•Œçš„Floatéšæœºæ•°</span>
    <span class="c1">// ThreadLocalRandomç±»æ²¡æœ‰æä¾›</span>

    <span class="cm">/**
     * ç”Ÿæˆ0.0d-1.0dä¹‹é—´çš„Doubleéšæœºæ•°
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandomForDouble0To1</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">generatorDouble</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatorDouble</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatorDouble</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä¸Floatç›¸åŒï¼Œä»¥ä¸Šæ–¹æ³•åªä¼šç”ŸæˆåŒ…å«0.0dè€Œä¸åŒ…å«1.0dçš„éšæœºæ•°ç”Ÿæˆå¸¦æœ‰è¾¹ç•Œçš„Doubleéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandomForDoubleBounded</span><span class="o">(</span><span class="kt">double</span> <span class="n">min</span><span class="o">,</span> <span class="kt">double</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">boundedDouble</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="k">new</span> <span class="nc">Random</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">()</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">boundedDouble</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">boundedDouble</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**
     * ä½¿ç”¨Apache Common Mathæ¥ç”Ÿæˆæœ‰è¾¹ç•Œçš„Doubleéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandomForDoubleBounded2</span><span class="o">(</span><span class="kt">double</span> <span class="n">min</span><span class="o">,</span> <span class="kt">double</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">boundedDouble</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RandomDataGenerator</span><span class="o">().</span><span class="na">getRandomGenerator</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">();</span>
        <span class="kt">double</span> <span class="n">generatorDouble</span> <span class="o">=</span> <span class="n">min</span> <span class="o">+</span> <span class="n">boundedDouble</span> <span class="o">*</span> <span class="o">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatorDouble</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatorDouble</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ä½¿ç”¨Apache Common Langç”Ÿæˆæœ‰è¾¹ç•Œçš„Doubleéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandomForDoubleBounded3</span><span class="o">(</span><span class="kt">double</span> <span class="n">min</span><span class="o">,</span> <span class="kt">double</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">generatedDouble</span> <span class="o">=</span> <span class="nc">RandomUtils</span><span class="o">.</span><span class="na">nextDouble</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatedDouble</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatedDouble</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ä½¿ç”¨ThreadLocalRandomç”Ÿæˆæœ‰è¾¹ç•Œçš„Doubleéšæœºæ•°
     * @param min
     * @param max
     * @return
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">getRandomForDoubleBounded4</span><span class="o">(</span><span class="kt">double</span> <span class="n">min</span><span class="o">,</span> <span class="kt">double</span> <span class="n">max</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">double</span> <span class="n">generatedDouble</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextDouble</span><span class="o">(</span><span class="n">min</span><span class="o">,</span> <span class="n">max</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">generatedDouble</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">generatedDouble</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="dateå­—ç¬¦ä¸²è½¬date">Dateå­—ç¬¦ä¸²è½¬Date</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.text.ParseException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Locale</span><span class="o">;</span>

<span class="nc">String</span> <span class="n">x</span> <span class="o">=</span> <span class="s">"Mon Mar 02 13:57:49 CST 2015"</span><span class="o">;</span>
       <span class="nc">SimpleDateFormat</span> <span class="n">sdf1</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span> <span class="o">(</span><span class="s">"EEE MMM dd HH:mm:ss Z yyyy"</span><span class="o">,</span> <span class="nc">Locale</span><span class="o">.</span><span class="na">UK</span><span class="o">);</span>
       <span class="k">try</span>
       <span class="o">{</span>
       	    <span class="nc">Date</span> <span class="n">date</span><span class="o">=</span><span class="n">sdf1</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">x</span><span class="o">);</span>
           <span class="nc">SimpleDateFormat</span> <span class="n">sdf</span><span class="o">=</span><span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">);</span>
           <span class="nc">String</span> <span class="n">sDate</span><span class="o">=</span><span class="n">sdf</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
           <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">sDate</span><span class="o">);</span>
       <span class="o">}</span>
       <span class="k">catch</span> <span class="o">(</span><span class="nc">ParseException</span> <span class="n">e</span><span class="o">)</span>
       <span class="o">{</span>
           <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
       <span class="o">}</span>
<span class="c1">//å…ˆæŠŠå­—ç¬¦ä¸²è½¬åŒ–æˆDateï¼Œå†æŠŠDateè½¬æ¢æˆä½ æƒ³è¦çš„æ ¼å¼</span>
</code></pre></div></div>

<h3 id="æ»¡åœ°å‘çš„liståˆ—è¡¨">æ»¡åœ°å‘çš„Liståˆ—è¡¨</h3>

<h4 id="arraysaslist">Arrays.asList</h4>

<ul>
  <li>æˆ‘ä»¬åˆå§‹åŒ–ä¸‰ä¸ªæ•°å­—çš„ int[]æ•°ç»„ï¼Œç„¶åä½¿ç”¨ Arrays.asList æŠŠæ•°ç»„è½¬æ¢ä¸ºList</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">};</span>
<span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"list:{} size:{} class:{}"</span><span class="o">,</span> <span class="n">list</span><span class="o">,</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getClass</span><span class="o">());</span>
<span class="cm">/*è¿™ä¸ªList åŒ…å«çš„å…¶å®æ˜¯ä¸€ä¸ª int æ•°ç»„ï¼Œæ•´ä¸ª List çš„å…ƒç´ ä¸ªæ•°æ˜¯ 1ï¼Œå…ƒç´ ç±»å‹æ˜¯æ•´æ•°æ•°ç»„ã€‚
å…¶åŸå› æ˜¯ï¼Œåªèƒ½æ˜¯æŠŠ int è£…ç®±ä¸º Integerï¼Œä¸å¯èƒ½æŠŠ int æ•°ç»„è£…ç®±ä¸º Integer æ•°ç»„ã€‚æˆ‘ä»¬çŸ¥
é“ï¼ŒArrays.asList æ–¹æ³•ä¼ å…¥çš„æ˜¯ä¸€ä¸ªæ³›å‹ T ç±»å‹å¯å˜å‚æ•°ï¼Œæœ€ç»ˆ int æ•°ç»„æ•´ä½“ä½œä¸ºäº†ä¸€ä¸ª
å¯¹è±¡æˆä¸ºäº†æ³›å‹ç±»å‹ T
*/</span>
</code></pre></div></div>

<ul>
  <li>ç›´æ¥éå†è¿™æ ·çš„ List å¿…ç„¶ä¼šå‡ºç° Bugï¼Œä¿®å¤æ–¹å¼æœ‰ä¸¤ç§ï¼Œå¦‚æœä½¿ç”¨ Java8 ä»¥ä¸Šç‰ˆæœ¬å¯ä»¥ä½¿
ç”¨ Arrays.stream æ–¹æ³•æ¥è½¬æ¢ï¼Œå¦åˆ™å¯ä»¥æŠŠ int æ•°ç»„å£°æ˜ä¸ºåŒ…è£…ç±»å‹ Integer æ•°ç»„</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span><span class="o">[]</span> <span class="n">arr1</span> <span class="o">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">};</span>
<span class="nc">List</span> <span class="n">list1</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">stream</span><span class="o">(</span><span class="n">arr1</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"list:{} size:{} class:{}"</span><span class="o">,</span> <span class="n">list1</span><span class="o">,</span> <span class="n">list1</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="n">list1</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getClass</span><span class="o">());</span>

<span class="nc">Integer</span><span class="o">[]</span> <span class="n">arr2</span> <span class="o">=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">};</span>
<span class="nc">List</span> <span class="n">list2</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">arr2</span><span class="o">);</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"list:{} size:{} class:{}"</span><span class="o">,</span> <span class="n">list2</span><span class="o">,</span> <span class="n">list2</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="n">list2</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getClass</span><span class="o">());</span>
</code></pre></div></div>

<ul>
  <li><strong>ç¬¬ä¸€ä¸ªå‘ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ Arrays.asList æ¥è½¬æ¢åŸºæœ¬ç±»å‹æ•°ç»„</strong></li>
  <li><strong>ç¬¬äºŒä¸ªå‘ï¼ŒArrays.asList è¿”å›çš„ List ä¸æ”¯æŒå¢åˆ æ“ä½œ</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="o">{</span><span class="s">"1"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">};</span>
<span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">arr</span><span class="o">);</span>
<span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="s">"4"</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"5"</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"arr:{} list:{}"</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">arr</span><span class="o">),</span> <span class="n">list</span><span class="o">);</span>

<span class="cm">/*
æ—¥å¿—é‡Œæœ‰ä¸€ä¸ª UnsupportedOperationExceptionï¼Œä¸º List æ–°å¢å­—ç¬¦ä¸² 5 çš„æ“
ä½œå¤±è´¥äº†ï¼Œè€Œä¸”æŠŠåŸå§‹æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ä» 2 ä¿®æ”¹ä¸º 4 åï¼ŒasList è·å¾—çš„ List ä¸­çš„ç¬¬äºŒä¸ª
å…ƒç´ ä¹Ÿè¢«ä¿®æ”¹ä¸º 4 äº†
*/</span>
</code></pre></div></div>

<ul>
  <li>Arrays.asList è¿”å›çš„ List å¹¶ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„ java.util.ArrayListï¼Œè€Œæ˜¯ Arrays çš„å†…éƒ¨ç±» ArrayListã€‚ArrayList å†…éƒ¨ç±»ç»§æ‰¿è‡ªAbstractList ç±»ï¼Œå¹¶æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„ add æ–¹æ³•ï¼Œè€Œçˆ¶ç±»ä¸­ add æ–¹æ³•çš„å®ç°ï¼Œå°±æ˜¯æŠ›å‡º
UnsupportedOperationExceptionã€‚</li>
  <li><strong>ç¬¬ä¸‰ä¸ªå‘ï¼Œå¯¹åŸå§‹æ•°ç»„çš„ä¿®æ”¹ä¼šå½±å“åˆ°æˆ‘ä»¬è·å¾—çš„é‚£ä¸ª Listã€‚</strong></li>
  <li>ArrayList å…¶å®æ˜¯ç›´æ¥ä½¿ç”¨äº†åŸå§‹çš„æ•°ç»„ã€‚Arrays.asList è·å¾—çš„ List äº¤ç»™å…¶ä»–æ–¹æ³•å¤„ç†ï¼Œå¾ˆå®¹æ˜“å› ä¸ºå…±äº«äº†æ•°ç»„ï¼Œç›¸äº’ä¿®æ”¹äº§ç”ŸBugã€‚</li>
  <li>ä¿®å¤æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œé‡æ–° new ä¸€ä¸ª ArrayList åˆå§‹åŒ– Arrays.asList è¿”å›çš„ List å³å¯</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">String</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="o">{</span><span class="s">"1"</span><span class="o">,</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"3"</span><span class="o">};</span>
<span class="nc">List</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">arr</span><span class="o">));</span>
<span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="s">"4"</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"5"</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
<span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"arr:{} list:{}"</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">arr</span><span class="o">),</span> <span class="n">list</span><span class="o">);</span>
</code></pre></div></div>

<ul>
  <li>ä¿®æ”¹åçš„ä»£ç å®ç°äº†åŸå§‹æ•°ç»„å’Œ List çš„â€œè§£è€¦â€ï¼Œä¸å†ç›¸äº’å½±å“ã€‚åŒæ—¶ï¼Œå› ä¸ºæ“ä½œçš„æ˜¯çœŸæ­£çš„ ArrayListï¼Œadd ä¹Ÿä¸å†å‡ºé”™</li>
</ul>

<h4 id="ä½¿ç”¨-listsublistä¼šoom">ä½¿ç”¨ List.subListä¼šOOM</h4>

<ul>
  <li>List.subList è¿”å›çš„å­List ä¸æ˜¯ä¸€ä¸ªæ™®é€šçš„ ArrayListã€‚è¿™ä¸ªå­ List å¯ä»¥è®¤ä¸ºæ˜¯åŸå§‹ List çš„è§†å›¾ï¼Œä¼šå’ŒåŸå§‹ List ç›¸äº’å½±å“ã€‚å¦‚æœä¸æ³¨æ„ï¼Œå¾ˆå¯èƒ½ä¼šå› æ­¤äº§ç”Ÿ OOM é—®é¢˜ã€‚</li>
  <li>å®šä¹‰ä¸€ä¸ªåä¸º data çš„é™æ€ List æ¥å­˜æ”¾ Integer çš„ Listï¼Œä¹Ÿå°±æ˜¯è¯´ data çš„æˆå‘˜æœ¬èº«æ˜¯åŒ…å«äº†å¤šä¸ªæ•°å­—çš„ Listã€‚å¾ªç¯ 1000 æ¬¡ï¼Œæ¯æ¬¡éƒ½ä»ä¸€ä¸ªå…·æœ‰ 10 ä¸‡ä¸ª Integer çš„List ä¸­ï¼Œä½¿ç”¨ subList æ–¹æ³•è·å¾—ä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªæ•°å­—çš„å­ Listï¼Œå¹¶æŠŠè¿™ä¸ªå­ List åŠ å…¥ dataå˜é‡</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>   
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">oom</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">rawList</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">100000</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
            <span class="n">data</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">rawList</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="cm">/*
ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œè¿™ä¸ª data å˜é‡é‡Œé¢æœ€ç»ˆä¿å­˜çš„åªæ˜¯ 1000 ä¸ªå…·æœ‰ 1 ä¸ªå…ƒç´ çš„ Listï¼Œä¸ä¼šå 
ç”¨å¾ˆå¤§ç©ºé—´ï¼Œä½†ç¨‹åºè¿è¡Œä¸ä¹…å°±å‡ºç°äº† OOM
*/</span>
</code></pre></div></div>

<ul>
  <li><strong>å‡ºç° OOM çš„åŸå› æ˜¯ï¼Œå¾ªç¯ä¸­çš„ 1000 ä¸ªå…·æœ‰ 10 ä¸‡ä¸ªå…ƒç´ çš„ List å§‹ç»ˆå¾—ä¸åˆ°å›æ”¶ï¼Œå› ä¸ºå®ƒå§‹ç»ˆè¢« subList æ–¹æ³•è¿”å›çš„ List å¼ºå¼•ç”¨ã€‚</strong></li>
  <li>é¦–å…ˆåˆå§‹åŒ–ä¸€ä¸ªåŒ…å«æ•°å­— 1 åˆ° 10 çš„ ArrayListï¼Œç„¶åé€šè¿‡è°ƒç”¨ subList æ–¹æ³•å–å‡º 2ã€3ã€4ï¼›éšååˆ é™¤è¿™ä¸ª SubList ä¸­çš„å…ƒç´ æ•°å­— 3ï¼Œå¹¶æ‰“å°åŸå§‹çš„ ArrayListï¼›æœ€åä¸ºåŸå§‹çš„ArrayList å¢åŠ ä¸€ä¸ªå…ƒç´ æ•°å­— 0ï¼Œéå† SubList è¾“å‡ºæ‰€æœ‰å…ƒç´ </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">subList</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">subList</span><span class="o">);</span>
<span class="n">subList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="n">subList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">ex</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>

<span class="cm">/*
[2, 3, 4]
[1, 2, 4, 5, 6, 7, 8, 9, 10]
java.util.ConcurrentModificationException
at java.util.ArrayList$SubList.checkForComodification(ArrayList.java:1239)
at java.util.ArrayList$SubList.listIterator(ArrayList.java:1099)
at java.util.AbstractList.listIterator(AbstractList.java:299)
at java.util.ArrayList$SubList.iterator(ArrayList.java:1095)
at java.lang.Iterable.forEach(Iterable.java:74)
åŸå§‹ List ä¸­æ•°å­— 3 è¢«åˆ é™¤äº†ï¼Œè¯´æ˜åˆ é™¤å­ List ä¸­çš„å…ƒç´ å½±å“åˆ°äº†åŸå§‹ Listï¼›
å°è¯•ä¸ºåŸå§‹ List å¢åŠ æ•°å­— 0 ä¹‹åå†éå†å­ Listï¼Œä¼šå‡ºç°ConcurrentModificationExceptionã€‚
*/</span>
</code></pre></div></div>

<ul>
  <li>ç¬¬ä¸€ï¼ŒArrayList ç»´æŠ¤äº†ä¸€ä¸ªå«ä½œ modCount çš„å­—æ®µï¼Œè¡¨ç¤ºé›†åˆç»“æ„æ€§ä¿®æ”¹çš„æ¬¡æ•°ã€‚æ‰€è°“
ç»“æ„æ€§ä¿®æ”¹ï¼ŒæŒ‡çš„æ˜¯å½±å“ List å¤§å°çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ add æ“ä½œå¿…ç„¶ä¼šæ”¹å˜ modCount çš„å€¼ã€‚</li>
  <li>ç¬¬äºŒï¼Œè·å¾—çš„ List å…¶å®æ˜¯å†…éƒ¨ç±» SubListï¼Œå¹¶ä¸æ˜¯æ™®é€šçš„ ArrayListï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼ å…¥äº† thisã€‚</li>
  <li>ç¬¬ä¸‰ï¼Œè¿™ä¸ª SubList ä¸­çš„ parent å­—æ®µå°±æ˜¯åŸå§‹çš„Listã€‚SubList åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŠŠåŸå§‹ List ä¸­çš„å…ƒç´ å¤åˆ¶åˆ°ç‹¬ç«‹çš„å˜é‡ä¸­ä¿å­˜ã€‚æˆ‘ä»¬å¯ä»¥è®¤ä¸º SubList æ˜¯åŸå§‹ List çš„è§†å›¾ï¼Œå¹¶ä¸æ˜¯ç‹¬ç«‹çš„ Listã€‚åŒæ–¹å¯¹å…ƒç´ çš„ä¿®æ”¹ä¼šç›¸äº’å½±å“ï¼Œè€Œä¸” SubList å¼ºå¼•ç”¨äº†åŸå§‹çš„ Listï¼Œæ‰€ä»¥å¤§é‡ä¿å­˜è¿™æ ·çš„ SubList ä¼šå¯¼è‡´ OOMã€‚</li>
  <li>ç¬¬å››ï¼Œéå† SubList çš„æ—¶å€™ä¼šå…ˆè·å¾—è¿­ä»£å™¨ï¼Œæ¯”è¾ƒåŸå§‹ArrayList modCount çš„å€¼å’Œ SubList å½“å‰ modCount çš„å€¼ã€‚è·å¾—äº† SubList åï¼Œæˆ‘ä»¬ä¸ºåŸå§‹ List æ–°å¢äº†ä¸€ä¸ªå…ƒç´ ä¿®æ”¹äº†å…¶ modCountï¼Œæ‰€ä»¥åˆ¤ç­‰å¤±è´¥æŠ›å‡º
ConcurrentModificationException å¼‚å¸¸ã€‚</li>
  <li>æ—¢ç„¶ SubList ç›¸å½“äºåŸå§‹ List çš„è§†å›¾ï¼Œé‚£ä¹ˆé¿å…ç›¸äº’å½±å“çš„ä¿®å¤æ–¹å¼æœ‰ä¸¤ç§ï¼š
    <ul>
      <li>ä¸€ç§æ˜¯ï¼Œä¸ç›´æ¥ä½¿ç”¨ subList æ–¹æ³•è¿”å›çš„ SubListï¼Œè€Œæ˜¯é‡æ–°ä½¿ç”¨ new ArrayListï¼Œåœ¨æ„é€ æ–¹æ³•ä¼ å…¥ SubListï¼Œæ¥æ„å»ºä¸€ä¸ªç‹¬ç«‹çš„ ArrayListï¼›</li>
      <li>å¦ä¸€ç§æ˜¯ï¼Œå¯¹äº Java 8 ä½¿ç”¨ Stream çš„ skip å’Œ limit API æ¥è·³è¿‡æµä¸­çš„å…ƒç´ ï¼Œä»¥åŠé™åˆ¶æµä¸­å…ƒç´ çš„ä¸ªæ•°ï¼ŒåŒæ ·å¯ä»¥è¾¾åˆ° SubList åˆ‡ç‰‡çš„ç›®çš„ã€‚</li>
    </ul>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//æ–¹å¼ä¸€</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">subList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">list</span><span class="o">.</span><span class="na">subList</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">));</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">subList</span><span class="o">);</span>
<span class="n">subList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">subList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>

<span class="c1">//æ–¹å¼2</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">subList</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">skip</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">limit</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">subList</span><span class="o">);</span>
<span class="n">subList</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
<span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="n">subList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</code></pre></div></div>

<h4 id="é€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„">é€‰ç”¨åˆé€‚çš„æ•°æ®ç»“æ„</h4>

<h5 id="listvsmap">ListVSMap</h5>

<ul>
  <li>ç¬¬ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼Œä½¿ç”¨æ•°æ®ç»“æ„ä¸è€ƒè™‘å¹³è¡¡æ—¶é—´å’Œç©ºé—´ã€‚</li>
  <li>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªåªæœ‰ä¸€ä¸ª int ç±»å‹è®¢å•å·å­—æ®µçš„ Order ç±»</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">static</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kt">int</span> <span class="n">orderId</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>å®šä¹‰ä¸€ä¸ªåŒ…å« elementCount å’Œ loopCount ä¸¤ä¸ªå‚æ•°çš„ listSearch æ–¹æ³•ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå…·æœ‰ elementCount ä¸ªè®¢å•å¯¹è±¡çš„ ArrayListï¼Œå¾ªç¯ loopCount æ¬¡æœç´¢è¿™ä¸ªArrayListï¼Œæ¯æ¬¡éšæœºæœç´¢ä¸€ä¸ªè®¢å•å·</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">listSearch</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Order</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">mapToObj</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="n">i</span><span class="o">)).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">search</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">);</span>
            <span class="nc">Order</span> <span class="n">result</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">().</span><span class="na">filter</span><span class="o">(</span><span class="n">order</span> <span class="o">-&gt;</span> <span class="n">order</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">()</span> <span class="o">==</span> <span class="n">search</span><span class="o">).</span><span class="na">findFirst</span><span class="o">().</span><span class="na">orElse</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
            <span class="nc">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">result</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">()</span> <span class="o">==</span> <span class="n">search</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>å®šä¹‰å¦ä¸€ä¸ª mapSearch æ–¹æ³•ï¼Œä»ä¸€ä¸ªå…·æœ‰ elementCount ä¸ªå…ƒç´ çš„ Map ä¸­å¾ªç¯loopCount æ¬¡æŸ¥æ‰¾éšæœºè®¢å•å·ã€‚Map çš„ Key æ˜¯è®¢å•å·ï¼ŒValue æ˜¯è®¢å•å¯¹è±¡</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Object</span> <span class="nf">mapSearch</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Order</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toMap</span><span class="o">(</span><span class="nc">Function</span><span class="o">.</span><span class="na">identity</span><span class="o">(),</span> <span class="n">i</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">Order</span><span class="o">(</span><span class="n">i</span><span class="o">)));</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">search</span> <span class="o">=</span> <span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">);</span>
            <span class="nc">Order</span> <span class="n">result</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">search</span><span class="o">);</span>
            <span class="nc">Assert</span><span class="o">.</span><span class="na">assertTrue</span><span class="o">(</span><span class="n">result</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">result</span><span class="o">.</span><span class="na">getOrderId</span><span class="o">()</span> <span class="o">==</span> <span class="n">search</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="n">map</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>å¯¹ 100 ä¸‡ä¸ªå…ƒç´ çš„ ArrayList å’Œ HashMapï¼Œåˆ†åˆ«è°ƒç”¨ listSearch å’ŒmapSearch æ–¹æ³•è¿›è¡Œ 1000 æ¬¡æœç´¢</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">elementCount</span> <span class="o">=</span> <span class="mi">1000000</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">loopCount</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">;</span>
<span class="nc">StopWatch</span> <span class="n">stopWatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StopWatch</span><span class="o">();</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"listSearch"</span><span class="o">);</span>
<span class="nc">Object</span> <span class="n">list</span> <span class="o">=</span> <span class="n">listSearch</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">ObjectSizeCalculator</span><span class="o">.</span><span class="na">getObjectSize</span><span class="o">(</span><span class="n">list</span><span class="o">));</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"mapSearch"</span><span class="o">);</span>
<span class="nc">Object</span> <span class="n">map</span> <span class="o">=</span> <span class="n">mapSearch</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">ObjectSizeCalculator</span><span class="o">.</span><span class="na">getObjectSize</span><span class="o">(</span><span class="n">map</span><span class="o">));</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stopWatch</span><span class="o">.</span><span class="na">prettyPrint</span><span class="o">());</span>
<span class="nc">TimeUnit</span><span class="o">.</span><span class="na">HOURS</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>

<span class="cm">/*
å¯ä»¥çœ‹åˆ°ï¼Œä»…ä»…æ˜¯ 1000 æ¬¡æœç´¢ï¼ŒlistSearch æ–¹æ³•è€—æ—¶ 3.3 ç§’ï¼Œè€Œ mapSearch è€—æ—¶ä»…ä»…108 æ¯«ç§’ã€‚

*/</span>
</code></pre></div></div>

<ul>
  <li>æœç´¢ ArrayList çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Œè€Œ HashMap çš„ get æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ã€‚æ‰€ä»¥ï¼Œè¦å¯¹å¤§ List è¿›è¡Œå•å€¼æœç´¢çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ HashMapï¼Œå…¶ä¸­ Key æ˜¯è¦æœç´¢çš„å€¼ï¼ŒValue æ˜¯åŸå§‹å¯¹è±¡ï¼Œä¼šæ¯”ä½¿ç”¨ ArrayList æœ‰éå¸¸æ˜æ˜¾çš„æ€§èƒ½ä¼˜åŠ¿ã€‚</li>
  <li>å³ä½¿æˆ‘ä»¬è¦æœç´¢çš„ä¸æ˜¯å•å€¼è€Œæ˜¯æ¡ä»¶åŒºé—´ï¼Œä¹Ÿå¯ä»¥å°è¯•ä½¿ç”¨ HashMap æ¥è¿›è¡Œâ€œæœç´¢æ€§èƒ½ä¼˜åŒ–â€ã€‚å¦‚æœä½ çš„æ¡ä»¶åŒºé—´æ˜¯å›ºå®šçš„è¯ï¼Œå¯ä»¥æå‰æŠŠ HashMap æŒ‰ç…§æ¡ä»¶åŒºé—´è¿›è¡Œåˆ†ç»„ï¼ŒKey å°±æ˜¯ä¸åŒçš„åŒºé—´ã€‚</li>
  <li>ç±»ä¼¼ï¼Œå¦‚æœè¦å¯¹å¤§ ArrayList è¿›è¡Œå»é‡æ“ä½œï¼Œä¹Ÿä¸å»ºè®®ä½¿ç”¨ contains æ–¹æ³•ï¼Œè€Œæ˜¯å¯ä»¥è€ƒè™‘ä½¿ç”¨HashSet è¿›è¡Œå»é‡ã€‚ä½¿ç”¨ HashMap æ˜¯å¦ä¼šç‰ºç‰²ç©ºé—´å‘¢ï¼Ÿåˆ†æå †å¯ä»¥å†æ¬¡è¯æ˜ï¼ŒArrayList åœ¨å†…å­˜å ç”¨ä¸Šæ€§ä»·æ¯”å¾ˆé«˜ã€‚æ‰€ä»¥ï¼Œåœ¨åº”ç”¨å†…å­˜åƒç´§çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ˜¯å¦å€¼å¾—ä½¿ç”¨æ›´å¤šçš„å†…å­˜æ¶ˆè€—æ¥æ¢å–æ›´é«˜çš„æ€§èƒ½ã€‚</li>
</ul>

<h5 id="arrayvslinked">ArrayVSLinked</h5>

<ul>
  <li><strong>ç¬¬äºŒä¸ªè¯¯åŒºæ˜¯ï¼Œè¿‡äºè¿·ä¿¡æ•™ç§‘ä¹¦çš„å¤§ O æ—¶é—´å¤æ‚åº¦ã€‚</strong></li>
  <li>å¯¹äºæ•°ç»„ï¼Œéšæœºå…ƒç´ è®¿é—®çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)ï¼Œå…ƒç´ æ’å…¥æ“ä½œæ˜¯ O(n)ï¼›</li>
  <li>å¯¹äºé“¾è¡¨ï¼Œéšæœºå…ƒç´ è®¿é—®çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Œå…ƒç´ æ’å…¥æ“ä½œæ˜¯ O(1)ã€‚</li>
  <li>å®šä¹‰å››ä¸ªå‚æ•°ä¸€è‡´çš„æ–¹æ³•ï¼Œåˆ†åˆ«å¯¹å…ƒç´ ä¸ªæ•°ä¸º elementCount çš„ LinkedList å’Œ
ArrayListï¼Œå¾ªç¯ loopCount æ¬¡ï¼Œè¿›è¡Œéšæœºè®¿é—®å’Œå¢åŠ å…ƒç´ åˆ°éšæœºä½ç½®çš„æ“ä½œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c1">//LinkedListè®¿é—®</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">linkedListGet</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">LinkedList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">)));</span>
    <span class="o">}</span>

<span class="c1">//ArrayListè®¿é—®</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">arrayListGet</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">)));</span>
    <span class="o">}</span>

<span class="c1">//LinkedListæ’å…¥</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">linkedListAdd</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">LinkedList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">),</span> <span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>

<span class="c1">//ArrayListæ’å…¥</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">arrayListAdd</span><span class="o">(</span><span class="kt">int</span> <span class="n">elementCount</span><span class="o">,</span> <span class="kt">int</span> <span class="n">loopCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">elementCount</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="nc">ThreadLocalRandom</span><span class="o">.</span><span class="na">current</span><span class="o">().</span><span class="na">nextInt</span><span class="o">(</span><span class="n">elementCount</span><span class="o">),</span> <span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>æµ‹è¯•</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">elementCount</span> <span class="o">=</span> <span class="mi">100000</span><span class="o">;</span>
<span class="kt">int</span> <span class="n">loopCount</span> <span class="o">=</span> <span class="mi">100000</span><span class="o">;</span>
<span class="nc">StopWatch</span> <span class="n">stopWatch</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StopWatch</span><span class="o">();</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"linkedListGet"</span><span class="o">);</span>
<span class="n">linkedListGet</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"arrayListGet"</span><span class="o">);</span>
<span class="n">arrayListGet</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="n">stopWatch</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stopWatch</span><span class="o">.</span><span class="na">prettyPrint</span><span class="o">());</span>

<span class="nc">StopWatch</span> <span class="n">stopWatch2</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StopWatch</span><span class="o">();</span>
<span class="n">stopWatch2</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"linkedListAdd"</span><span class="o">);</span>
<span class="n">linkedListAdd</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="n">stopWatch2</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="n">stopWatch2</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="s">"arrayListAdd"</span><span class="o">);</span>
<span class="n">arrayListAdd</span><span class="o">(</span><span class="n">elementCount</span><span class="o">,</span> <span class="n">loopCount</span><span class="o">);</span>
<span class="n">stopWatch2</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stopWatch2</span><span class="o">.</span><span class="na">prettyPrint</span><span class="o">());</span>

<span class="cm">/*
åœ¨éšæœºè®¿é—®æ–¹é¢ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† ArrayList çš„ç»å¯¹ä¼˜åŠ¿
ä½†ï¼Œéšæœºæ’å…¥æ“ä½œå±…ç„¶ä¹Ÿæ˜¯ LinkedList è½è´¥
---------------------------------------------
ns % Task name
---------------------------------------------
6604199591 100% linkedListGet
011494583 000% arrayListGet
StopWatch '': running time = 10729378832 ns
---------------------------------------------
ns % Task name
---------------------------------------------
9253355484 086% linkedListAdd
1476023348 014% arrayListAdd
*/</span>
</code></pre></div></div>

<ul>
  <li>ç¿»çœ‹ LinkedList æºç å‘ç°ï¼Œæ’å…¥æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) çš„å‰ææ˜¯ï¼Œä½ å·²ç»æœ‰äº†é‚£ä¸ªè¦
æ’å…¥èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚ä½†ï¼Œåœ¨å®ç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å…ˆé€šè¿‡å¾ªç¯è·å–åˆ°é‚£ä¸ªèŠ‚ç‚¹çš„ Nodeï¼Œç„¶å
å†æ‰§è¡Œæ’å…¥æ“ä½œã€‚å‰è€…ä¹Ÿæ˜¯æœ‰å¼€é”€çš„ï¼Œä¸å¯èƒ½åªè€ƒè™‘æ’å…¥æ“ä½œæœ¬èº«çš„ä»£ä»·</li>
  <li>å¯¹äºæ’å…¥æ“ä½œï¼ŒLinkedList çš„æ—¶é—´å¤æ‚åº¦å…¶å®ä¹Ÿæ˜¯ O(n)ã€‚</li>
</ul>

<h4 id="å…³äºremoveæ–¹æ³•">å…³äºremoveæ–¹æ³•</h4>

<ul>
  <li>è°ƒç”¨ç±»å‹æ˜¯ Integer çš„ ArrayList çš„ remove æ–¹æ³•åˆ é™¤å…ƒç´ ï¼Œä¼ å…¥ä¸€ä¸ª Integer åŒ…è£…ç±»
çš„æ•°å­—å’Œä¼ å…¥ä¸€ä¸ª int åŸºæœ¬ç±»å‹çš„æ•°å­—ï¼Œç»“æœä¸€æ ·å—ï¼Ÿ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ é™¤æŒ‡å®šåæ ‡å…ƒç´     </span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">removeByIndex</span><span class="o">(</span><span class="kt">int</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
                <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">index</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="o">}</span>

<span class="c1">//åˆ é™¤å¯¹åº”å…ƒç´ </span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">removeByValue</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
                <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">boxed</span><span class="o">().</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">index</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>å¾ªç¯éå† Listï¼Œè°ƒç”¨ remove æ–¹æ³•åˆ é™¤å…ƒç´ ï¼Œå¾€å¾€ä¼šé‡åˆ°
ConcurrentModificationException å¼‚å¸¸ï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼Œä¿®å¤æ–¹å¼åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">forEachRemoveWrong</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
                <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">mapToObj</span><span class="o">(</span><span class="nl">String:</span><span class="o">:</span><span class="n">valueOf</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">i</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">"2"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">i</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">list</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">forEachRemoveRight</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
                <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">mapToObj</span><span class="o">(</span><span class="nl">String:</span><span class="o">:</span><span class="n">valueOf</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Iterator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">iterator</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">iterator</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();</span> <span class="o">)</span> <span class="o">{</span>
            <span class="nc">String</span> <span class="n">next</span> <span class="o">=</span> <span class="n">iterator</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="s">"2"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">next</span><span class="o">))</span> <span class="o">{</span>
                <span class="n">iterator</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">forEachRemoveRight2</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span>
                <span class="nc">IntStream</span><span class="o">.</span><span class="na">rangeClosed</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">).</span><span class="na">mapToObj</span><span class="o">(</span><span class="nl">String:</span><span class="o">:</span><span class="n">valueOf</span><span class="o">).</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">ArrayList:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
        <span class="n">list</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"2"</span><span class="o">));</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="çƒ¦äººçš„ç©ºæŒ‡é’ˆ">çƒ¦äººçš„ç©ºæŒ‡é’ˆ</h3>

<h4 id="ä¿®å¤å’Œå®šä½ç©ºæŒ‡é’ˆ">ä¿®å¤å’Œå®šä½ç©ºæŒ‡é’ˆ</h4>

<ul>
  <li>ç©ºæŒ‡é’ˆå¯èƒ½å‡ºç°çš„åœºæ™¯ï¼š
    <ul>
      <li>å‚æ•°å€¼æ˜¯ Integer ç­‰åŒ…è£…ç±»å‹ï¼Œä½¿ç”¨æ—¶å› ä¸ºè‡ªåŠ¨æ‹†ç®±å‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼›</li>
      <li>å­—ç¬¦ä¸²æ¯”è¾ƒå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
      <li>è¯¸å¦‚ ConcurrentHashMap è¿™æ ·çš„å®¹å™¨ä¸æ”¯æŒ Key å’Œ Value ä¸º nullï¼Œå¼ºè¡Œ put null çš„Key æˆ– Value ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
      <li>A å¯¹è±¡åŒ…å«äº† Bï¼Œåœ¨é€šè¿‡ A å¯¹è±¡çš„å­—æ®µè·å¾— B ä¹‹åï¼Œæ²¡æœ‰å¯¹å­—æ®µåˆ¤ç©ºå°±çº§è”è°ƒç”¨ B çš„æ–¹æ³•å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
      <li>æ–¹æ³•æˆ–è¿œç¨‹æœåŠ¡è¿”å›çš„ List ä¸æ˜¯ç©ºè€Œæ˜¯ nullï¼Œæ²¡æœ‰è¿›è¡Œåˆ¤ç©ºå°±ç›´æ¥è°ƒç”¨ List çš„æ–¹æ³•å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</li>
    </ul>
  </li>
  <li>å†™äº†ä¸€ä¸ª wrongMethod æ–¹æ³•ï¼Œå¹¶ä¸€ä¸ª wrong æ–¹æ³•æ¥è°ƒç”¨å®ƒã€‚wrong æ–¹æ³•çš„å…¥å‚ test æ˜¯ä¸€ä¸ªç”± 0 å’Œ 1 æ„æˆçš„ã€é•¿åº¦ä¸º 4 çš„å­—ç¬¦ä¸²ï¼Œç¬¬å‡ ä½è®¾ç½®ä¸º1 å°±ä»£è¡¨ç¬¬å‡ ä¸ªå‚æ•°ä¸º nullï¼Œç”¨æ¥æ§åˆ¶ wrongMethod æ–¹æ³•çš„ 4 ä¸ªå…¥å‚ï¼Œä»¥æ¨¡æ‹Ÿå„ç§ç©ºæŒ‡é’ˆæƒ…å†µ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">wrongMethod</span><span class="o">(</span><span class="nc">FooService</span> <span class="n">fooService</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">i</span><span class="o">,</span> <span class="nc">String</span> <span class="n">s</span><span class="o">,</span> <span class="nc">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"result {} {} {} {}"</span><span class="o">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">s</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"OK"</span><span class="o">),</span> <span class="n">s</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">t</span><span class="o">),</span>
           <span class="k">new</span> <span class="nc">ConcurrentHashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;().</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">fooService</span><span class="o">.</span><span class="na">getBarService</span><span class="o">().</span><span class="na">bar</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"OK"</span><span class="o">))</span>
    <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"OK"</span><span class="o">);</span>
  <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">FooService</span> <span class="o">{</span>
  <span class="nd">@Getter</span>
  <span class="kd">private</span> <span class="nc">BarService</span> <span class="n">barService</span><span class="o">;</span>

<span class="o">}</span>

<span class="kd">class</span> <span class="nc">BarService</span> <span class="o">{</span>
  <span class="nc">String</span> <span class="nf">bar</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"OK"</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"wrong"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">wrong</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"test"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"1111"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">test</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="nf">wrongMethod</span><span class="o">(</span><span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="k">new</span> <span class="nc">FooService</span><span class="o">(),</span>
                     <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="mi">1</span><span class="o">,</span>
                     <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="s">"OK"</span><span class="o">,</span>
                     <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="s">"OK"</span><span class="o">).</span><span class="na">size</span><span class="o">();</span>
<span class="o">}</span>

<span class="cm">/*
è¿™ä¸ªæ¡ˆä¾‹å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸æ˜¯å› ä¸ºå˜é‡æ˜¯ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œå°è¯•è·å¾—å˜é‡çš„å€¼æˆ–è®¿é—®å˜é‡çš„æˆå‘˜ä¼šè·å¾—ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚
ä½†æˆ‘ä»¬å¾ˆéš¾å®šä½å‡ºåˆ°åº•æ˜¯å“ªé‡Œå‡ºç°äº†ç©ºæŒ‡é’ˆï¼Œå¯èƒ½æ˜¯æŠŠå…¥å‚ Integer æ‹†ç®±ä¸º int çš„æ—¶å€™å‡ºç°çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯å…¥å‚çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ä»»æ„ä¸€ä¸ªä¸º nullï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæŠŠ null åŠ å…¥äº† ConcurrentHashMapã€‚

*/</span>
</code></pre></div></div>

<ul>
  <li>æ¨èä½¿ç”¨é˜¿é‡Œå¼€æºçš„ Java æ•…éšœè¯Šæ–­ç¥å™¨ Arthasã€‚Arthas ç®€å•æ˜“ç”¨åŠŸèƒ½å¼ºå¤§ï¼Œå¯ä»¥å®šä½å‡ºå¤§å¤šæ•°çš„ Java ç”Ÿäº§é—®é¢˜ã€‚å¦‚æœæ˜¯åˆ†æ”¯å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œä½ éœ€è¦å†å€ŸåŠ© stack å‘½ä»¤æ¥æŸ¥çœ‹ wrongMethod æ–¹æ³•çš„è°ƒç”¨æ ˆï¼Œå¹¶é…åˆ watch å‘½ä»¤æŸ¥çœ‹å„æ–¹æ³•çš„å…¥å‚ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®šä½åˆ°ç©ºæŒ‡é’ˆçš„æ ¹æºäº†ã€‚</li>
  <li>æˆ‘ä»¬å¯ä»¥å°è¯•åˆ©ç”¨ Java 8 çš„ Optional ç±»æ¥æ¶ˆé™¤è¿™æ ·çš„ if-else é€»è¾‘ï¼Œä½¿ç”¨ä¸€è¡Œä»£ç è¿›è¡Œåˆ¤ç©ºå’Œå¤„ç†ã€‚</li>
  <li>å¯¹äº Integer çš„åˆ¤ç©ºï¼Œå¯ä»¥ä½¿ç”¨ Optional.ofNullable æ¥æ„é€ ä¸€ä¸ª Optionalï¼Œç„¶åä½¿ç”¨orElse(0) æŠŠ null æ›¿æ¢ä¸ºé»˜è®¤å€¼å†è¿›è¡Œ +1 æ“ä½œã€‚</li>
  <li>å¯¹äº String å’Œå­—é¢é‡çš„æ¯”è¾ƒï¼Œå¯ä»¥æŠŠå­—é¢é‡æ”¾åœ¨å‰é¢ï¼Œæ¯”å¦‚â€OKâ€.equals(s)ï¼Œè¿™æ ·å³ä½¿s æ˜¯ null ä¹Ÿä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼›è€Œå¯¹äºä¸¤ä¸ªå¯èƒ½ä¸º null çš„å­—ç¬¦ä¸²å˜é‡çš„ equals æ¯”è¾ƒï¼Œå¯ä»¥ä½¿ç”¨ Objects.equalsï¼Œå®ƒä¼šåšåˆ¤ç©ºå¤„ç†ã€‚</li>
  <li>å¯¹äº ConcurrentHashMapï¼Œæ—¢ç„¶å…¶ Key å’Œ Value éƒ½ä¸æ”¯æŒ nullï¼Œä¿®å¤æ–¹å¼å°±æ˜¯ä¸è¦æŠŠ null å­˜è¿›å»ã€‚HashMap çš„ Key å’Œ Value å¯ä»¥å­˜å…¥ null</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">rightMethod</span><span class="o">(</span><span class="nc">FooService</span> <span class="n">fooService</span><span class="o">,</span> <span class="nc">Integer</span> <span class="n">i</span><span class="o">,</span> <span class="nc">String</span> <span class="n">s</span><span class="o">,</span> <span class="nc">String</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"result {} {} {} {}"</span><span class="o">,</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">orElse</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">,</span> <span class="s">"OK"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">s</span><span class="o">),</span> <span class="nc">Objects</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">s</span><span class="o">,</span> <span class="n">t</span><span class="o">),</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;().</span><span class="na">put</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
        <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">fooService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">FooService:</span><span class="o">:</span><span class="n">getBarService</span><span class="o">)</span>
                <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">barService</span> <span class="o">-&gt;</span> <span class="s">"OK"</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">barService</span><span class="o">.</span><span class="na">bar</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">result</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"OK"</span><span class="o">));</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="o">}</span>

<span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"right"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">right</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"test"</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">"1111"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">test</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="nc">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">rightMethod</span><span class="o">(</span><span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="k">new</span> <span class="nc">FooService</span><span class="o">(),</span>
                                         <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="mi">1</span><span class="o">,</span>
                                         <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="s">"OK"</span><span class="o">,</span>
                                         <span class="n">test</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">==</span> <span class="sc">'1'</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="s">"OK"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">orElse</span><span class="o">(</span><span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">()).</span><span class="na">size</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li><strong>ä½¿ç”¨åˆ¤ç©ºæ–¹å¼æˆ– Optional æ–¹å¼æ¥é¿å…å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œä¸ä¸€å®šæ˜¯è§£å†³é—®é¢˜çš„æœ€å¥½æ–¹å¼ï¼Œç©ºæŒ‡é’ˆæ²¡å‡ºç°å¯èƒ½éšè—äº†æ›´æ·±çš„ Bugã€‚</strong></li>
</ul>

<h4 id="å®ä½“ä¸­å±æ€§çš„null">å®ä½“ä¸­å±æ€§çš„null</h4>

<ul>
  <li>æœ‰ä¸€ä¸ª User çš„ POJOï¼ŒåŒæ—¶æ‰®æ¼” DTO å’Œæ•°æ®åº“ Entity è§’è‰²ï¼ŒåŒ…å«ç”¨æˆ· IDã€å§“åã€æ˜µç§°ã€å¹´é¾„ã€æ³¨å†Œæ—¶é—´ç­‰å±æ€§</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
  <span class="nd">@Id</span>
  <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="no">IDENTITY</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">String</span> <span class="n">nickname</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">Date</span> <span class="n">createDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>æœ‰ä¸€ä¸ª Post æ¥å£ç”¨äºæ›´æ–°ç”¨æˆ·æ•°æ®ï¼Œæ›´æ–°é€»è¾‘éå¸¸ç®€å•ï¼Œæ ¹æ®ç”¨æˆ·å§“åè‡ªåŠ¨è®¾ç½®ä¸€ä¸ªæ˜µ
ç§°ï¼Œæ˜µç§°çš„è§„åˆ™æ˜¯â€œç”¨æˆ·ç±»å‹ + å§“åâ€ï¼Œç„¶åç›´æ¥æŠŠå®¢æˆ·ç«¯åœ¨ RequestBody ä¸­ä½¿ç”¨
JSON ä¼ è¿‡æ¥çš„ User å¯¹è±¡é€šè¿‡ JPA æ›´æ–°åˆ°æ•°æ®åº“ä¸­ï¼Œæœ€åè¿”å›ä¿å­˜åˆ°æ•°æ®åº“çš„æ•°æ®ã€‚</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"wrong"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">User</span> <span class="nf">wrong</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">user</span><span class="o">.</span><span class="na">setNickname</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"guest%s"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()));</span>
  <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
<span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>é¦–å…ˆï¼Œåœ¨æ•°æ®åº“ä¸­åˆå§‹åŒ–ä¸€ä¸ªç”¨æˆ·ï¼Œage=36ã€name=zhuyeã€create_date=2020 å¹´ 1 æœˆ
4 æ—¥ã€nickname æ˜¯ NULLã€‚ç„¶åï¼Œä½¿ç”¨ cURL æµ‹è¯•ä¸€ä¸‹ç”¨æˆ·ä¿¡æ¯æ›´æ–°æ¥å£ Postï¼Œä¼ å…¥ä¸€ä¸ª id=1ã€name=null çš„JSON å­—ç¬¦ä¸²ï¼ŒæœŸæœ›æŠŠ ID ä¸º 1 çš„ç”¨æˆ·å§“åè®¾ç½®ä¸ºç©º</li>
  <li>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå­˜åœ¨å¦‚ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š
    <ul>
      <li>è°ƒç”¨æ–¹åªå¸Œæœ›é‡ç½®ç”¨æˆ·åï¼Œä½† age ä¹Ÿè¢«è®¾ç½®ä¸ºäº† nullï¼›</li>
      <li>nickname æ˜¯ç”¨æˆ·ç±»å‹åŠ å§“åï¼Œname é‡ç½®ä¸º null çš„è¯ï¼Œè®¿å®¢ç”¨æˆ·çš„æ˜µç§°åº”è¯¥æ˜¯
guestï¼Œè€Œä¸æ˜¯ guestnull</li>
      <li>ç”¨æˆ·çš„åˆ›å»ºæ—¶é—´åŸæ¥æ˜¯ 1 æœˆ 4 æ—¥ï¼Œæ›´æ–°äº†ç”¨æˆ·ä¿¡æ¯åå˜ä¸ºäº† 1 æœˆ 5 æ—¥</li>
    </ul>
  </li>
  <li><strong>å¯¹äº JSON åˆ° DTO çš„ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œnull çš„è¡¨è¾¾æ˜¯æœ‰æ­§ä¹‰çš„ï¼Œå®¢æˆ·ç«¯ä¸ä¼ æŸä¸ªå±æ€§ï¼Œæˆ–è€…ä¼  nullï¼Œè¿™ä¸ªå±æ€§åœ¨ DTO ä¸­éƒ½æ˜¯ nullã€‚</strong>å¯¹äºç”¨æˆ·ä¿¡æ¯æ›´æ–°æ“ä½œï¼Œä¸ä¼ æ„å‘³ç€å®¢æˆ·ç«¯ä¸éœ€è¦æ›´æ–°è¿™ä¸ªå±æ€§ï¼Œç»´æŒæ•°æ®åº“åŸå…ˆçš„å€¼ï¼›ä¼ äº†nullï¼Œæ„å‘³ç€å®¢æˆ·ç«¯å¸Œæœ›é‡ç½®è¿™ä¸ªå±æ€§ã€‚</li>
  <li><strong>POJO ä¸­çš„å­—æ®µæœ‰é»˜è®¤å€¼ã€‚å¦‚æœå®¢æˆ·ç«¯ä¸ä¼ å€¼ï¼Œå°±ä¼šèµ‹å€¼ä¸ºé»˜è®¤å€¼ï¼Œå¯¼è‡´åˆ›å»ºæ—¶é—´ä¹Ÿè¢«æ›´æ–°åˆ°äº†æ•°æ®åº“ä¸­ã€‚</strong></li>
  <li><strong>æ³¨æ„å­—ç¬¦ä¸²æ ¼å¼åŒ–æ—¶å¯èƒ½ä¼šæŠŠ null å€¼æ ¼å¼åŒ–ä¸º null å­—ç¬¦ä¸²ã€‚</strong></li>
  <li><strong>DTO å’Œ Entity å…±ç”¨äº†ä¸€ä¸ª POJOã€‚</strong></li>
  <li><strong>æ•°æ®åº“å­—æ®µå…è®¸ä¿å­˜ nullï¼Œä¼šè¿›ä¸€æ­¥å¢åŠ å‡ºé”™çš„å¯èƒ½æ€§å’Œå¤æ‚åº¦ã€‚</strong></li>
  <li>æŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å¯¹ DTO å’Œ Entity è¿›è¡Œæ‹†åˆ†</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDto</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Optional</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">age</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@Data</span>
<span class="nd">@Entity</span>
<span class="nd">@DynamicUpdate</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserEntity</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="no">IDENTITY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">nickname</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="nd">@Column</span><span class="o">(</span><span class="n">nullable</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">columnDefinition</span> <span class="o">=</span> <span class="s">"TIMESTAMP DEFAULT CURRENT_TIMESTAMP"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Date</span> <span class="n">createDate</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"right"</span><span class="o">)</span>
<span class="kd">public</span> <span class="nc">UserEntity</span> <span class="nf">right</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">UserDto</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">()</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"ç”¨æˆ·Idä¸èƒ½ä¸ºç©º"</span><span class="o">);</span>

  <span class="nc">UserEntity</span> <span class="n">userEntity</span> <span class="o">=</span> <span class="n">userEntityRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span>
    <span class="o">.</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"ç”¨æˆ·ä¸å­˜åœ¨"</span><span class="o">));</span>

  <span class="cm">/*å¯¹äºå§“åï¼Œæˆ‘ä»¬è®¤ä¸ºå®¢æˆ·ç«¯ä¼  null æ˜¯å¸Œæœ›æŠŠå§“åé‡ç½®ä¸ºç©ºï¼Œå…è®¸è¿™æ ·çš„æ“ä½œï¼Œä½¿ç”¨
Optional çš„ orElse æ–¹æ³•ä¸€é”®æŠŠç©ºè½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²å³å¯ã€‚*/</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userEntity</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">().</span><span class="na">orElse</span><span class="o">(</span><span class="s">""</span><span class="o">));</span>
  <span class="o">}</span>
  <span class="cm">/*å¯¹äºæ˜µç§°ï¼Œå› ä¸ºæ•°æ®åº“ä¸­å§“åä¸å¯èƒ½ä¸º nullï¼Œæ‰€ä»¥å¯ä»¥æ”¾å¿ƒåœ°æŠŠæ˜µç§°è®¾ç½®ä¸º guest åŠ ä¸Š
æ•°æ®åº“å–å‡ºæ¥çš„å§“åã€‚*/</span>
  <span class="n">userEntity</span><span class="o">.</span><span class="na">setNickname</span><span class="o">(</span><span class="s">"guest"</span> <span class="o">+</span> <span class="n">userEntity</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
  <span class="cm">/*å¯¹äºå¹´é¾„ï¼Œæˆ‘ä»¬è®¤ä¸ºå¦‚æœå®¢æˆ·ç«¯å¸Œæœ›æ›´æ–°å¹´é¾„å°±å¿…é¡»ä¼ ä¸€ä¸ªæœ‰æ•ˆçš„å¹´é¾„ï¼Œå¹´é¾„ä¸å­˜åœ¨é‡
ç½®æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ Optional çš„ orElseThrow æ–¹æ³•åœ¨å€¼ä¸ºç©ºçš„æ—¶å€™æŠ›å‡º
IllegalArgumentExceptionã€‚*/</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getAge</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">userEntity</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getAge</span><span class="o">().</span><span class="na">orElseThrow</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">IllegalArgumentException</span><span class="o">(</span><span class="s">"å¹´é¾„ä¸èƒ½ä¸ºç©º"</span><span class="o">)));</span>
  <span class="o">}</span>
  <span class="k">return</span> <span class="n">userEntityRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">userEntity</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="mysqlä¸­çš„nullå‘">MySQLä¸­çš„nullå‘</h4>

<ul>
  <li>é¦–å…ˆå®šä¹‰ä¸€ä¸ªåªæœ‰ id å’Œ score ä¸¤ä¸ªå­—æ®µçš„å®ä½“</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
  <span class="nd">@Id</span>
  <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="no">IDENTITY</span><span class="o">)</span>
  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>
  <span class="kd">private</span> <span class="nc">Long</span> <span class="n">score</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œå¾€å®ä½“åˆå§‹åŒ–ä¸€æ¡æ•°æ®ï¼Œå…¶ id æ˜¯è‡ªå¢åˆ—è‡ªåŠ¨è®¾ç½®çš„ 1ï¼Œscore æ˜¯NULL</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Autowired</span>
<span class="kd">private</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
<span class="nd">@PostConstruct</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
	<span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>
    <p>æµ‹è¯•ä¸‹é¢ä¸‰ä¸ªç”¨ä¾‹ï¼Œæ¥çœ‹çœ‹ç»“åˆæ•°æ®åº“ä¸­çš„ null å€¼å¯èƒ½ä¼šå‡ºç°çš„å‘ï¼š</p>

    <p>é€šè¿‡ sum å‡½æ•°ç»Ÿè®¡ä¸€ä¸ªåªæœ‰ NULL å€¼çš„åˆ—çš„æ€»å’Œï¼Œæ¯”å¦‚ SUM(score)</p>

    <p>select è®°å½•æ•°é‡ï¼Œcount ä½¿ç”¨ä¸€ä¸ªå…è®¸ NULL çš„å­—æ®µï¼Œæ¯”å¦‚ COUNT(score)</p>

    <p>ä½¿ç”¨ =NULL æ¡ä»¶æŸ¥è¯¢å­—æ®µå€¼ä¸º NULL çš„è®°å½•ï¼Œæ¯”å¦‚ score=null æ¡ä»¶</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Repository</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserRepository</span> <span class="kd">extends</span> <span class="nc">JpaRepository</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;</span> <span class="o">{</span>
  <span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span><span class="o">=</span><span class="kc">true</span><span class="o">,</span><span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT SUM(score) FROM `user`"</span><span class="o">)</span>
  <span class="nc">Long</span> <span class="nf">wrong1</span><span class="o">();</span>
  <span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT COUNT(score) FROM `user`"</span><span class="o">)</span>
  <span class="nc">Long</span> <span class="nf">wrong2</span><span class="o">();</span>
  <span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT * FROM `user` WHERE score=null"</span><span class="o">)</span>
  <span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">wrong3</span><span class="o">();</span>
<span class="o">}</span>
<span class="cm">/*
å¾—åˆ°çš„ç»“æœï¼Œåˆ†åˆ«æ˜¯ nullã€0 å’Œç©º List

è™½ç„¶è®°å½•çš„ score éƒ½æ˜¯ NULLï¼Œä½† sum çš„ç»“æœåº”è¯¥æ˜¯ 0 æ‰å¯¹ï¼›
è™½ç„¶è¿™æ¡è®°å½•çš„ score æ˜¯ NULLï¼Œä½†è®°å½•æ€»æ•°åº”è¯¥æ˜¯ 1 æ‰å¯¹ï¼›
ä½¿ç”¨ =NULL å¹¶æ²¡æœ‰æŸ¥è¯¢åˆ° id=1 çš„è®°å½•ï¼ŒæŸ¥è¯¢æ¡ä»¶å¤±æ•ˆã€‚
*/</span>
</code></pre></div></div>

<ul>
  <li><strong>MySQL ä¸­ sum å‡½æ•°æ²¡ç»Ÿè®¡åˆ°ä»»ä½•è®°å½•æ—¶ï¼Œä¼šè¿”å› null è€Œä¸æ˜¯ 0ï¼Œå¯ä»¥ä½¿ç”¨ IFNULL</strong>
<strong>å‡½æ•°æŠŠ null è½¬æ¢ä¸º 0</strong></li>
  <li><strong>MySQL ä¸­ count å­—æ®µä¸ç»Ÿè®¡ null å€¼ï¼ŒCOUNT(*) æ‰æ˜¯ç»Ÿè®¡æ‰€æœ‰è®°å½•æ•°é‡çš„æ­£ç¡®æ–¹å¼ã€‚</strong></li>
  <li><strong>MySQL ä¸­ =NULL å¹¶ä¸æ˜¯åˆ¤æ–­æ¡ä»¶è€Œæ˜¯èµ‹å€¼ï¼Œå¯¹ NULL è¿›è¡Œåˆ¤æ–­åªèƒ½ä½¿ç”¨ IS NULL æˆ–è€… IS NOT NULLã€‚</strong></li>
  <li><strong>åœ¨MySQLçš„ä½¿ç”¨ä¸­ï¼Œå¯¹äºç´¢å¼•åˆ—ï¼Œå»ºè®®éƒ½è®¾ç½®ä¸ºnot nullï¼Œå› ä¸ºå¦‚æœæœ‰nullçš„è¯ï¼ŒMySQLéœ€è¦å•ç‹¬ä¸“é—¨å¤„ç†nullå€¼ï¼Œä¼šé¢å¤–è€—è´¹æ€§èƒ½ã€‚</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT IFNULL(SUM(score),0) FROM `user`"</span><span class="o">)</span>
<span class="nc">Long</span> <span class="nf">right1</span><span class="o">();</span>
<span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT COUNT(*) FROM `user`"</span><span class="o">)</span>
<span class="nc">Long</span> <span class="nf">right2</span><span class="o">();</span>
<span class="nd">@Query</span><span class="o">(</span><span class="n">nativeQuery</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s">"SELECT * FROM `user` WHERE score IS NULL"</span><span class="o">)</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">right3</span><span class="o">();</span>

<span class="cm">/*
å¯ä»¥å¾—åˆ°ä¸‰ä¸ªæ­£ç¡®ç»“æœï¼Œåˆ†åˆ«ä¸º 0ã€1ã€[User(id=1, score=null)] ï¼š
*/</span>
</code></pre></div></div>

:ET