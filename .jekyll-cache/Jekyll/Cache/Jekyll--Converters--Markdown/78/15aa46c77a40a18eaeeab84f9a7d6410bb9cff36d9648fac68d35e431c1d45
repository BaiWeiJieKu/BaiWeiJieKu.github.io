I"à<ul id="markdown-toc">
  <li><a href="#åˆ›å»ºå·¥ä½œç°¿" id="markdown-toc-åˆ›å»ºå·¥ä½œç°¿">åˆ›å»ºå·¥ä½œç°¿</a>    <ul>
      <li><a href="#å¤šsheet" id="markdown-toc-å¤šsheet">å¤šsheet</a></li>
      <li><a href="#æ·»åŠ è¡Œåˆ—" id="markdown-toc-æ·»åŠ è¡Œåˆ—">æ·»åŠ è¡Œåˆ—</a></li>
      <li><a href="#æ—¶é—´æ ¼å¼åŒ–" id="markdown-toc-æ—¶é—´æ ¼å¼åŒ–">æ—¶é—´æ ¼å¼åŒ–</a></li>
      <li><a href="#ä¸åŒç±»å‹å€¼" id="markdown-toc-ä¸åŒç±»å‹å€¼">ä¸åŒç±»å‹å€¼</a></li>
      <li><a href="#éå†å†…å®¹" id="markdown-toc-éå†å†…å®¹">éå†å†…å®¹</a></li>
      <li><a href="#æŠ½å–æ•°æ®" id="markdown-toc-æŠ½å–æ•°æ®">æŠ½å–æ•°æ®</a></li>
      <li><a href="#å•å…ƒæ ¼å¯¹é½" id="markdown-toc-å•å…ƒæ ¼å¯¹é½">å•å…ƒæ ¼å¯¹é½</a></li>
      <li><a href="#è¾¹æ¡†æ ·å¼" id="markdown-toc-è¾¹æ¡†æ ·å¼">è¾¹æ¡†æ ·å¼</a></li>
      <li><a href="#å¡«å……è‰²" id="markdown-toc-å¡«å……è‰²">å¡«å……è‰²</a></li>
      <li><a href="#å•å…ƒæ ¼åˆå¹¶" id="markdown-toc-å•å…ƒæ ¼åˆå¹¶">å•å…ƒæ ¼åˆå¹¶</a></li>
      <li><a href="#å­—ä½“å¤„ç†" id="markdown-toc-å­—ä½“å¤„ç†">å­—ä½“å¤„ç†</a></li>
      <li><a href="#è¯»å–å¹¶é‡å†™" id="markdown-toc-è¯»å–å¹¶é‡å†™">è¯»å–å¹¶é‡å†™</a></li>
      <li><a href="#æ¢è¡Œ" id="markdown-toc-æ¢è¡Œ">æ¢è¡Œ</a></li>
      <li><a href="#æ•°æ®æ ¼å¼" id="markdown-toc-æ•°æ®æ ¼å¼">æ•°æ®æ ¼å¼</a></li>
    </ul>
  </li>
  <li><a href="#struts2å¯¼å‡º" id="markdown-toc-struts2å¯¼å‡º">struts2å¯¼å‡º</a>    <ul>
      <li><a href="#æ™®é€šæ–¹æ³•" id="markdown-toc-æ™®é€šæ–¹æ³•">æ™®é€šæ–¹æ³•</a></li>
      <li><a href="#æ¨¡æ¿æ–¹æ³•" id="markdown-toc-æ¨¡æ¿æ–¹æ³•">æ¨¡æ¿æ–¹æ³•</a></li>
      <li><a href="#å·¥å…·ç±»" id="markdown-toc-å·¥å…·ç±»">å·¥å…·ç±»</a></li>
    </ul>
  </li>
  <li><a href="#struts2å¯¼å…¥" id="markdown-toc-struts2å¯¼å…¥">struts2å¯¼å…¥</a></li>
  <li><a href="#servletå¯¼å…¥" id="markdown-toc-servletå¯¼å…¥">servletå¯¼å…¥</a></li>
  <li><a href="#é¡¹ç›®åœ°å€" id="markdown-toc-é¡¹ç›®åœ°å€">é¡¹ç›®åœ°å€</a></li>
</ul>
<h3 id="åˆ›å»ºå·¥ä½œç°¿">åˆ›å»ºå·¥ä½œç°¿</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">poi-3.9-20121203.jar</code></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo1</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"e:\\æ–°å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span><span class="c1">//è¾“å‡º</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span><span class="c1">//å…³é—­</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="å¤šsheet">å¤šsheet</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo2</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">// å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">// åˆ›å»ºä¸€ä¸ªsheeté¡µ</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬äºŒä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">// åˆ›å»ºç¬¬äºŒä¸ªsheeté¡µ</span>
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å¤šä¸ªsheeté¡µçš„å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ·»åŠ è¡Œåˆ—">æ·»åŠ è¡Œåˆ—</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo3</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">// å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">// åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ï¼Œç¬¬ä¸€åˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>  <span class="c1">// ç»™å•å…ƒæ ¼è®¾ç½®å€¼ä¸º1</span>
		
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="mf">1.2</span><span class="o">);</span>   <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ ç¬¬äºŒåˆ—å€¼æ˜¯1.2</span>
		
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"å­—ç¬¦ä¸²"</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ ç¬¬ä¸‰åˆ—å€¼æ˜¯å­—ç¬¦ä¸²</span>
		
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ ç¬¬å››åˆ—å€¼æ˜¯å¸ƒå°”ç±»å‹</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\æ–°å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ—¶é—´æ ¼å¼åŒ–">æ—¶é—´æ ¼å¼åŒ–</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo4</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€è¡Œ</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ ç¬¬ä¸€åˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>  <span class="c1">// ç»™å•å…ƒæ ¼è®¾ç½®ä¸€ä¸ªæ—¶é—´å€¼</span>
		
		<span class="nc">CreationHelper</span> <span class="n">createHelper</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">getCreationHelper</span><span class="o">();</span><span class="c1">//æ—¶é—´æ ¼å¼åŒ–å·¥å…·ç±»</span>
		<span class="nc">CellStyle</span> <span class="n">cellStyle</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span> <span class="c1">//å•å…ƒæ ¼æ ·å¼</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setDataFormat</span><span class="o">(</span><span class="n">createHelper</span><span class="o">.</span><span class="na">createDataFormat</span><span class="o">().</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"yyy-mm-dd hh:mm:ss"</span><span class="o">));</span>
		<span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">//ç¬¬äºŒåˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle</span><span class="o">);</span>
		
		<span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>  <span class="c1">// ç¬¬ä¸‰åˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="nc">Calendar</span><span class="o">.</span><span class="na">getInstance</span><span class="o">());</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\æ–°å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="ä¸åŒç±»å‹å€¼">ä¸åŒç±»å‹å€¼</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo5</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€è¡Œ</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼ ç¬¬ä¸€åˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>  <span class="c1">// ç»™å•å…ƒæ ¼è®¾ç½®ä¸€ä¸ªæ—¶é—´å€¼</span>
		
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"ä¸€ä¸ªå­—ç¬¦ä¸²"</span><span class="o">);</span>
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="nc">HSSFCell</span><span class="o">.</span><span class="na">CELL_TYPE_NUMERIC</span><span class="o">);</span>
		<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\æ–°å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="éå†å†…å®¹">éå†å†…å®¹</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFRow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFSheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.poifs.filesystem.POIFSFileSystem</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo6</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">InputStream</span> <span class="n">is</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="s">"c:\\äºŒè´§åå•.xls"</span><span class="o">);</span>
		<span class="nc">POIFSFileSystem</span> <span class="n">fs</span><span class="o">=</span><span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
		<span class="nc">HSSFWorkbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
		<span class="nc">HSSFSheet</span> <span class="n">hssfSheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//è·å–ç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="k">if</span><span class="o">(</span><span class="n">hssfSheet</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
			<span class="k">return</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="c1">// éå†è¡ŒRow</span>
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowNum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">rowNum</span><span class="o">&lt;=</span><span class="n">hssfSheet</span><span class="o">.</span><span class="na">getLastRowNum</span><span class="o">();</span><span class="n">rowNum</span><span class="o">++){</span>
			<span class="nc">HSSFRow</span> <span class="n">hssfRow</span><span class="o">=</span><span class="n">hssfSheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">rowNum</span><span class="o">);</span>
			<span class="k">if</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
				<span class="k">continue</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="c1">// éå†åˆ—Cell</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">cellNum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">cellNum</span><span class="o">&lt;=</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getLastCellNum</span><span class="o">();</span><span class="n">cellNum</span><span class="o">++){</span>
				<span class="nc">HSSFCell</span> <span class="n">hssfCell</span><span class="o">=</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="n">cellNum</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
					<span class="k">continue</span><span class="o">;</span>
				<span class="o">}</span>
				<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">" "</span><span class="o">+</span><span class="n">getValue</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">));</span>
			<span class="o">}</span>
			<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>
	
	<span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getValue</span><span class="o">(</span><span class="nc">HSSFCell</span> <span class="n">hssfCell</span><span class="o">){</span>
		<span class="c1">//å¦‚æœæ˜¯å¸ƒå°”ç±»å‹æˆ–æ•°å­—ç±»å‹ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>
		<span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getCellType</span><span class="o">()==</span><span class="nc">HSSFCell</span><span class="o">.</span><span class="na">CELL_TYPE_BOOLEAN</span><span class="o">){</span>
			<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getBooleanCellValue</span><span class="o">());</span>
		<span class="o">}</span><span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getCellType</span><span class="o">()==</span><span class="nc">HSSFCell</span><span class="o">.</span><span class="na">CELL_TYPE_NUMERIC</span><span class="o">){</span>
			<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getNumericCellValue</span><span class="o">());</span>
		<span class="o">}</span><span class="k">else</span><span class="o">{</span>
			<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getStringCellValue</span><span class="o">());</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æŠ½å–æ•°æ®">æŠ½å–æ•°æ®</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.extractor.ExcelExtractor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFRow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFSheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.poifs.filesystem.POIFSFileSystem</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo7</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">InputStream</span> <span class="n">is</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="s">"c:\\äºŒè´§åå•.xls"</span><span class="o">);</span>
		<span class="nc">POIFSFileSystem</span> <span class="n">fs</span><span class="o">=</span><span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
		<span class="nc">HSSFWorkbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
		<span class="c1">//æŠ½å–æ‰€æœ‰æ•°æ®</span>
		<span class="nc">ExcelExtractor</span> <span class="n">excelExtractor</span><span class="o">=</span><span class="k">new</span> <span class="nc">ExcelExtractor</span><span class="o">(</span><span class="n">wb</span><span class="o">);</span>
		<span class="n">excelExtractor</span><span class="o">.</span><span class="na">setIncludeSheetNames</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span><span class="c1">// ä¸éœ€è¦sheeté¡µçš„åå­—</span>
		<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">excelExtractor</span><span class="o">.</span><span class="na">getText</span><span class="o">());</span>
	<span class="o">}</span>
	

<span class="o">}</span>

</code></pre></div></div>

<h4 id="å•å…ƒæ ¼å¯¹é½">å•å…ƒæ ¼å¯¹é½</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFRichTextString</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
å•å…ƒæ ¼å¯¹é½æ–¹å¼
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo8</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		<span class="n">row</span><span class="o">.</span><span class="na">setHeightInPoints</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span>
		
		<span class="n">createCell</span><span class="o">(</span><span class="n">wb</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mi">0</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">ALIGN_CENTER</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">VERTICAL_BOTTOM</span><span class="o">);</span>
		<span class="n">createCell</span><span class="o">(</span><span class="n">wb</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mi">1</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">ALIGN_FILL</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">VERTICAL_CENTER</span><span class="o">);</span>
		<span class="n">createCell</span><span class="o">(</span><span class="n">wb</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mi">2</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">ALIGN_LEFT</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">VERTICAL_TOP</span><span class="o">);</span>
		<span class="n">createCell</span><span class="o">(</span><span class="n">wb</span><span class="o">,</span> <span class="n">row</span><span class="o">,</span> <span class="o">(</span><span class="kt">short</span><span class="o">)</span><span class="mi">3</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">ALIGN_RIGHT</span><span class="o">,</span> <span class="nc">HSSFCellStyle</span><span class="o">.</span><span class="na">VERTICAL_TOP</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	
	<span class="cm">/**
	 * åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼å¹¶ä¸ºå…¶è®¾å®šæŒ‡å®šçš„å¯¹é½æ–¹å¼
	 * @param wb å·¥ä½œç°¿
	 * @param row è¡Œ
	 * @param column  åˆ—
	 * @param halign  æ°´å¹³æ–¹å¼å¯¹é½æ–¹å¼
	 * @param valign  å‚ç›´æ–¹å‘å¯¹é½æ–¹å¼
	 */</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">createCell</span><span class="o">(</span><span class="nc">Workbook</span> <span class="n">wb</span><span class="o">,</span><span class="nc">Row</span> <span class="n">row</span><span class="o">,</span><span class="kt">short</span> <span class="n">column</span><span class="o">,</span><span class="kt">short</span> <span class="n">halign</span><span class="o">,</span><span class="kt">short</span> <span class="n">valign</span><span class="o">){</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">column</span><span class="o">);</span>  <span class="c1">// åˆ›å»ºå•å…ƒæ ¼</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="k">new</span> <span class="nc">HSSFRichTextString</span><span class="o">(</span><span class="s">"Align It"</span><span class="o">));</span>  <span class="c1">// è®¾ç½®å€¼</span>
		<span class="nc">CellStyle</span> <span class="n">cellStyle</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span> <span class="c1">// åˆ›å»ºå•å…ƒæ ¼æ ·å¼</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setAlignment</span><span class="o">(</span><span class="n">halign</span><span class="o">);</span>  <span class="c1">// è®¾ç½®å•å…ƒæ ¼æ°´å¹³æ–¹å‘å¯¹å…¶æ–¹å¼</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setVerticalAlignment</span><span class="o">(</span><span class="n">valign</span><span class="o">);</span> <span class="c1">// è®¾ç½®å•å…ƒæ ¼å‚ç›´æ–¹å‘å¯¹é½æ–¹å¼</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle</span><span class="o">);</span> <span class="c1">// è®¾ç½®å•å…ƒæ ¼æ ·å¼</span>
	<span class="o">}</span>
	

<span class="o">}</span>

</code></pre></div></div>

<h4 id="è¾¹æ¡†æ ·å¼">è¾¹æ¡†æ ·å¼</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.IndexedColors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
è¾¹æ¡†æ ·å¼
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo9</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// åˆ›å»ºä¸€ä¸ªå•å…ƒæ ¼</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mi">4</span><span class="o">);</span>
		
		<span class="nc">CellStyle</span> <span class="n">cellStyle</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span> 
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setBorderBottom</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">BORDER_THIN</span><span class="o">);</span> <span class="c1">//åº•éƒ¨è¾¹æ¡†</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setBottomBorderColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">BLACK</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span> <span class="c1">// åº•éƒ¨é¢œè‰²</span>
		
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setBorderLeft</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">BORDER_THIN</span><span class="o">);</span>  <span class="c1">// å·¦è¾¹è¾¹æ¡†</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setLeftBorderColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">GREEN</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span> <span class="c1">// å·¦è¾¹æ¡†é¢œè‰²</span>
		
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setBorderRight</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">BORDER_THIN</span><span class="o">);</span> <span class="c1">// å³è¾¹æ¡†</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setRightBorderColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">BLUE</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span>  <span class="c1">// å³è¾¹æ¡†é¢œè‰²</span>
		
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setBorderTop</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">BORDER_MEDIUM_DASHED</span><span class="o">);</span> <span class="c1">// ä¸Šè¾¹æ¡†</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setTopBorderColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">BLACK</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span>  <span class="c1">// ä¸Šè¾¹æ¡†é¢œè‰²</span>
		
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle</span><span class="o">);</span>
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="å¡«å……è‰²">å¡«å……è‰²</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.IndexedColors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
å¡«å……è‰²
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo10</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span><span class="c1">//åˆ›å»ºä¸€åˆ—</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"XX"</span><span class="o">);</span>
		<span class="nc">CellStyle</span> <span class="n">cellStyle</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span><span class="c1">//åˆ›å»ºä¸€ä¸ªåˆ—æ ·å¼</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setFillBackgroundColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">AQUA</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span> <span class="c1">// èƒŒæ™¯è‰²</span>
		<span class="n">cellStyle</span><span class="o">.</span><span class="na">setFillPattern</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">BIG_SPOTS</span><span class="o">);</span>  
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle</span><span class="o">);</span>
		
		
		<span class="nc">Cell</span> <span class="n">cell2</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span><span class="c1">//åˆ›å»ºç¬¬äºŒåˆ—</span>
		<span class="n">cell2</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"YYY"</span><span class="o">);</span>
		<span class="nc">CellStyle</span> <span class="n">cellStyle2</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
		<span class="n">cellStyle2</span><span class="o">.</span><span class="na">setFillForegroundColor</span><span class="o">(</span><span class="nc">IndexedColors</span><span class="o">.</span><span class="na">RED</span><span class="o">.</span><span class="na">getIndex</span><span class="o">());</span> <span class="c1">// å‰æ™¯è‰²</span>
		<span class="n">cellStyle2</span><span class="o">.</span><span class="na">setFillPattern</span><span class="o">(</span><span class="nc">CellStyle</span><span class="o">.</span><span class="na">SOLID_FOREGROUND</span><span class="o">);</span>  
		<span class="n">cell2</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cellStyle2</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="å•å…ƒæ ¼åˆå¹¶">å•å…ƒæ ¼åˆå¹¶</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.IndexedColors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.util.CellRangeAddress</span><span class="o">;</span>
<span class="cm">/*
å•å…ƒæ ¼åˆå¹¶
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo11</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"å•å…ƒæ ¼åˆå¹¶æµ‹è¯•"</span><span class="o">);</span>
		
		<span class="n">sheet</span><span class="o">.</span><span class="na">addMergedRegion</span><span class="o">(</span><span class="k">new</span> <span class="nc">CellRangeAddress</span><span class="o">(</span>
				<span class="mi">1</span><span class="o">,</span> <span class="c1">// èµ·å§‹è¡Œ</span>
				<span class="mi">2</span><span class="o">,</span> <span class="c1">// ç»“æŸè¡Œ</span>
				<span class="mi">1</span><span class="o">,</span> <span class="c1">// èµ·å§‹åˆ—</span>
				<span class="mi">2</span>  <span class="c1">// ç»“æŸåˆ—</span>
		<span class="o">));</span>
		
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="å­—ä½“å¤„ç†">å­—ä½“å¤„ç†</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Font</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
å­—ä½“å¤„ç†
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo12</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		
		<span class="c1">// åˆ›å»ºä¸€ä¸ªå­—ä½“å¤„ç†ç±»</span>
		<span class="nc">Font</span> <span class="n">font</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createFont</span><span class="o">();</span>
		<span class="n">font</span><span class="o">.</span><span class="na">setFontHeightInPoints</span><span class="o">((</span><span class="kt">short</span><span class="o">)</span><span class="mi">24</span><span class="o">);</span><span class="c1">//é«˜åº¦</span>
		<span class="n">font</span><span class="o">.</span><span class="na">setFontName</span><span class="o">(</span><span class="s">"Courier New"</span><span class="o">);</span>
		<span class="n">font</span><span class="o">.</span><span class="na">setItalic</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span><span class="c1">//æ–œä½“</span>
		<span class="n">font</span><span class="o">.</span><span class="na">setStrikeout</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		
		<span class="nc">CellStyle</span> <span class="n">style</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
		<span class="n">style</span><span class="o">.</span><span class="na">setFont</span><span class="o">(</span><span class="n">font</span><span class="o">);</span>
		
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">((</span><span class="kt">short</span><span class="o">)</span><span class="mi">1</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"This is test of fonts"</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="è¯»å–å¹¶é‡å†™">è¯»å–å¹¶é‡å†™</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.poifs.filesystem.POIFSFileSystem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
è¯»å–å’Œé‡å†™å·¥ä½œç°¿
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo13</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//è¯»å–æ–‡ä»¶</span>
		<span class="nc">InputStream</span> <span class="n">inp</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="nc">POIFSFileSystem</span> <span class="n">fs</span><span class="o">=</span><span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="n">inp</span><span class="o">);</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>  <span class="c1">//è·å–ç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// è·å–ç¬¬ä¸€è¡Œ</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">//è·å–å•å…ƒæ ¼</span>
        <span class="c1">//å¦‚æœç¬¬ä¸€åˆ—ä¸ºç©ºï¼Œåˆ™åˆ›å»ºç¬¬å››åˆ—ï¼Œå¹¶ä¸”èµ‹å€¼ä¸ºâ€˜æµ‹è¯•å•å…ƒæ ¼â€™</span>
		<span class="k">if</span><span class="o">(</span><span class="n">cell</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
			<span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellType</span><span class="o">(</span><span class="nc">Cell</span><span class="o">.</span><span class="na">CELL_TYPE_STRING</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"æµ‹è¯•å•å…ƒæ ¼"</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ¢è¡Œ">æ¢è¡Œ</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CreationHelper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.IndexedColors</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.util.CellRangeAddress</span><span class="o">;</span>
<span class="cm">/*
æ¢è¡Œ
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo14</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span> <span class="c1">//åˆ›å»ºä¸€ä¸ªè¡Œ</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">"æˆ‘è¦æ¢è¡Œ \n æˆåŠŸäº†å—ï¼Ÿ"</span><span class="o">);</span>
		
		<span class="nc">CellStyle</span> <span class="n">cs</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
		<span class="c1">//è®¾ç½®å¯ä»¥æ¢è¡Œ</span>
		<span class="n">cs</span><span class="o">.</span><span class="na">setWrapText</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">cs</span><span class="o">);</span>
		
		<span class="c1">// è°ƒæ•´è¡Œé«˜åº¦</span>
		<span class="n">row</span><span class="o">.</span><span class="na">setHeightInPoints</span><span class="o">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sheet</span><span class="o">.</span><span class="na">getDefaultRowHeightInPoints</span><span class="o">());</span>
		<span class="c1">// è°ƒæ•´å•å…ƒæ ¼å®½åº¦</span>
		<span class="n">sheet</span><span class="o">.</span><span class="na">autoSizeColumn</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ•°æ®æ ¼å¼">æ•°æ®æ ¼å¼</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.poi</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Cell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.CellStyle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.DataFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>
<span class="cm">/*
æ•°æ®æ ¼å¼
*/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Demo15</span> <span class="o">{</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span> <span class="c1">//å®šä¹‰ä¸€ä¸ªæ–°çš„å·¥ä½œç°¿</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">"ç¬¬ä¸€ä¸ªsheeté¡µ"</span><span class="o">);</span>  <span class="c1">//åˆ›å»ºç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="nc">CellStyle</span> <span class="n">style</span><span class="o">;</span>
		<span class="c1">//åˆ›å»ºæ•°æ®æ ¼å¼</span>
		<span class="nc">DataFormat</span> <span class="n">format</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createDataFormat</span><span class="o">();</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">;</span>
		<span class="nc">Cell</span> <span class="n">cell</span><span class="o">;</span>
		<span class="kt">short</span> <span class="n">rowNum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
		<span class="kt">short</span> <span class="n">colNum</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
		<span class="c1">//åˆ›å»ºä¸€è¡Œ</span>
		<span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rowNum</span><span class="o">++);</span>
		<span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">colNum</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mf">111111.25</span><span class="o">);</span>
		
		<span class="n">style</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
		<span class="n">style</span><span class="o">.</span><span class="na">setDataFormat</span><span class="o">(</span><span class="n">format</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"0.0"</span><span class="o">));</span> <span class="c1">// è®¾ç½®æ•°æ®æ ¼å¼</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>
		
		<span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rowNum</span><span class="o">++);</span>
		<span class="n">cell</span><span class="o">=</span><span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">colNum</span><span class="o">);</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mf">1111111.25</span><span class="o">);</span>
		<span class="n">style</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createCellStyle</span><span class="o">();</span>
		<span class="n">style</span><span class="o">.</span><span class="na">setDataFormat</span><span class="o">(</span><span class="n">format</span><span class="o">.</span><span class="na">getFormat</span><span class="o">(</span><span class="s">"#,##0.000"</span><span class="o">));</span>
		<span class="n">cell</span><span class="o">.</span><span class="na">setCellStyle</span><span class="o">(</span><span class="n">style</span><span class="o">);</span>
		
		<span class="nc">FileOutputStream</span> <span class="n">fileOut</span><span class="o">=</span><span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"c:\\å·¥ä½œç°¿.xls"</span><span class="o">);</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">fileOut</span><span class="o">);</span>
		<span class="n">fileOut</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="struts2å¯¼å‡º">struts2å¯¼å‡º</h3>

<h4 id="æ™®é€šæ–¹æ³•">æ™®é€šæ–¹æ³•</h4>

<ul>
  <li>Actionç±»</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="kd">public</span> <span class="nc">String</span> <span class="nf">export</span><span class="o">()</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Connection</span> <span class="n">con</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">con</span><span class="o">=</span><span class="n">dbUtil</span><span class="o">.</span><span class="na">getCon</span><span class="o">();</span>
			<span class="c1">//åˆ›å»ºä¸€ä¸ªå·¥ä½œç°¿</span>
			<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">();</span>
			<span class="c1">//è®¾ç½®å·¥ä½œç°¿å¤´éƒ¨</span>
			<span class="nc">String</span> <span class="n">headers</span><span class="o">[]={</span><span class="s">"ç¼–å·"</span><span class="o">,</span><span class="s">"å§“å"</span><span class="o">,</span><span class="s">"è”ç³»ç”µè¯"</span><span class="o">,</span><span class="s">"Email"</span><span class="o">,</span><span class="s">"QQ"</span><span class="o">};</span>
			<span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">=</span><span class="n">userDao</span><span class="o">.</span><span class="na">userList</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
			<span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">fillExcelData</span><span class="o">(</span><span class="n">rs</span><span class="o">,</span> <span class="n">wb</span><span class="o">,</span> <span class="n">headers</span><span class="o">);</span>
			<span class="nc">ResponseUtil</span><span class="o">.</span><span class="na">export</span><span class="o">(</span><span class="nc">ServletActionContext</span><span class="o">.</span><span class="na">getResponse</span><span class="o">(),</span> <span class="n">wb</span><span class="o">,</span> <span class="s">"å¯¼å‡ºexcel.xls"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// TODO Auto-generated catch block</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="n">dbUtil</span><span class="o">.</span><span class="na">closeCon</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// TODO Auto-generated catch block</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>

<h4 id="æ¨¡æ¿æ–¹æ³•">æ¨¡æ¿æ–¹æ³•</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">export2</span><span class="o">()</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="nc">Connection</span> <span class="n">con</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">con</span><span class="o">=</span><span class="n">dbUtil</span><span class="o">.</span><span class="na">getCon</span><span class="o">();</span>
			<span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">=</span><span class="n">userDao</span><span class="o">.</span><span class="na">userList</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
			<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">fillExcelDataWithTemplate</span><span class="o">(</span><span class="n">userDao</span><span class="o">.</span><span class="na">userList</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="kc">null</span><span class="o">),</span> <span class="s">"userExporTemplate.xls"</span><span class="o">);</span>
			<span class="nc">ResponseUtil</span><span class="o">.</span><span class="na">export</span><span class="o">(</span><span class="nc">ServletActionContext</span><span class="o">.</span><span class="na">getResponse</span><span class="o">(),</span> <span class="n">wb</span><span class="o">,</span> <span class="s">"æ¨¡æ¿å¯¼å‡ºexcel.xls"</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// TODO Auto-generated catch block</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
			<span class="k">try</span> <span class="o">{</span>
				<span class="n">dbUtil</span><span class="o">.</span><span class="na">closeCon</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
			<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
				<span class="c1">// TODO Auto-generated catch block</span>
				<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>

<h4 id="å·¥å…·ç±»">å·¥å…·ç±»</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.util</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.sql.ResultSet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFCell</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.poifs.filesystem.POIFSFileSystem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Row</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Sheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExcelUtil</span> <span class="o">{</span>
	<span class="cm">/**
	 * æŠŠå†…å®¹å¡«å……åˆ°å·¥ä½œç°¿
	 * @param rs æ•°æ®é›†
	 * @param wb å·¥ä½œç°¿
	 * @param headers å·¥ä½œç°¿å¤´éƒ¨
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">fillExcelData</span><span class="o">(</span><span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">,</span><span class="nc">Workbook</span> <span class="n">wb</span><span class="o">,</span><span class="nc">String</span><span class="o">[]</span> <span class="n">headers</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="kt">int</span> <span class="n">rowIndex</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">();</span><span class="c1">//åˆ›å»ºä¸€ä¸ªsheet</span>
		<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">++);</span><span class="c1">//ä»ç¬¬ä¸€è¡Œå¼€å§‹</span>
		<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
			<span class="c1">//æŠŠå¤´éƒ¨å†™å…¥å·¥ä½œç°¿</span>
			<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">headers</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
		<span class="o">}</span>
		<span class="c1">//éå†æ•°æ®é›†ï¼Œå†™å…¥å·¥ä½œç°¿</span>
		<span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
			<span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">++);</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">headers</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
				<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
	<span class="cm">/**
	 * ç”¨æµçš„æ–¹å¼è¯»å–æ¨¡æ¿
	 * @param rs æ•°æ®é›†
	 * @param templateFileName æ¨¡æ¿åç§°
	 * @return
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">Workbook</span> <span class="nf">fillExcelDataWithTemplate</span><span class="o">(</span><span class="nc">ResultSet</span> <span class="n">rs</span><span class="o">,</span><span class="nc">String</span> <span class="n">templateFileName</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//è¯»å–åŒ…ä¸‹çš„Excelæ¨¡æ¿</span>
		<span class="nc">InputStream</span> <span class="n">inp</span><span class="o">=</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="s">"/com/java1234/template/"</span><span class="o">+</span><span class="n">templateFileName</span><span class="o">);</span>
		<span class="nc">POIFSFileSystem</span> <span class="n">fs</span><span class="o">=</span><span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="n">inp</span><span class="o">);</span>
		<span class="nc">Workbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
		<span class="nc">Sheet</span> <span class="n">sheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="c1">//è·å–åˆ—æ•°</span>
		<span class="kt">int</span> <span class="n">cellNums</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getLastCellNum</span><span class="o">();</span>
		<span class="kt">int</span> <span class="n">rowIndex</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span>
		<span class="k">while</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">()){</span>
			<span class="nc">Row</span> <span class="n">row</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rowIndex</span><span class="o">++);</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">cellNums</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
				<span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">wb</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="cm">/**
	 * excelåˆ—æ•°æ®ç±»å‹è½¬æ¢ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²çƒˆæ€§
	 * @param hssfCell åˆ—
	 * @return
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">formatCell</span><span class="o">(</span><span class="nc">HSSFCell</span> <span class="n">hssfCell</span><span class="o">){</span>
		<span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
			<span class="k">return</span> <span class="s">""</span><span class="o">;</span>
		<span class="o">}</span><span class="k">else</span><span class="o">{</span>
			<span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getCellType</span><span class="o">()==</span><span class="nc">HSSFCell</span><span class="o">.</span><span class="na">CELL_TYPE_BOOLEAN</span><span class="o">){</span>
				<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getBooleanCellValue</span><span class="o">());</span>
			<span class="o">}</span><span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getCellType</span><span class="o">()==</span><span class="nc">HSSFCell</span><span class="o">.</span><span class="na">CELL_TYPE_NUMERIC</span><span class="o">){</span>
				<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getNumericCellValue</span><span class="o">());</span>
			<span class="o">}</span><span class="k">else</span><span class="o">{</span>
				<span class="k">return</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">hssfCell</span><span class="o">.</span><span class="na">getStringCellValue</span><span class="o">());</span>
			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.java1234.util</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.OutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.PrintWriter</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.poi.ss.usermodel.Workbook</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResponseUtil</span> <span class="o">{</span>
	<span class="cm">/**
	 * å‘å‰å°æ‰“å°æ•°æ®ï¼Œå¦‚jsonæ•°æ®
	 * @param response
	 * @param o
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">write</span><span class="o">(</span><span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Object</span> <span class="n">o</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
		<span class="nc">PrintWriter</span> <span class="n">out</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">();</span>
		<span class="n">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
		<span class="n">out</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
		<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>
	<span class="cm">/**
	 * ä»¥æµçš„å½¢å¼å¯¼å‡ºExcel
	 * @param response HttpServletResponse
	 * @param wb å·¥ä½œç°¿
	 * @param fileName æ–‡ä»¶å
	 * @throws Exception
	 */</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span><span class="nc">Workbook</span> <span class="n">wb</span><span class="o">,</span><span class="nc">String</span> <span class="n">fileName</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Content-Disposition"</span><span class="o">,</span> <span class="s">"attachment;filename="</span><span class="o">+</span><span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">fileName</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">),</span><span class="s">"iso8859-1"</span><span class="o">));</span>
		<span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"application/ynd.ms-excel;charset=UTF-8"</span><span class="o">);</span>
		<span class="nc">OutputStream</span> <span class="n">out</span><span class="o">=</span><span class="n">response</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
		<span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
		<span class="n">out</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
		<span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<h3 id="struts2å¯¼å…¥">struts2å¯¼å…¥</h3>

<ul>
  <li>ä½¿ç”¨æ¨¡æ¿å¯¼å…¥æ•°æ®åˆ°æ•°æ®åº“</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nc">String</span> <span class="nf">upload</span><span class="o">()</span><span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
		<span class="c1">//è·å–å‰å°ä¼ å…¥çš„Excelå·¥ä½œç°¿</span>
		<span class="nc">POIFSFileSystem</span> <span class="n">fs</span><span class="o">=</span><span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">userUploadFile</span><span class="o">));</span>
		<span class="nc">HSSFWorkbook</span> <span class="n">wb</span><span class="o">=</span><span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
		<span class="nc">HSSFSheet</span> <span class="n">hssfSheet</span><span class="o">=</span><span class="n">wb</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>  <span class="c1">// è·å–ç¬¬ä¸€ä¸ªsheeté¡µ</span>
		<span class="k">if</span><span class="o">(</span><span class="n">hssfSheet</span><span class="o">!=</span><span class="kc">null</span><span class="o">){</span>
			<span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rowNum</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span><span class="n">rowNum</span><span class="o">&lt;=</span><span class="n">hssfSheet</span><span class="o">.</span><span class="na">getLastRowNum</span><span class="o">();</span><span class="n">rowNum</span><span class="o">++){</span>
				<span class="nc">HSSFRow</span> <span class="n">hssfRow</span><span class="o">=</span><span class="n">hssfSheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">rowNum</span><span class="o">);</span>
				<span class="k">if</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">==</span><span class="kc">null</span><span class="o">){</span>
					<span class="k">continue</span><span class="o">;</span>
				<span class="o">}</span>
				<span class="c1">//è·å–æ¯ä¸€åˆ—å€¼å°è£…å¯¹è±¡</span>
				<span class="nc">User</span> <span class="n">user</span><span class="o">=</span><span class="k">new</span> <span class="nc">User</span><span class="o">();</span>
				<span class="n">user</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">)));</span>
				<span class="n">user</span><span class="o">.</span><span class="na">setPhone</span><span class="o">(</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">1</span><span class="o">)));</span>
				<span class="n">user</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">2</span><span class="o">)));</span>
				<span class="n">user</span><span class="o">.</span><span class="na">setQq</span><span class="o">(</span><span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">3</span><span class="o">)));</span>
				<span class="nc">Connection</span> <span class="n">con</span><span class="o">=</span><span class="kc">null</span><span class="o">;</span>
				<span class="k">try</span><span class="o">{</span>
					<span class="n">con</span><span class="o">=</span><span class="n">dbUtil</span><span class="o">.</span><span class="na">getCon</span><span class="o">();</span>
					<span class="n">userDao</span><span class="o">.</span><span class="na">userAdd</span><span class="o">(</span><span class="n">con</span><span class="o">,</span> <span class="n">user</span><span class="o">);</span>
				<span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
					<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
				<span class="o">}</span><span class="k">finally</span><span class="o">{</span>
					<span class="n">dbUtil</span><span class="o">.</span><span class="na">closeCon</span><span class="o">(</span><span class="n">con</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="nc">JSONObject</span> <span class="n">result</span><span class="o">=</span><span class="k">new</span> <span class="nc">JSONObject</span><span class="o">();</span>
		<span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"success"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">);</span>
		<span class="nc">ResponseUtil</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="nc">ServletActionContext</span><span class="o">.</span><span class="na">getResponse</span><span class="o">(),</span> <span class="n">result</span><span class="o">);</span>
		<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>

<h3 id="servletå¯¼å…¥">servletå¯¼å…¥</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.zhuoer.qsecond.servlet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Iterator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.annotation.WebServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.FileItem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.FileItemFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.FileUploadException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.disk.DiskFileItemFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.servlet.ServletFileUpload</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFRow</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFSheet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.hssf.usermodel.HSSFWorkbook</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.poi.poifs.filesystem.POIFSFileSystem</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.google.gson.Gson</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.GsonBuilder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhuoer.qmaintance.utils.RepairInfoTools</span><span class="o">;</span>

<span class="cm">/**
 * ç”¨Excelå¯¼å…¥æ•°æ®åˆ°partstateè¡¨ 
 */</span>
<span class="nd">@WebServlet</span><span class="o">(</span><span class="s">"/UploadPartState"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UploadPartState</span> <span class="kd">extends</span> <span class="nc">HttpServlet</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

	<span class="cm">/**
	 * @see HttpServlet#HttpServlet()
	 */</span>
	<span class="kd">public</span> <span class="nf">UploadPartState</span><span class="o">()</span> <span class="o">{</span>
		<span class="kd">super</span><span class="o">();</span>
		<span class="c1">// TODO Auto-generated constructor stub</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */</span>
	<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="cm">/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse
	 *      response)
	 */</span>
	<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
		<span class="n">request</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">);</span>
		<span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"text/html;charset=utf-8"</span><span class="o">);</span>
		<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Access-Control-Allow-Origin"</span><span class="o">,</span> <span class="s">"*"</span><span class="o">);</span><span class="c1">// è§£å†³è·¨åŸŸé—®é¢˜</span>

		<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">();</span>
		<span class="c1">// è·å–å‰å°ä¼ å…¥çš„Excelå·¥ä½œç°¿</span>
		<span class="nc">FileItemFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DiskFileItemFactory</span><span class="o">();</span>
		<span class="nc">ServletFileUpload</span> <span class="n">upload</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ServletFileUpload</span><span class="o">(</span><span class="n">factory</span><span class="o">);</span>
		<span class="nc">List</span> <span class="n">items</span><span class="o">;</span>
		<span class="k">try</span> <span class="o">{</span>
			<span class="n">items</span> <span class="o">=</span> <span class="n">upload</span><span class="o">.</span><span class="na">parseRequest</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
			<span class="nc">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
			<span class="nc">Iterator</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span>
			<span class="k">while</span> <span class="o">(</span><span class="n">iter</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span> <span class="o">{</span>
				<span class="nc">FileItem</span> <span class="n">item</span> <span class="o">=</span> <span class="o">(</span><span class="nc">FileItem</span><span class="o">)</span> <span class="n">iter</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
				<span class="k">if</span> <span class="o">(!</span><span class="n">item</span><span class="o">.</span><span class="na">isFormField</span><span class="o">())</span> <span class="o">{</span>
					<span class="n">is</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
				<span class="o">}</span>
			<span class="o">}</span>

			<span class="nc">POIFSFileSystem</span> <span class="n">fs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">POIFSFileSystem</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
			<span class="nc">HSSFWorkbook</span> <span class="n">wb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HSSFWorkbook</span><span class="o">(</span><span class="n">fs</span><span class="o">);</span>
			<span class="nc">HSSFSheet</span> <span class="n">hssfSheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span> <span class="c1">// è·å–ç¬¬ä¸€ä¸ªsheeté¡µ</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">hssfSheet</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">rowNum</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">rowNum</span> <span class="o">&lt;=</span> <span class="n">hssfSheet</span><span class="o">.</span><span class="na">getLastRowNum</span><span class="o">();</span> <span class="n">rowNum</span><span class="o">++)</span> <span class="o">{</span>
					<span class="nc">HSSFRow</span> <span class="n">hssfRow</span> <span class="o">=</span> <span class="n">hssfSheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">rowNum</span><span class="o">);</span>
					<span class="k">if</span> <span class="o">(</span><span class="n">hssfRow</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
						<span class="k">continue</span><span class="o">;</span>
					<span class="o">}</span>
					<span class="c1">// è·å–æ¯ä¸€åˆ—å€¼å°è£…å¯¹è±¡</span>
					<span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"insert into partstate(department_no,department_name,"</span>
							<span class="o">+</span> <span class="s">"device_no,device_name,part_no,part_name,state_no,"</span>
							<span class="o">+</span> <span class="s">"state_name) values(?,?,?,?,?,?,?,?)"</span><span class="o">;</span>
					<span class="kt">int</span> <span class="n">executeUpdate</span> <span class="o">=</span> <span class="nc">RepairInfoTools</span><span class="o">.</span><span class="na">executeUpdate</span><span class="o">(</span><span class="n">sql</span><span class="o">,</span> <span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">)),</span>
							<span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">1</span><span class="o">)),</span> <span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">2</span><span class="o">)),</span>
							<span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">3</span><span class="o">)),</span> <span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">4</span><span class="o">)),</span>
							<span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">5</span><span class="o">)),</span> <span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">6</span><span class="o">)),</span>
							<span class="nc">ExcelUtil</span><span class="o">.</span><span class="na">formatCell</span><span class="o">(</span><span class="n">hssfRow</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">7</span><span class="o">)));</span>

					<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"result"</span><span class="o">,</span> <span class="n">executeUpdate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
				<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"result"</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
			<span class="o">}</span>

			<span class="nc">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GsonBuilder</span><span class="o">().</span><span class="na">setDateFormat</span><span class="o">(</span><span class="s">"yyyy-MM-dd"</span><span class="o">).</span><span class="na">create</span><span class="o">();</span>
			<span class="nc">String</span> <span class="n">json</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">toJson</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
			<span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="n">json</span><span class="o">);</span>
		<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">FileUploadException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
			<span class="c1">// TODO Auto-generated catch block</span>
			<span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
		<span class="o">}</span>
	<span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<h3 id="é¡¹ç›®åœ°å€">é¡¹ç›®åœ°å€</h3>

<p>https://github.com/BaiWeiJieKu/java_poi</p>
:ET