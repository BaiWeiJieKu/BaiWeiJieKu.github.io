I"´×<ul id="markdown-toc">
  <li><a href="#base64" id="markdown-toc-base64">BASE64</a></li>
  <li><a href="#md5" id="markdown-toc-md5">MD5</a></li>
  <li><a href="#des" id="markdown-toc-des">DES</a></li>
  <li><a href="#aes" id="markdown-toc-aes">AES</a></li>
</ul>
<h3 id="base64">BASE64</h3>

<ul>
  <li>
    <p>Base64æ˜¯ä¸€ç§æ ¹æ®ASCIIç æ¥è¿›è¡ŒåŠ å¯†çš„å¯é€†ç®—æ³•ï¼Œè¿™ç±»ç®—æ³•ç®€å•æ¥è¯´ï¼Œå°±ç­‰äºå°†æ¯ä¸ªå­—ç¬¦å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„å­—ç¬¦ï¼ˆå¸¸å¸¸æ˜¯æ ¹æ®è¿›åˆ¶è¿›è¡ŒåŒ¹é…ï¼‰ï¼Œä¸€ä¸€å¯¹åº”ï¼Œç‰¹åˆ«åƒç”µå°å¯†ç æœ¬ï¼Œå› ä¸ºæ¯ä¸ªå­—ç¬¦éƒ½å¿…é¡»è¦åŠ å¯†ï¼ŒåŠ å¯†æ¯”è¾ƒç¬¨é‡ã€‚</p>
  </li>
  <li>
    <p>åŠ å¯†</p>

    <ul>
      <li>è·å–å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦çš„ASCIIç </li>
      <li>æŒ‰ç…§æ¯3ä¸ª8bitçš„å­—ç¬¦ä¸ºä¸€ç»„æ¥åˆ†ç»„ï¼Œå³æ¯ç»„24bit</li>
      <li>å°†è¿™24bitåˆ’åˆ†æˆ4ä¸ª6bitçš„4ä¸ªå•ä½ï¼Œæ¯ä¸ªå•ä½å‰é¢æ·»åŠ 2ä¸ª0ï¼Œå¾—åˆ°4ä¸ª8bitçš„å•ä½</li>
      <li>å°†æ¯ä¸ª8bitçš„å•ä½è½¬æ¢æˆåè¿›åˆ¶æ•°å­—ï¼Œå¯¹ç…§Base64ç¼–ç è¡¨æ‰¾åˆ°å¯¹åº”çš„å­—ç¬¦è¿›è¡Œæ‹¼æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„åŠ å¯†åçš„å­—ç¬¦ä¸²</li>
    </ul>
  </li>
  <li>
    <p>è§£å¯†</p>

    <ul>
      <li>è¯»å…¥4ä¸ªå­—ç¬¦ï¼Œå¯¹ç…§Base64ç¼–ç è¡¨æ‰¾åˆ°å­—ç¬¦å¯¹åº”çš„ç´¢å¼•ï¼Œç”Ÿæˆ4ä¸ª6ä¸ºçš„å€¼</li>
      <li>å°†è¿™4ä¸ª6ä¸ºçš„å€¼æ‹¼æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ª24ä¸ºçš„å€¼</li>
      <li>å°†è¿™ä¸ª24ä½çš„å€¼æŒ‰ç…§8ä½ä¸€ç»„æˆªæ–­æˆ3ä¸ª8ä½çš„å€¼</li>
      <li>å¯¹ç…§ASCIIè¡¨æ‰¾åˆ°è¿™ä¸‰ä¸ª8ä½çš„å€¼å¯¹åº”çš„å­—ç¬¦ï¼Œå³è§£ç åçš„å­—ç¬¦</li>
    </ul>
  </li>
  <li>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/** å·¥å…·ç±»å®ç°ä»£ç   **/</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BASE64Util</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span> <span class="nc">Character</span><span class="o">&gt;</span> <span class="n">base64CharMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">base64CharString</span> <span class="o">=</span> <span class="s">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span><span class="o">;</span>
   
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">BASE64Util</span> <span class="n">instance</span><span class="o">;</span>
   
    <span class="kd">private</span> <span class="nf">BASE64Util</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">base64CharString</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">base64CharString</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="n">base64CharMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">Integer</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="k">new</span> <span class="nc">Character</span><span class="o">(</span><span class="n">c</span><span class="o">));</span>
        <span class="o">}</span>
    <span class="o">}</span>
   
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">BASE64Util</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="nc">BASE64Util</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BASE64Util</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * This method is used to encode a normal string to base64 string @param
     * origin The String to be encoded @return The String after encoded.
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">encode</span><span class="o">(</span><span class="nc">String</span> <span class="n">origin</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">origin</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">origin</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">binaryString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="c1">// to binary String</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">ascii</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">binaryCharString</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">ascii</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">binaryCharString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">binaryCharString</span> <span class="o">=</span> <span class="s">"0"</span> <span class="o">+</span> <span class="n">binaryCharString</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">binaryString</span> <span class="o">+=</span> <span class="n">binaryCharString</span><span class="o">;</span>
        <span class="o">}</span>
   
        <span class="c1">// to base64 index</span>
        <span class="kt">int</span> <span class="n">beginIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">endIndex</span> <span class="o">=</span> <span class="n">beginIndex</span> <span class="o">+</span> <span class="mi">6</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">base64BinaryString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">charString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">base64BinaryString</span> <span class="o">=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">beginIndex</span><span class="o">,</span> <span class="n">endIndex</span><span class="o">)).</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// if length is less than 6, add "0".</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">base64BinaryString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">base64BinaryString</span> <span class="o">+=</span> <span class="s">"0"</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">base64BinaryString</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
            <span class="kt">char</span> <span class="n">base64Char</span> <span class="o">=</span> <span class="n">base64CharMap</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">index</span><span class="o">);</span>
            <span class="n">charString</span> <span class="o">=</span> <span class="n">charString</span> <span class="o">+</span> <span class="n">base64Char</span><span class="o">;</span>
            <span class="n">beginIndex</span> <span class="o">+=</span> <span class="mi">6</span><span class="o">;</span>
            <span class="n">endIndex</span> <span class="o">+=</span> <span class="mi">6</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">endIndex</span> <span class="o">&gt;=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">length</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">endIndex</span> <span class="o">=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">endIndex</span> <span class="o">&lt;</span> <span class="n">beginIndex</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">charString</span> <span class="o">+=</span> <span class="s">"="</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">charString</span> <span class="o">+=</span> <span class="s">"=="</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">charString</span><span class="o">;</span>
    <span class="o">}</span>
   
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">decode</span><span class="o">(</span><span class="nc">String</span> <span class="n">encodedString</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">encodedString</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">encodedString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="s">""</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// get origin base64 String</span>
        <span class="nc">String</span> <span class="n">origin</span> <span class="o">=</span> <span class="n">encodedString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">encodedString</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"="</span><span class="o">));</span>
        <span class="nc">String</span> <span class="n">equals</span> <span class="o">=</span> <span class="n">encodedString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">encodedString</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="s">"="</span><span class="o">));</span>
   
        <span class="nc">String</span> <span class="n">binaryString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="c1">// convert base64 string to binary string</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">origin</span><span class="o">.</span><span class="na">length</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="kt">char</span> <span class="n">c</span> <span class="o">=</span> <span class="n">origin</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">ascii</span> <span class="o">=</span> <span class="n">base64CharString</span><span class="o">.</span><span class="na">indexOf</span><span class="o">(</span><span class="n">c</span><span class="o">);</span>
            <span class="nc">String</span> <span class="n">binaryCharString</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="n">ascii</span><span class="o">);</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">binaryCharString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">binaryCharString</span> <span class="o">=</span> <span class="s">"0"</span> <span class="o">+</span> <span class="n">binaryCharString</span><span class="o">;</span>
            <span class="o">}</span>
            <span class="n">binaryString</span> <span class="o">+=</span> <span class="n">binaryCharString</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="c1">// the encoded string has 1 "=", means that the binary string has append</span>
        <span class="c1">// 2 "0"</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">equals</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">binaryString</span> <span class="o">=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">2</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// the encoded string has 2 "=", means that the binary string has append</span>
        <span class="c1">// 4 "0"</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">equals</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">binaryString</span> <span class="o">=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">-</span> <span class="mi">4</span><span class="o">);</span>
        <span class="o">}</span>
   
        <span class="c1">// convert to String</span>
        <span class="nc">String</span> <span class="n">charString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">resultString</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">beginIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">endIndex</span> <span class="o">=</span> <span class="n">beginIndex</span> <span class="o">+</span> <span class="mi">8</span><span class="o">;</span>
        <span class="k">while</span> <span class="o">((</span><span class="n">charString</span> <span class="o">=</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">beginIndex</span><span class="o">,</span> <span class="n">endIndex</span><span class="o">)).</span><span class="na">length</span><span class="o">()</span> <span class="o">==</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">ascii</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">parseInt</span><span class="o">(</span><span class="n">charString</span><span class="o">,</span> <span class="mi">2</span><span class="o">);</span>
            <span class="n">resultString</span> <span class="o">+=</span> <span class="o">(</span><span class="kt">char</span><span class="o">)</span> <span class="n">ascii</span><span class="o">;</span>
            <span class="n">beginIndex</span> <span class="o">+=</span> <span class="mi">8</span><span class="o">;</span>
            <span class="n">endIndex</span> <span class="o">+=</span> <span class="mi">8</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">endIndex</span> <span class="o">&gt;</span> <span class="n">binaryString</span><span class="o">.</span><span class="na">length</span><span class="o">())</span> <span class="o">{</span>
                <span class="k">break</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">resultString</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="md5">MD5</h3>

<ul>
  <li>
    <p>MD5ç åŠ è§£å¯†ç®—æ³•Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³•)ï¼Œæ˜¯ä¸€ç§ä¸å¯é€†çš„ç®—æ³•ï¼Œå…·æœ‰å¾ˆé«˜çš„å®‰å…¨æ€§ã€‚</p>
  </li>
  <li>
    <p>å®ƒå¯¹åº”ä»»ä½•å­—ç¬¦ä¸²éƒ½å¯ä»¥åŠ å¯†æˆä¸€æ®µå”¯ä¸€çš„å›ºå®šé•¿åº¦çš„ä»£ç ã€‚ï¼ˆå°è´´å£«ï¼šä¸ºå•¥MD5åŠ å¯†ç®—æ³•ä¸å¯é€†å‘¢~ æŒ‰é“ç†æ¥è¯´æœ‰åŠ å¯†æ–¹å¼ï¼Œå°±ä¼šæœ‰è§£å¯†æ–¹å¼å‘€ï¼Ÿå› ä¸ºMD5åŠ å¯†æ˜¯æœ‰ç§æœ‰æŸçš„åŠ å¯†æ–¹å¼ï¼Œæ¯”å¦‚ä¸€æ®µæ•°æ®ä¸ºâ€™123â€™ï¼Œæˆ‘åœ¨åŠ å¯†çš„æ—¶å€™ï¼Œé‡åˆ°1å’Œ3éƒ½ç›´æ¥å½“åšæ˜¯aï¼ŒåŠ å¯†åå˜æˆäº†â€™a2aâ€™ï¼Œæ‰€ä»¥è§£å¯†çš„æ—¶å€™å°±å‡ºç°äº†4ç§ç»„åˆâ€™323â€™â€˜121â€™â€˜123â€™â€˜321â€™ï¼Œæ•°æ®ä¸€å¤šï¼Œè‡ªç„¶æ‰¾ä¸åˆ°åŸå§‹çš„æ•°æ®äº†ï¼Œå½“ç„¶è¿™ç§æ–¹å¼åŠ å¯†çš„å¯†æ–‡ä¹Ÿä¸éœ€è¦è§£å¯†ï¼‰</p>
  </li>
  <li>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// MD5ç å·¥å…·ç±»ä»£ç   </span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MD5Util</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">MD5</span> <span class="o">=</span> <span class="s">"MD5"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="nc">HmacMD5</span> <span class="o">=</span> <span class="s">"HmacMD5"</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">charset</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="c1">// ç¼–ç æ ¼å¼ï¼›é»˜è®¤nullä¸ºGBK</span>
   
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">MD5Util</span> <span class="n">instance</span><span class="o">;</span>
   
    <span class="kd">private</span> <span class="nf">MD5Util</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">}</span>
   
    <span class="c1">// å•ä¾‹</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">MD5Util</span> <span class="nf">getInstance</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">synchronized</span> <span class="o">(</span><span class="nc">MD5Util</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MD5Util</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * ä½¿ç”¨ MD5 æ–¹æ³•åŠ å¯†ï¼ˆæ— å¯†ç ï¼‰
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">encode</span><span class="o">(</span><span class="nc">String</span> <span class="n">res</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">MessageDigest</span> <span class="n">md</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="no">MD5</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">resBytes</span> <span class="o">=</span> <span class="n">charset</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">res</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()</span> <span class="o">:</span> <span class="n">res</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">charset</span><span class="o">);</span>
            <span class="k">return</span> <span class="nc">BASE64Util</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">encode</span><span class="o">(</span><span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="n">resBytes</span><span class="o">).</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * ä½¿ç”¨ MD5 æ–¹æ³•åŠ å¯†ï¼ˆå¯ä»¥è®¾å¯†ç ï¼‰
     */</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">encode</span><span class="o">(</span><span class="nc">String</span> <span class="n">res</span><span class="o">,</span> <span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">SecretKey</span> <span class="n">sk</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">KeyGenerator</span> <span class="n">kg</span> <span class="o">=</span> <span class="nc">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="nc">HmacMD5</span><span class="o">);</span>
                <span class="n">sk</span> <span class="o">=</span> <span class="n">kg</span><span class="o">.</span><span class="na">generateKey</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="kt">byte</span><span class="o">[]</span> <span class="n">keyBytes</span> <span class="o">=</span> <span class="n">charset</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">()</span> <span class="o">:</span> <span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">charset</span><span class="o">);</span>
                <span class="n">sk</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">keyBytes</span><span class="o">,</span> <span class="nc">HmacMD5</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="nc">Mac</span> <span class="n">mac</span> <span class="o">=</span> <span class="nc">Mac</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="nc">HmacMD5</span><span class="o">);</span>
            <span class="n">mac</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">sk</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">result</span> <span class="o">=</span> <span class="n">mac</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">res</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
            <span class="k">return</span> <span class="nc">BASE64Util</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">encode</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    
  	<span class="c1">//è§£å†³æœ‰äº›md5å‰é¢æ˜¯0æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜</span>
   <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">getMD5</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">{</span>
        <span class="c1">// ç”Ÿæˆä¸€ä¸ªMD5åŠ å¯†è®¡ç®—æ‘˜è¦</span>
        <span class="nc">MessageDigest</span> <span class="n">md</span> <span class="o">=</span> <span class="nc">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"MD5"</span><span class="o">);</span>
        <span class="c1">// è®¡ç®—md5å‡½æ•°</span>
        <span class="n">md</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
        <span class="k">return</span> <span class="nf">toHexString</span><span class="o">(</span><span class="n">md</span><span class="o">.</span><span class="na">digest</span><span class="o">());</span>
    <span class="o">}</span>
	<span class="c1">//æŠŠæ•°ç»„ä¸­çš„æ¯ä¸ªå­—èŠ‚è½¬æ¢ä¸º16è¿›åˆ¶</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">toHexString</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>       
        <span class="nc">Formatter</span> <span class="n">formatter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Formatter</span><span class="o">();</span>              
        <span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">b</span> <span class="o">:</span> <span class="n">bytes</span><span class="o">)</span> <span class="o">{</span>          
            <span class="n">formatter</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%02x"</span><span class="o">,</span> <span class="n">b</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nc">String</span> <span class="n">res</span> <span class="o">=</span> <span class="n">formatter</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
        <span class="n">formatter</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">res</span><span class="o">;</span>
   <span class="o">}</span> 
<span class="o">}</span>
</code></pre></div>    </div>

    <p>```</p>
  </li>
</ul>

<h3 id="des">DES</h3>

<p>â€‹```java
public class DESUtil {
    public static final String DES = â€œDESâ€;
    public static final String charset = null; // ç¼–ç æ ¼å¼ï¼›é»˜è®¤nullä¸ºGBK
    public static final int keysizeDES = 0;</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private static DESUtil instance;
 
private DESUtil() {
}
 
// å•ä¾‹
public static DESUtil getInstance() {
    if (instance == null) {
        synchronized (MD5Util.class) {
            if (instance == null) {
                instance = new DESUtil();
            }
        }
    }
    return instance;
}
 
/**
 * ä½¿ç”¨ DES è¿›è¡ŒåŠ å¯†
 */
public String encode(String res, String key) {
    return keyGeneratorES(res, DES, key, keysizeDES, true);
}
 
/**
 * ä½¿ç”¨ DES è¿›è¡Œè§£å¯†
 */
public String decode(String res, String key) {
    return keyGeneratorES(res, DES, key, keysizeDES, false);
}
 
// ä½¿ç”¨KeyGeneratoråŒå‘åŠ å¯†ï¼ŒDES/AESï¼Œæ³¨æ„è¿™é‡Œè½¬åŒ–ä¸ºå­—ç¬¦ä¸²çš„æ—¶å€™æ˜¯å°†2è¿›åˆ¶è½¬ä¸º16è¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸æ˜¯ç›´æ¥è½¬ï¼Œå› ä¸ºä¼šå‡ºé”™
private String keyGeneratorES(String res, String algorithm, String key, int keysize, boolean isEncode) {
    try {
        KeyGenerator kg = KeyGenerator.getInstance(algorithm);
        if (keysize == 0) {
            byte[] keyBytes = charset == null ? key.getBytes() : key.getBytes(charset);
            kg.init(new SecureRandom(keyBytes));
        } else if (key == null) {
            kg.init(keysize);
        } else {
            byte[] keyBytes = charset == null ? key.getBytes() : key.getBytes(charset);
            kg.init(keysize, new SecureRandom(keyBytes));
        }
        SecretKey sk = kg.generateKey();
        SecretKeySpec sks = new SecretKeySpec(sk.getEncoded(), algorithm);
        Cipher cipher = Cipher.getInstance(algorithm);
        if (isEncode) {
            cipher.init(Cipher.ENCRYPT_MODE, sks);
            byte[] resBytes = charset == null ? res.getBytes() : res.getBytes(charset);
            return parseByte2HexStr(cipher.doFinal(resBytes));
        } else {
            cipher.init(Cipher.DECRYPT_MODE, sks);
            return new String(cipher.doFinal(parseHexStr2Byte(res)));
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}
 
// å°†äºŒè¿›åˆ¶è½¬æ¢æˆ16è¿›åˆ¶
private String parseByte2HexStr(byte buf[]) {
    StringBuffer sb = new StringBuffer();
    for (int i = 0; i &lt; buf.length; i++) {
        String hex = Integer.toHexString(buf[i] &amp; 0xFF);
        if (hex.length() == 1) {
            hex = '0' + hex;
        }
        sb.append(hex.toUpperCase());
    }
    return sb.toString();
}
 
// å°†16è¿›åˆ¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶
private byte[] parseHexStr2Byte(String hexStr) {
    if (hexStr.length() &lt; 1)
        return null;
    byte[] result = new byte[hexStr.length() / 2];
    for (int i = 0; i &lt; hexStr.length() / 2; i++) {
        int high = Integer.parseInt(hexStr.substring(i * 2, i * 2 + 1), 16);
        int low = Integer.parseInt(hexStr.substring(i * 2 + 1, i * 2 + 2), 16);
        result[i] = (byte) (high * 16 + low);
    }
    return result;
} }   ```
</code></pre></div></div>

<h3 id="aes">AES</h3>

<ul>
  <li>
    <p>AESä¹Ÿæ˜¯ï¼Œé‡‡ç”¨å¯†é’¥ï¼Œæ„æ€æ˜¯ä¼ å…¥ä¸€ä¸ªéœ€è¦åŠ å¯†çš„å¯¹è±¡çš„åŒæ—¶ï¼Œçº¦å®šä¸€ä¸ªkeyï¼ˆå¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼‰ï¼Œç„¶åè§£å¯†ç«¯ï¼Œé€šè¿‡è¿™ä¸ªkeyè¿›è¡Œè§£å¯†è·å–å¯¹è±¡ã€‚AESçš„å®ç°åŸç†ï¼Œæ˜¯å…ˆç¡®å®šå¯†é’¥ï¼Œç¡®å®šæ–¹å¼ï¼šç®—æ³•/æ¨¡å¼/è¡¥ç ã€‚</p>
  </li>
  <li>
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AESUtil</span> <span class="o">{</span>
   
    <span class="cm">/**
     * åŠ å¯†
     * @return åŠ å¯†åçš„å­—ç¬¦ä¸²
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">Encrypt</span><span class="o">(</span><span class="nc">String</span> <span class="n">src</span><span class="o">,</span> <span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// åˆ¤æ–­å¯†é’¥æ˜¯å¦ä¸ºç©º</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"å¯†é’¥ä¸èƒ½ä¸ºç©º"</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
   
        <span class="c1">// å¯†é’¥è¡¥ä½</span>
        <span class="kt">int</span> <span class="n">plus</span><span class="o">=</span> <span class="mi">16</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">raw</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">plusbyte</span><span class="o">={</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x01</span><span class="o">,</span> <span class="mh">0x02</span><span class="o">,</span> <span class="mh">0x03</span><span class="o">,</span> <span class="mh">0x04</span><span class="o">,</span> <span class="mh">0x05</span><span class="o">,</span> <span class="mh">0x06</span><span class="o">,</span> <span class="mh">0x07</span><span class="o">,</span> <span class="mh">0x08</span><span class="o">,</span> <span class="mh">0x09</span><span class="o">,</span> <span class="mh">0x0a</span><span class="o">,</span> <span class="mh">0x0b</span><span class="o">,</span> <span class="mh">0x0c</span><span class="o">,</span> <span class="mh">0x0d</span><span class="o">,</span> <span class="mh">0x0e</span><span class="o">,</span> <span class="mh">0x0f</span><span class="o">};</span>
        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
        <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">i</span><span class="o">)</span>
                <span class="n">raw</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
            <span class="k">else</span>
                <span class="n">raw</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">plusbyte</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
        <span class="o">}</span>
   
        <span class="nc">SecretKeySpec</span> <span class="n">skeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">);</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/ECB/PKCS5Padding"</span><span class="o">);</span>    <span class="c1">// ç®—æ³•/æ¨¡å¼/è¡¥ç æ–¹å¼</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">skeySpec</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">encrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">src</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">));</span>
   
        <span class="c1">//return new Base64().encodeToString(encrypted);//base64</span>
        <span class="k">return</span> <span class="nf">binary</span><span class="o">(</span><span class="n">encrypted</span><span class="o">,</span> <span class="mi">16</span><span class="o">);</span> <span class="c1">//åå…­è¿›åˆ¶</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * è§£å¯†
     * @return è§£å¯†åçš„å­—ç¬¦ä¸²
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">Decrypt</span><span class="o">(</span><span class="nc">String</span> <span class="n">src</span><span class="o">,</span> <span class="nc">String</span> <span class="n">key</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// åˆ¤æ–­Keyæ˜¯å¦æ­£ç¡®</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">(</span><span class="s">"Keyä¸ºç©ºnull"</span><span class="o">);</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
   
            <span class="c1">// å¯†é’¥è¡¥ä½</span>
            <span class="kt">int</span> <span class="n">plus</span><span class="o">=</span> <span class="mi">16</span><span class="o">-</span><span class="n">key</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">data</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">raw</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">16</span><span class="o">];</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">plusbyte</span><span class="o">={</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x01</span><span class="o">,</span> <span class="mh">0x02</span><span class="o">,</span> <span class="mh">0x03</span><span class="o">,</span> <span class="mh">0x04</span><span class="o">,</span> <span class="mh">0x05</span><span class="o">,</span> <span class="mh">0x06</span><span class="o">,</span> <span class="mh">0x07</span><span class="o">,</span> <span class="mh">0x08</span><span class="o">,</span> <span class="mh">0x09</span><span class="o">,</span> <span class="mh">0x0a</span><span class="o">,</span> <span class="mh">0x0b</span><span class="o">,</span> <span class="mh">0x0c</span><span class="o">,</span> <span class="mh">0x0d</span><span class="o">,</span> <span class="mh">0x0e</span><span class="o">,</span> <span class="mh">0x0f</span><span class="o">};</span>
            <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span>
            <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">data</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">i</span><span class="o">)</span>
                    <span class="n">raw</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
                <span class="k">else</span>
                    <span class="n">raw</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">plusbyte</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
            <span class="o">}</span>
   
            <span class="nc">SecretKeySpec</span> <span class="n">skeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">raw</span><span class="o">,</span> <span class="s">"AES"</span><span class="o">);</span>
            <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES/ECB/PKCS5Padding"</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="nc">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">skeySpec</span><span class="o">);</span>
   
            <span class="c1">//byte[] encrypted1 = new Base64().decode(src);//base64</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">encrypted1</span> <span class="o">=</span> <span class="n">toByteArray</span><span class="o">(</span><span class="n">src</span><span class="o">);</span><span class="c1">//åå…­è¿›åˆ¶</span>
   
            <span class="k">try</span> <span class="o">{</span>
                <span class="kt">byte</span><span class="o">[]</span> <span class="n">original</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">encrypted1</span><span class="o">);</span>
                <span class="nc">String</span> <span class="n">originalString</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">String</span><span class="o">(</span><span class="n">original</span><span class="o">,</span><span class="s">"utf-8"</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">originalString</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ex</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * å°†byte[]è½¬ä¸ºå„ç§è¿›åˆ¶çš„å­—ç¬¦ä¸²
     * @param bytes byte[]
     * @param radix å¯ä»¥è½¬æ¢è¿›åˆ¶çš„èŒƒå›´ï¼Œä»Character.MIN_RADIXåˆ°Character.MAX_RADIXï¼Œè¶…å‡ºèŒƒå›´åå˜ä¸º10è¿›åˆ¶
     * @return è½¬æ¢åçš„å­—ç¬¦ä¸²
     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">binary</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="o">,</span> <span class="kt">int</span> <span class="n">radix</span><span class="o">){</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">BigInteger</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bytes</span><span class="o">).</span><span class="na">toString</span><span class="o">(</span><span class="n">radix</span><span class="o">);</span>   <span class="c1">// è¿™é‡Œçš„1ä»£è¡¨æ­£æ•°</span>
    <span class="o">}</span>
   
    <span class="cm">/**
     * 16è¿›åˆ¶çš„å­—ç¬¦ä¸²è¡¨ç¤ºè½¬æˆå­—èŠ‚æ•°ç»„
     *
     * @param hexString 16è¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²
     * @return è½¬æ¢åçš„å­—èŠ‚æ•°ç»„
     **/</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">toByteArray</span><span class="o">(</span><span class="nc">String</span> <span class="n">hexString</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">hexString</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"this hexString must not be empty"</span><span class="o">);</span>
   
        <span class="n">hexString</span> <span class="o">=</span> <span class="n">hexString</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span>
        <span class="kd">final</span> <span class="kt">byte</span><span class="o">[]</span> <span class="n">byteArray</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="n">hexString</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">byteArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span><span class="c1">//å› ä¸ºæ˜¯16è¿›åˆ¶ï¼Œæœ€å¤šåªä¼šå ç”¨4ä½ï¼Œè½¬æ¢æˆå­—èŠ‚éœ€è¦ä¸¤ä¸ª16è¿›åˆ¶çš„å­—ç¬¦ï¼Œé«˜ä½åœ¨å…ˆ</span>
            <span class="kt">byte</span> <span class="n">high</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="nc">Character</span><span class="o">.</span><span class="na">digit</span><span class="o">(</span><span class="n">hexString</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">k</span><span class="o">),</span> <span class="mi">16</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">);</span>
            <span class="kt">byte</span> <span class="n">low</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="nc">Character</span><span class="o">.</span><span class="na">digit</span><span class="o">(</span><span class="n">hexString</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="o">),</span> <span class="mi">16</span><span class="o">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="o">);</span>
            <span class="n">byteArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="o">(</span><span class="kt">byte</span><span class="o">)</span> <span class="o">(</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span> <span class="o">|</span> <span class="n">low</span><span class="o">);</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">byteArray</span><span class="o">;</span>
    <span class="o">}</span>
   
<span class="o">}</span>
</code></pre></div>    </div>
  </li>
  <li>â€‹</li>
</ul>
:ET