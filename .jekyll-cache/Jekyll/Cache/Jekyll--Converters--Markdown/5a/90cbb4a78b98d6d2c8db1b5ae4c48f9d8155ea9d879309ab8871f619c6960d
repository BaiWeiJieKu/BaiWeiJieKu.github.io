I"<ul id="markdown-toc">
  <li><a href="#分布式系统" id="markdown-toc-分布式系统">分布式系统</a>    <ul>
      <li><a href="#分布式认证" id="markdown-toc-分布式认证">分布式认证</a></li>
      <li><a href="#选型分析" id="markdown-toc-选型分析">选型分析</a></li>
    </ul>
  </li>
</ul>
<h3 id="分布式系统">分布式系统</h3>

<ul>
  <li>具有分布式架构的系统叫分布式系统，分布式系统的运行通常依赖网络，它将单体结构的系统分为若干服务，服务之间通过网络交互来完成用户的业务处理，当前流行的微服务架构就是分布式系统架构，如下图：</li>
</ul>

<p><img src="https://i.loli.net/2020/02/22/w5Ner6XfDSOYKUz.png" alt="image.png" /></p>

<ul>
  <li>分布式系统具体如下基本特点：
    <ul>
      <li>1、分布性：每个部分都可以独立部署，服务之间交互通过网络进行通信，比如：订单服务、商品服务。</li>
      <li>2、伸缩性：每个部分都可以集群方式部署，并可针对部分结点进行硬件及软件扩容，具有一定的伸缩能力。</li>
      <li>3、共享性：每个部分都可以作为共享资源对外提供服务，多个部分可能有操作共享资源的情况。</li>
      <li>4、开放性：每个部分根据需求都可以对外发布共享资源的访问接口，并可允许第三方系统访问。</li>
    </ul>
  </li>
</ul>

<h4 id="分布式认证">分布式认证</h4>

<ul>
  <li>分布式系统的每个服务都会有认证、授权的需求，如果每个服务都实现一套认证授权逻辑会非常冗余，考虑分布式系统共享性的特点，需要由独立的认证服务处理系统认证授权的请求；考虑分布式系统开放性的特点，不仅对系统内部服务提供认证，对第三方系统也要提供认证。</li>
  <li><strong>统一认证授权</strong>：提供独立的认证服务，统一处理认证授权。无论是不同类型的用户，还是不同种类的客户端(web端，H5、APP)，均采用一致的认证、权限、会话机制，实现统一认证授权。要实现统一则认证方式必须可扩展，支持各种认证需求，比如：用户名密码认证、短信验证码、二维码、人脸识别等认证方式，并可以非常灵活的切换。</li>
  <li><strong>应用接入认证</strong>：应提供扩展和开放能力，提供安全的系统对接机制，并可开放部分API给接入第三方使用，一方应用（内部 系统服务）和三方应用（第三方应用）均采用统一机制接入。</li>
</ul>

<h4 id="选型分析">选型分析</h4>

<ul>
  <li>1、<strong>基于session的认证方式</strong>：在分布式的环境下，基于session的认证会出现一个问题，每个应用服务都需要在session中存储用户身份信息，通过负载均衡将本地的请求分配到另一个应用服务需要将session信息带过去，否则会重新认证。</li>
</ul>

<p><img src="https://i.loli.net/2020/02/22/WgNtHA6mMbIwGXK.png" alt="image.png" /></p>

<ul>
  <li>这个时候，通常的做法有下面几种：
    <ul>
      <li><strong>Session复制</strong>：多台应用服务器之间同步session，使session保持一致，对外透明。</li>
      <li><strong>Session黏贴</strong>：当用户访问集群中某台服务器后，强制指定后续所有请求均落到此机器上。</li>
      <li><strong>Session集中存储</strong>：将Session存入分布式缓存中，所有服务器应用实例统一从分布式缓存中存取Session。</li>
    </ul>
  </li>
  <li>总体来讲，基于session认证的认证方式，可以更好的在服务端对会话进行控制，且安全性较高。但是，session机制方式基于cookie，在复杂多样的移动客户端上不能有效的使用，并且无法跨域，另外随着系统的扩展需提高session的复制、黏贴及存储的容错性。</li>
</ul>
:ET