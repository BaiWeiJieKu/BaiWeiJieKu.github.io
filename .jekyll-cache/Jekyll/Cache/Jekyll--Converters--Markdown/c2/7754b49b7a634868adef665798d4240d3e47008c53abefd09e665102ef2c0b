I"¹=<ul id="markdown-toc">
  <li><a href="#å…¥é—¨" id="markdown-toc-å…¥é—¨">å…¥é—¨</a>    <ul>
      <li><a href="#æ—¥å¿—çº§åˆ«" id="markdown-toc-æ—¥å¿—çº§åˆ«">æ—¥å¿—çº§åˆ«</a></li>
    </ul>
  </li>
  <li><a href="#é…ç½®è®²è§£" id="markdown-toc-é…ç½®è®²è§£">é…ç½®è®²è§£</a>    <ul>
      <li><a href="#properties" id="markdown-toc-properties">properties</a></li>
      <li><a href="#æ ¼å¼è§£é‡Š" id="markdown-toc-æ ¼å¼è§£é‡Š">æ ¼å¼è§£é‡Š</a></li>
      <li><a href="#xmlæ ¼å¼" id="markdown-toc-xmlæ ¼å¼">xmlæ ¼å¼</a></li>
    </ul>
  </li>
</ul>
<h2 id="å…¥é—¨">å…¥é—¨</h2>

<ul>
  <li>çŸ¥é“æ˜¯log4j.TestLog4jè¿™ä¸ªç±»é‡Œçš„æ—¥å¿—</li>
  <li>æ˜¯åœ¨[main]çº¿ç¨‹é‡Œçš„æ—¥å¿—</li>
  <li>æ—¥å¿—çº§åˆ«å¯è§‚å¯Ÿï¼Œä¸€å…±æœ‰6ä¸ªçº§åˆ« TRACE DEBUG INFO WARN ERROR FATAL</li>
  <li>æ—¥å¿—è¾“å‡ºçº§åˆ«èŒƒå›´å¯æ§åˆ¶ï¼Œ å¦‚ä»£ç æ‰€ç¤ºï¼Œåªè¾“å‡ºé«˜äºDEBUGçº§åˆ«çš„ï¼Œé‚£ä¹ˆTRACEçº§åˆ«çš„æ—¥å¿—è‡ªåŠ¨ä¸è¾“å‡º</li>
  <li>æ¯å¥æ—¥å¿—æ¶ˆè€—çš„æ¯«ç§’æ•°(æœ€å‰é¢çš„æ•°å­—)ï¼Œå¯è§‚å¯Ÿï¼Œè¿™æ ·å°±å¯ä»¥è¿›è¡Œæ€§èƒ½è®¡ç®—</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">log4j</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.log4j.BasicConfigurator</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.log4j.Level</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.log4j.Logger</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestLog4j</span> <span class="o">{</span>
    <span class="c1">//åŸºäºç±»çš„åç§°è·å–æ—¥å¿—å¯¹è±¡</span>
	<span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">TestLog4j</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="c1">//è¿›è¡Œé»˜è®¤é…ç½®</span>
		<span class="nc">BasicConfigurator</span><span class="o">.</span><span class="na">configure</span><span class="o">();</span>
        <span class="c1">//è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">setLevel</span><span class="o">(</span><span class="nc">Level</span><span class="o">.</span><span class="na">DEBUG</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"è·Ÿè¸ªä¿¡æ¯"</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"è°ƒè¯•ä¿¡æ¯"</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"è¾“å‡ºä¿¡æ¯"</span><span class="o">);</span>
		<span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"è­¦å‘Šä¿¡æ¯"</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"é”™è¯¯ä¿¡æ¯"</span><span class="o">);</span>
		<span class="n">logger</span><span class="o">.</span><span class="na">fatal</span><span class="o">(</span><span class="s">"è‡´å‘½ä¿¡æ¯"</span><span class="o">);</span>

	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="æ—¥å¿—çº§åˆ«">æ—¥å¿—çº§åˆ«</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>logger.trace("è·Ÿè¸ªä¿¡æ¯");
logger.debug("è°ƒè¯•ä¿¡æ¯");
logger.info("è¾“å‡ºä¿¡æ¯");
Thread.sleep(1000);
logger.warn("è­¦å‘Šä¿¡æ¯");
logger.error("é”™è¯¯ä¿¡æ¯");
logger.fatal("è‡´å‘½ä¿¡æ¯");
</code></pre></div></div>

<h2 id="é…ç½®è®²è§£">é…ç½®è®²è§£</h2>

<h3 id="properties">properties</h3>

<ul>
  <li>é¦–å…ˆåœ¨srcç›®å½•ä¸‹æ·»åŠ log4j.propertiesæ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶ä»€ä¹ˆå«ä¹‰åé¢å†è®²</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>è®¾ç½®æ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸ºdebug,ä½äºdebugå°±ä¸ä¼šè¾“å‡ºäº†,è®¾ç½®æ—¥å¿—è¾“å‡ºåˆ°ä¸¤ç§åœ°æ–¹ï¼Œåˆ†åˆ«å«åš stdoutå’Œ R
log4j.rootLogger=debug, stdout, R

ç¬¬ä¸€ä¸ªåœ°æ–¹stdout, è¾“å‡ºåˆ°æ§åˆ¶å°
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout

è¾“å‡ºæ ¼å¼æ˜¯ %5p [%t] (%F:%L) - %m%n
# Pattern to output the caller's file name and line number.
log4j.appender.stdout.layout.ConversionPattern=%5p [%t] (%F:%L) - %m%n

ç¬¬äºŒä¸ªåœ°æ–¹R, ä»¥æ»šåŠ¨çš„æ–¹å¼è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œæ–‡ä»¶åæ˜¯example.log,æ–‡ä»¶æœ€å¤§100k, æœ€å¤šæ»šåŠ¨5ä¸ªæ–‡ä»¶
log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=example.log

log4j.appender.R.MaxFileSize=100KB
# Keep one backup file
log4j.appender.R.MaxBackupIndex=5

è¾“å‡ºæ ¼å¼æ˜¯ %p %t %c - %m%n
log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">log4j</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.log4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.log4j.PropertyConfigurator</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestLog4j</span> <span class="o">{</span>
	<span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">TestLog4j</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
        <span class="c1">//æŠŠæ—¥å¿—è¾“å‡ºåˆ°äº† E:\project\log4j\example.log è¿™ä¸ªä½ç½®</span>
        <span class="c1">//Log4jçš„é…ç½®æ–¹å¼æŒ‰ç…§log4j.propertiesä¸­çš„è®¾ç½®è¿›è¡Œ</span>
		<span class="nc">PropertyConfigurator</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="s">"e:\\project\\log4j\\src\\log4j.properties"</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"è·Ÿè¸ªä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"è°ƒè¯•ä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"è¾“å‡ºä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"è­¦å‘Šä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"é”™è¯¯ä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">fatal</span><span class="o">(</span><span class="s">"è‡´å‘½ä¿¡æ¯"</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h3 id="æ ¼å¼è§£é‡Š">æ ¼å¼è§£é‡Š</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>log4jæ—¥å¿—è¾“å‡ºæ ¼å¼ä¸€è§ˆï¼š
%c è¾“å‡ºæ—¥å¿—ä¿¡æ¯æ‰€å±çš„ç±»çš„å…¨å
%d è¾“å‡ºæ—¥å¿—æ—¶é—´ç‚¹çš„æ—¥æœŸæˆ–æ—¶é—´ï¼Œé»˜è®¤æ ¼å¼ä¸ºISO8601ï¼Œä¹Ÿå¯ä»¥åœ¨å…¶åæŒ‡å®šæ ¼å¼ï¼Œæ¯”å¦‚ï¼š%d{yyy-MM-dd HH:mm:ss }ï¼Œè¾“å‡ºç±»ä¼¼ï¼š2002-10-18- 22ï¼š10ï¼š28
%f è¾“å‡ºæ—¥å¿—ä¿¡æ¯æ‰€å±çš„ç±»çš„ç±»å
%l è¾“å‡ºæ—¥å¿—äº‹ä»¶çš„å‘ç”Ÿä½ç½®ï¼Œå³è¾“å‡ºæ—¥å¿—ä¿¡æ¯çš„è¯­å¥å¤„äºå®ƒæ‰€åœ¨çš„ç±»çš„ç¬¬å‡ è¡Œ
%m è¾“å‡ºä»£ç ä¸­æŒ‡å®šçš„ä¿¡æ¯ï¼Œå¦‚log(message)ä¸­çš„message
%n è¾“å‡ºä¸€ä¸ªå›è½¦æ¢è¡Œç¬¦ï¼ŒWindowså¹³å°ä¸ºâ€œrnâ€ï¼ŒUnixå¹³å°ä¸ºâ€œnâ€
%p è¾“å‡ºä¼˜å…ˆçº§ï¼Œå³DEBUGï¼ŒINFOï¼ŒWARNï¼ŒERRORï¼ŒFATALã€‚å¦‚æœæ˜¯è°ƒç”¨debug()è¾“å‡ºçš„ï¼Œåˆ™ä¸ºDEBUGï¼Œä¾æ­¤ç±»æ¨
%r è¾“å‡ºè‡ªåº”ç”¨å¯åŠ¨åˆ°è¾“å‡ºè¯¥æ—¥å¿—ä¿¡æ¯æ‰€è€—è´¹çš„æ¯«ç§’æ•°
%t è¾“å‡ºäº§ç”Ÿè¯¥æ—¥å¿—äº‹ä»¶çš„çº¿ç¨‹å

æ‰€ä»¥ï¼š
%5p [%t] (%F:%L) - %m%n å°±è¡¨ç¤º
å®½åº¦æ˜¯5çš„ä¼˜å…ˆç­‰çº§ çº¿ç¨‹åç§° (æ–‡ä»¶å:è¡Œå·) - ä¿¡æ¯ å›è½¦æ¢è¡Œ
</code></pre></div></div>

<h3 id="xmlæ ¼å¼">xmlæ ¼å¼</h3>

<ul>
  <li>åœ¨srcç›®å½•ä¸‹å‡†å¤‡log4j.xmlæ–‡ä»¶</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="cp">&lt;!DOCTYPE log4j:configuration PUBLIC "-//log4j/log4j Configuration//EN" "log4j.dtd"&gt;</span>
 
<span class="nt">&lt;log4j:configuration</span> <span class="na">xmlns:log4j=</span><span class="s">"http://jakarta.apache.org/log4j/"</span><span class="nt">&gt;</span>
     
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">"STDOUT"</span> <span class="na">class=</span><span class="s">"org.apache.log4j.ConsoleAppender"</span><span class="nt">&gt;</span>
       <span class="nt">&lt;layout</span> <span class="na">class=</span><span class="s">"org.apache.log4j.PatternLayout"</span><span class="nt">&gt;</span> 
          <span class="nt">&lt;param</span> <span class="na">name=</span><span class="s">"ConversionPattern"</span> <span class="na">value=</span><span class="s">"%d %-5p %c.%M:%L - %m%n"</span><span class="nt">/&gt;</span> 
       <span class="nt">&lt;/layout&gt;</span> 
    <span class="nt">&lt;/appender&gt;</span>
  
    <span class="c">&lt;!-- specify the logging level for loggers from other libraries --&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"com.opensymphony"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"ERROR"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
 
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"org.apache"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"ERROR"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
    <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">"org.hibernate"</span><span class="nt">&gt;</span>
         <span class="nt">&lt;level</span> <span class="na">value=</span><span class="s">"ERROR"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/logger&gt;</span>
   
   <span class="c">&lt;!-- for all other loggers log only debug and above log messages --&gt;</span>
     <span class="nt">&lt;root&gt;</span>
        <span class="nt">&lt;priority</span> <span class="na">value=</span><span class="s">"ERROR"</span><span class="nt">/&gt;</span> 
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">"STDOUT"</span> <span class="nt">/&gt;</span> 
     <span class="nt">&lt;/root&gt;</span> 
     
<span class="nt">&lt;/log4j:configuration&gt;</span> 

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">log4j</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.log4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.log4j.PropertyConfigurator</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestLog4j</span> <span class="o">{</span>
	<span class="kd">static</span> <span class="nc">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="nc">Logger</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="nc">TestLog4j</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span> <span class="o">{</span>
		<span class="nc">PropertyConfigurator</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="s">"e:\\project\\log4j\\src\\log4j.xml"</span><span class="o">);</span>
		<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">trace</span><span class="o">(</span><span class="s">"è·Ÿè¸ªä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"è°ƒè¯•ä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"è¾“å‡ºä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"è­¦å‘Šä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"é”™è¯¯ä¿¡æ¯"</span><span class="o">);</span>
			<span class="n">logger</span><span class="o">.</span><span class="na">fatal</span><span class="o">(</span><span class="s">"è‡´å‘½ä¿¡æ¯"</span><span class="o">);</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<p>æœ¬æ–‡ç« å‚è€ƒè‡ªï¼šhttp://how2j.cn</p>
:ET