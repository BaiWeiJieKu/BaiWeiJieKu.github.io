I"#Ä<ul id="markdown-toc">
  <li><a href="#å¤„ç†å™¨æ˜ å°„å™¨" id="markdown-toc-å¤„ç†å™¨æ˜ å°„å™¨">å¤„ç†å™¨æ˜ å°„å™¨</a></li>
  <li><a href="#å¤„ç†å™¨é€‚é…å™¨" id="markdown-toc-å¤„ç†å™¨é€‚é…å™¨">å¤„ç†å™¨é€‚é…å™¨</a>    <ul>
      <li><a href="#simplecontrollerhandleradapter" id="markdown-toc-simplecontrollerhandleradapter">SimpleControllerHandlerAdapter</a></li>
      <li><a href="#httprequesthandleradapter" id="markdown-toc-httprequesthandleradapter">HttpRequestHandlerAdapter</a></li>
    </ul>
  </li>
  <li><a href="#å¤„ç†å™¨" id="markdown-toc-å¤„ç†å™¨">å¤„ç†å™¨</a>    <ul>
      <li><a href="#abstractcontroller" id="markdown-toc-abstractcontroller">AbstractController</a></li>
      <li><a href="#multiactioncontroller" id="markdown-toc-multiactioncontroller">MultiActionController</a></li>
    </ul>
  </li>
  <li><a href="#modelandview" id="markdown-toc-modelandview">ModelAndView</a>    <ul>
      <li><a href="#æ¨¡å‹" id="markdown-toc-æ¨¡å‹">æ¨¡å‹</a></li>
      <li><a href="#è§†å›¾" id="markdown-toc-è§†å›¾">è§†å›¾</a></li>
    </ul>
  </li>
  <li><a href="#è§†å›¾è§£æå™¨" id="markdown-toc-è§†å›¾è§£æå™¨">è§†å›¾è§£æå™¨</a>    <ul>
      <li><a href="#internalresourceviewresolver" id="markdown-toc-internalresourceviewresolver">InternalResourceViewResolver</a></li>
      <li><a href="#beannameviewresolver" id="markdown-toc-beannameviewresolver">BeanNameViewResolver</a></li>
      <li><a href="#xmlviewresolver" id="markdown-toc-xmlviewresolver">XmlViewResolver</a></li>
      <li><a href="#resourcebundleviewresolver" id="markdown-toc-resourcebundleviewresolver">ResourceBundleViewResolver</a></li>
      <li><a href="#ä¼˜å…ˆçº§" id="markdown-toc-ä¼˜å…ˆçº§">ä¼˜å…ˆçº§</a></li>
    </ul>
  </li>
</ul>
<h3 id="å¤„ç†å™¨æ˜ å°„å™¨">å¤„ç†å™¨æ˜ å°„å™¨</h3>

<ul>
  <li>
    <p>HandlerMapping</p>
  </li>
  <li>å¤šä¸ªæ˜ å°„å¯¹åº”ä¸€ä¸ªèµ„æº</li>
  <li>andlerMapping æ¥å£è´Ÿè´£æ ¹æ® request è¯·æ±‚æ‰¾åˆ°å¯¹åº”çš„ Handler å¤„ç†å™¨åŠ Interceptor æ‹¦æˆªå™¨ï¼Œå¹¶å°†å®ƒä»¬å°è£…åœ¨ HandlerExecutionChain å¯¹è±¡ä¸­ï¼Œè¿”å›ç»™ä¸­å¤®è°ƒåº¦å™¨</li>
  <li>å…¶å¸¸ç”¨çš„å®ç°ç±»æœ‰ä¸¤ç§ï¼š</li>
  <li>BeanNameUrlHandlerMapping</li>
  <li>SimpleUrlHandlerMapping</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨æ˜ å°„å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.handle.SimpleUrlHandlerMapping"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"mappings"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;props&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/hello.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/hello1.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/hello2.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
		<span class="nt">&lt;/props&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"myController"</span> <span class="na">class=</span><span class="s">"com.test.controller.MyController"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<ul>
  <li>SimpleUrlHandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ï¼Œä¼šæ ¹æ®è¯·æ±‚çš„ url ä¸ Spring å®¹å™¨ä¸­å®šä¹‰çš„å¤„ç†å™¨æ˜ å°„å™¨å­æ ‡ç­¾çš„ key å±æ€§è¿›è¡ŒåŒ¹é…ã€‚åŒ¹é…ä¸Šåï¼Œå†å°†è¯¥ key çš„ value å€¼ä¸å¤„ç†å™¨ bean çš„ idå€¼è¿›è¡ŒåŒ¹é…ï¼Œä»è€Œåœ¨ spring å®¹å™¨ä¸­æ‰¾åˆ°å¤„ç†å™¨ bean</li>
</ul>

<h3 id="å¤„ç†å™¨é€‚é…å™¨">å¤„ç†å™¨é€‚é…å™¨</h3>

<ul>
  <li>
    <p>HandlerAdapter</p>
  </li>
  <li>é€‚é…å™¨æ¨¡å¼è§£å†³çš„é—®é¢˜æ˜¯ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥åœ¨ä¸€èµ·å·¥ä½œã€‚æ‰€ä»¥å¤„ç†å™¨é€‚é…å™¨æ‰€èµ·çš„ä½œç”¨æ˜¯ï¼Œå°†å¤šç§å¤„ç†å™¨ï¼ˆå®ç°äº†ä¸åŒæ¥å£çš„å¤„ç†å™¨ï¼‰ï¼Œé€šè¿‡å¤„ç†å™¨é€‚é…å™¨çš„é€‚é…ï¼Œä½¿å®ƒä»¬å¯ä»¥è¿›è¡Œç»Ÿä¸€æ ‡å‡†çš„å·¥ä½œï¼Œå¯¹è¯·æ±‚è¿›è¡Œç»Ÿä¸€æ–¹å¼çš„å¤„ç†ã€‚</li>
  <li>åªæ‰€ä»¥è¦å°† Handler å®šä¹‰ä¸º Controller æ¥å£çš„å®ç°ç±»ï¼Œå°±æ˜¯å› ä¸ºè¿™é‡Œä½¿ç”¨çš„å¤„ç†å™¨é€‚é…å™¨æ˜¯ SimpleControllerHandlerAdapter</li>
  <li>æ‰“å¼€å…¶æºç ï¼Œå¯ä»¥çœ‹åˆ°å°† handler å¼ºè½¬ä¸ºäº† Controller</li>
  <li>ä¸­å¤®è°ƒåº¦å™¨é¦–å…ˆä¼šè°ƒç”¨è¯¥é€‚é…å™¨çš„ supports()æ–¹æ³•ï¼Œåˆ¤æ–­è¯¥ Handler æ˜¯å¦ä¸Controller å…·æœ‰ is-a å…³ç³»ã€‚åœ¨å…·æœ‰ is-a å…³ç³»çš„å‰æä¸‹ï¼Œæ‰ä¼šå¼ºè½¬</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleControllerHandlerAdapter</span> <span class="kd">implements</span> <span class="nc">HandlerAdapter</span> <span class="o">{</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="o">(</span><span class="n">handler</span> <span class="k">instanceof</span> <span class="nc">Controller</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="nd">@Nullable</span>
	<span class="kd">public</span> <span class="nc">ModelAndView</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
		<span class="c1">//å¼ºè½¬åï¼Œå°±ä¼šè°ƒç”¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å¤„ç†å™¨çš„ handleRequest()æ–¹æ³•</span>
		<span class="k">return</span> <span class="o">((</span><span class="nc">Controller</span><span class="o">)</span> <span class="n">handler</span><span class="o">).</span><span class="na">handleRequest</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">long</span> <span class="nf">getLastModified</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">Object</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="k">instanceof</span> <span class="nc">LastModified</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="o">((</span><span class="nc">LastModified</span><span class="o">)</span> <span class="n">handler</span><span class="o">).</span><span class="na">getLastModified</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1L</span><span class="o">;</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>HandlerAdapter æ¥å£ä¼šæ ¹æ®å¤„ç†å™¨æ‰€å®ç°æ¥å£çš„ä¸åŒï¼Œå¯¹å¤„ç†å™¨è¿›è¡Œé€‚é…ï¼Œé€‚é…åå³å¯å¯¹å¤„ç†å™¨è¿›è¡Œæ‰§è¡Œã€‚é€šè¿‡æ‰©å±•å¤„ç†å™¨é€‚é…å™¨ï¼Œå¯ä»¥æ‰§è¡Œå¤šç§ç±»å‹çš„å¤„ç†å™¨</li>
  <li>ç”¨çš„HandlerAdapter æ¥å£å®ç°ç±»æœ‰ä¸¤ç§ï¼š</li>
</ul>

<h4 id="simplecontrollerhandleradapter">SimpleControllerHandlerAdapter</h4>

<ul>
  <li>æ‰€æœ‰å®ç°äº† Controller æ¥å£çš„å¤„ç†å™¨ Beanï¼Œå‡æ˜¯é€šè¿‡æ­¤é€‚é…å™¨è¿›è¡Œé€‚é…ã€æ‰§è¡Œçš„ã€‚ Controller æ¥å£ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Controller</span> <span class="o">{</span>

	<span class="cm">/**
	 * Process the request and return a ModelAndView object which the DispatcherServlet
	 * will render. A {@code null} return value is not an error: it indicates that
	 * this object completed request processing itself and that there is therefore no
	 * ModelAndView to render.
	 * @param request current HTTP request
	 * @param response current HTTP response
	 * @return a ModelAndView to render, or {@code null} if handled directly
	 * @throws Exception in case of errors
	 */</span>
	<span class="nd">@Nullable</span>
	<span class="nc">ModelAndView</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>è¯¥æ–¹æ³•ç”¨äºå¤„ç†ç”¨æˆ·æäº¤çš„è¯·æ±‚ã€‚é€šè¿‡è°ƒç”¨ Service å±‚ä»£ç ï¼Œå®ç°å¯¹ç”¨æˆ·è¯·æ±‚çš„è®¡ç®—å“åº”ï¼Œå¹¶æœ€ç»ˆå°†è®¡ç®—æ‰€å¾—æ•°æ®åŠè¦å“åº”çš„é¡µé¢ï¼Œå°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ ModelAndViewï¼Œè¿”å›ç»™ä¸­å¤®è°ƒåº¦å™¨</li>
</ul>

<h4 id="httprequesthandleradapter">HttpRequestHandlerAdapter</h4>

<ul>
  <li>æ‰€æœ‰å®ç°äº† HttpRequestHandler æ¥å£çš„å¤„ç†å™¨ Beanï¼Œå‡æ˜¯é€šè¿‡æ­¤é€‚é…å™¨è¿›è¡Œé€‚é…ã€æ‰§è¡Œçš„</li>
  <li>HttpRequestHandler æ¥å£ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">HttpRequestHandler</span> <span class="o">{</span>

	<span class="cm">/**
	 * Process the given request, generating a response.
	 * @param request current HTTP request
	 * @param response current HTTP response
	 * @throws ServletException in case of general errors
	 * @throws IOException in case of I/O errors
	 */</span>
	<span class="kt">void</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>è¯¥æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œä¸èƒ½åƒ ModelAndView ä¸€æ ·ï¼Œå°†æ•°æ®åŠç›®æ ‡è§†å›¾å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚ä½†å¯ä»¥å°†æ•°æ®ç›´æ¥æ”¾å…¥åˆ° requestã€session ç­‰åŸŸå±æ€§ä¸­ï¼Œå¹¶ç”± request æˆ– response å®Œæˆåˆ°ç›®æ ‡é¡µé¢çš„è·³è½¬</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyController</span> <span class="kd">implements</span> <span class="nc">HttpRequestHandler</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="n">request</span><span class="o">.</span><span class="na">setAttribute</span><span class="o">(</span><span class="s">"welcome"</span><span class="o">,</span><span class="s">"welcome to china"</span><span class="o">);</span>
        <span class="n">request</span><span class="o">.</span><span class="na">getRequestDispatcher</span><span class="o">(</span><span class="s">"/WEB-INF/jsp/welcome.jsp"</span><span class="o">).</span><span class="na">forward</span><span class="o">(</span><span class="n">request</span><span class="o">,</span><span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="å¤„ç†å™¨">å¤„ç†å™¨</h3>

<ul>
  <li>å¤„ç†å™¨é™¤äº†å®ç° Controller æ¥å£å¤–ï¼Œè¿˜å¯ä»¥ç»§æ‰¿è‡ªä¸€äº›å…¶å®ƒçš„ç±»æ¥å®Œæˆä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ã€‚</li>
</ul>

<h4 id="abstractcontroller">AbstractController</h4>

<ul>
  <li>è‹¥å¤„ç†å™¨ç»§æ‰¿è‡ª AbstractController ç±»ï¼Œé‚£ä¹ˆè¯¥æ§åˆ¶å™¨å°±å…·æœ‰äº†ä¸€äº›æ–°çš„åŠŸèƒ½ã€‚å› ä¸ºAbstractController ç±»è¿˜ç»§æ‰¿è‡ªä¸€ä¸ªçˆ¶ç±» WebContentGenerator</li>
  <li>WebContentGenerator ç±»å…·æœ‰ supportedMethods å±æ€§ï¼Œå¯ä»¥è®¾ç½®æ”¯æŒçš„ HTTP æ•°æ®æäº¤æ–¹å¼ã€‚é»˜è®¤æ”¯æŒ GETã€POST</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
	 * Set the HTTP methods that this content generator should support.
	 * &lt;p&gt;Default is GET, HEAD and POST for simple form controller types;
	 * unrestricted for general controllers and interceptors.
	 */</span>
	<span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">setSupportedMethods</span><span class="o">(</span><span class="nd">@Nullable</span> <span class="nc">String</span><span class="o">...</span> <span class="n">methods</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">if</span> <span class="o">(!</span><span class="nc">ObjectUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">methods</span><span class="o">))</span> <span class="o">{</span>
			<span class="k">this</span><span class="o">.</span><span class="na">supportedMethods</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedHashSet</span><span class="o">&lt;&gt;(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">methods</span><span class="o">));</span>
		<span class="o">}</span>
		<span class="k">else</span> <span class="o">{</span>
			<span class="k">this</span><span class="o">.</span><span class="na">supportedMethods</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="n">initAllowHeader</span><span class="o">();</span>
	<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>è‹¥å¤„ç†å™¨ç»§æ‰¿è‡ª AbstractController ç±»ï¼Œé‚£ä¹ˆå¤„ç†å™¨å°±å¯ä»¥é€šè¿‡å±æ€§ supportedMethodsæ¥é™åˆ¶ HTTP è¯·æ±‚æäº¤æ–¹å¼äº†ã€‚ä¾‹å¦‚ï¼ŒæŒ‡å®šåªæ”¯æŒ POST çš„ HTTP è¯·æ±‚æäº¤æ–¹å¼</li>
  <li>ä¸è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAbstractController ç±»ä¸­æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•éœ€è¦å®ç°</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
	 * Template method. Subclasses must implement this.
	 * The contract is the same as for {@code handleRequest}.
	 * @see #handleRequest
	 */</span>
	<span class="nd">@Nullable</span>
	<span class="kd">protected</span> <span class="kd">abstract</span> <span class="nc">ModelAndView</span> <span class="nf">handleRequestInternal</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>
</code></pre></div></div>

<ul>
  <li>å³å®šä¹‰å¤„ç†å™¨æ—¶ï¼Œå°±éœ€è¦å®ç°å…¶æŠ½è±¡æ–¹æ³• handleRequestInternal()ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„å¤„ç†å™¨ä¸­å®ç°çš„è¿™ä¸ªæ–¹æ³•æ˜¯ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨æ‰§è¡Œçš„å‘¢ï¼Ÿ</li>
  <li>æ‰€ä»¥ AbstractController ç±»å°±å®ç°äº† Controller æ¥å£çš„ handleRequest()æ–¹æ³•ã€‚ä½†æŸ¥çœ‹AbstractController ç±»çš„ handleRequest()æ–¹æ³•æºç ï¼Œå‘ç°è¯¥æ–¹æ³•æœ€ç»ˆè¿”å›çš„å´æ˜¯æŠ½è±¡æ–¹æ³•handleRequestInternal()</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
	<span class="nd">@Nullable</span>
	<span class="kd">public</span> <span class="nc">ModelAndView</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span>
			<span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>

		<span class="k">if</span> <span class="o">(</span><span class="nc">HttpMethod</span><span class="o">.</span><span class="na">OPTIONS</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()))</span> <span class="o">{</span>
			<span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">"Allow"</span><span class="o">,</span> <span class="n">getAllowHeader</span><span class="o">());</span>
			<span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
		<span class="o">}</span>

		<span class="c1">// Delegate to WebContentGenerator for checking and preparing.</span>
		<span class="n">checkRequest</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
		<span class="n">prepareResponse</span><span class="o">(</span><span class="n">response</span><span class="o">);</span>

		<span class="c1">// Execute handleRequestInternal in synchronized block if required.</span>
		<span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">synchronizeOnSession</span><span class="o">)</span> <span class="o">{</span>
			<span class="nc">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">session</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="nc">Object</span> <span class="n">mutex</span> <span class="o">=</span> <span class="nc">WebUtils</span><span class="o">.</span><span class="na">getSessionMutex</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
				<span class="kd">synchronized</span> <span class="o">(</span><span class="n">mutex</span><span class="o">)</span> <span class="o">{</span>
					<span class="k">return</span> <span class="nf">handleRequestInternal</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
				<span class="o">}</span>
			<span class="o">}</span>
		<span class="o">}</span>

		<span class="k">return</span> <span class="nf">handleRequestInternal</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
	<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>è€Œ AbstractController æŠ½è±¡ç±»çš„å®ç°ç±»å³æˆ‘ä»¬è‡ªå®šä¹‰çš„å­ç±»ï¼Œå®ç°äº†è¯¥æŠ½è±¡æ–¹æ³•ã€‚å³ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å¤„ç†å™¨çš„å¤„ç†å™¨æ–¹æ³• handleRequestInternal()æœ€ç»ˆè¢« AbstractController ç±»çš„handleRequest()æ–¹æ³•è°ƒç”¨æ‰§è¡Œã€‚è€Œ AbstractController ç±»çš„ handleRequest()æ–¹æ³•æ˜¯è¢«å¤„ç†å™¨é€‚é…å™¨è°ƒç”¨æ‰§è¡Œçš„</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyController</span> <span class="kd">extends</span> <span class="nc">AbstractController</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="nc">ModelAndView</span> <span class="nf">handleRequestInternal</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ModelAndView</span> <span class="n">mv</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelAndView</span><span class="o">();</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"welcome"</span><span class="o">,</span><span class="s">"hello springmvc"</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"welcome"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">mv</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h4 id="multiactioncontroller">MultiActionController</h4>

<ul>
  <li>MultiActionController ç±»ç»§æ‰¿è‡ª AbstractControllerï¼Œæ‰€ä»¥ç»§æ‰¿è‡ª MultiActionController ç±»çš„å­ç±»ä¹Ÿå¯ä»¥è®¾ç½® HTTP è¯·æ±‚æäº¤æ–¹å¼</li>
  <li>ç»§æ‰¿è‡ªè¯¥ç±»çš„å¤„ç†å™¨ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªå¤„ç†æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•çš„ç­¾åä¸ºå…¬å…±çš„æ–¹æ³•ï¼Œè¿”å›å€¼ä¸º ModelAndViewï¼ŒåŒ…å«å‚æ•° HttpServletRequest ä¸ HttpServletResponseï¼ŒæŠ›å‡ºException å¼‚å¸¸ï¼Œæ–¹æ³•åéšæ„</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyController</span> <span class="kd">extends</span> <span class="nc">MultiActionController</span>  <span class="o">{</span>

    
    <span class="kd">protected</span> <span class="nc">ModelAndView</span> <span class="nf">doFirst</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ModelAndView</span> <span class="n">mv</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelAndView</span><span class="o">();</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"method"</span><span class="o">,</span><span class="s">"doFirst()"</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"show"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">mv</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">protected</span> <span class="nc">ModelAndView</span> <span class="nf">doSecond</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">ModelAndView</span> <span class="n">mv</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelAndView</span><span class="o">();</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"method"</span><span class="o">,</span><span class="s">"doSecond()"</span><span class="o">);</span>
        <span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"show"</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">mv</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>æ³¨æ„å¤„ç†å™¨ç±»çš„æ˜ å°„è·¯å¾„çš„å†™æ³•ï¼šè¦æ±‚å¿…é¡»ä»¥/xxx/<em>çš„è·¯å¾„æ–¹å¼å®šä¹‰æ˜ å°„è·¯å¾„ã€‚å…¶ä¸­</em>ä¸ºé€šé…ç¬¦ï¼Œåœ¨è®¿é—®æ—¶ä½¿ç”¨è¦è®¿é—®çš„æ–¹æ³•åä»£æ›¿</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨æ˜ å°„å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.handle.SimpleUrlHandlerMapping"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"mappings"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;props&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/my/*.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
		<span class="nt">&lt;/props&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--é…ç½®è§†å›¾è§£æå™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span><span class="nt">&gt;</span>    
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"prefix"</span> <span class="na">value=</span><span class="s">"/WEB-INF/jsp/"</span><span class="nt">/&gt;</span>    
   <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"suffix"</span> <span class="na">value=</span><span class="s">".jsp"</span><span class="nt">&gt;&lt;/property&gt;</span>    
<span class="nt">&lt;/bean&gt;</span> 

<span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"myController"</span> <span class="na">class=</span><span class="s">"com.test.controller.MyController"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<ul>
  <li>å¯¹doFirstæ–¹æ³•çš„æ–¹ä½æ ¼å¼ä¸ºï¼š<code class="language-plaintext highlighter-rouge">http://localhost:8080/é¡¹ç›®å/my/doFirst.do</code></li>
  <li>
    <p>å¯¹doSecondæ–¹æ³•çš„æ–¹ä½æ ¼å¼ä¸ºï¼š<code class="language-plaintext highlighter-rouge">http://localhost:8080/é¡¹ç›®å/my/doSecond.do</code></p>
  </li>
  <li>åª æ‰€ ä»¥ é€š è¿‡ åœ¨ è¯· æ±‚ URI ä¸­ å†™ ä¸Š æ–¹ æ³• å å°± å¯ ä»¥ è®¿ é—® åˆ° æŒ‡ å®š æ–¹ æ³• ï¼Œ æ˜¯ å›  ä¸º åœ¨MultiActionController ç±»ä¸­æœ‰ä¸€ä¸ªä¸“é—¨å¤„ç†æ–¹æ³•åç§°çš„è§£æå™¨ MethodNameResolverã€‚è¯¥è§£æå™¨ä½œä¸ºä¸€ä¸ªå±æ€§å‡ºç°ï¼Œå…·æœ‰ get ä¸ set æ–¹æ³•ã€‚MethodNameResolver æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸åŒçš„è§£æå™¨å®ç°ç±»ï¼Œå…¶å¯¹æ–¹æ³•ååœ¨ URI ä¸­çš„å†™æ³•è¦æ±‚ä¹Ÿæ˜¯ä¸åŒçš„</li>
  <li><strong>InternalPathMethodNameResolver</strong>:æ–¹æ³•åè§£æå™¨ï¼ˆé»˜è®¤ï¼‰</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//InternalPathMethodNameResolver:æ–¹æ³•åè§£æå™¨ï¼ˆé»˜è®¤ï¼‰</span>
<span class="c1">//è¯¥æ–¹æ³•åè§£æå™¨è¦æ±‚æ–¹æ³•åä»¥ URI ä¸­èµ„æºåç§°çš„èº«ä»½å‡ºç°ï¼Œå³æ–¹æ³•ä½œä¸ºä¸€ç§å¯ä»¥è¢«è¯·æ±‚çš„èµ„æºå‡ºç°ã€‚ä¹Ÿå°±æ˜¯å‰é¢çš„å†™æ³•ï¼š/xxx/æ–¹æ³•å</span>
<span class="kd">private</span> <span class="nc">MethodNameResolver</span> <span class="n">methodNameResolver</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InternalPathMethodNameResolver</span><span class="o">();</span>
</code></pre></div></div>

<ul>
  <li><strong>PropertiesMethodNameResolver</strong>:æ–¹æ³•åè§£æå™¨</li>
  <li>è¯¥æ–¹æ³•åè§£æå™¨ä¸­çš„æ–¹æ³•åæ˜¯ä½œä¸º URI èµ„æºåç§°ä¸­çš„ä¸€éƒ¨åˆ†å‡ºç°çš„ï¼Œå³æ–¹æ³•åå¹¶éå•ç‹¬ä½œä¸ºä¸€ç§èµ„æºåç§°å‡ºç°ã€‚ä¾‹å¦‚è¯·æ±‚æ—¶å¯ä»¥å†™ä¸º/xxx_doFirstï¼Œåˆ™ä¼šè®¿é—® xxx æ‰€æ˜ å°„çš„å¤„ç†å™¨çš„doFirst()æ–¹æ³•</li>
  <li>å¤„ç†å™¨æ˜ å°„å™¨çš„è¯·æ±‚æ ¼å¼å‘ç”Ÿäº†æ”¹å˜</li>
  <li>å¦å¤–ï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸ª PropertiesMethodNameResolver æ–¹æ³•åè§£æå™¨ï¼Œå¹¶æŒ‡å®šè¯·æ±‚ä¸è¦æ‰§è¡Œçš„æ–¹æ³•åä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„æŒ‡å®šçš„è¯·æ±‚ï¼Œå¿…é¡»è¦åŠ ä¸Š.doï¼Œå¦åˆ™ï¼Œæ— æ³•å®ŒæˆåŒ¹é…ï¼Œå°†æŠ¥ 404 é”™è¯¯</li>
  <li>æœ€åï¼Œå°†é…ç½®å¥½çš„æ–¹æ³•åè§£æå™¨ï¼Œæ³¨å…¥ç»™å¤„ç†å™¨ã€‚</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨æ˜ å°„å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.handle.SimpleUrlHandlerMapping"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"mappings"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;props&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/my_*.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
		<span class="nt">&lt;/props&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--é…ç½®æ–¹æ³•åè§£æå™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"propertiesMethodNameResolver"</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.mvc.multiaction.PropertiesMethodNameResolver"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"mappings"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;props&gt;</span>
                <span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/my_doFirst.do"</span><span class="nt">&gt;</span>doFirst<span class="nt">&lt;/prop&gt;</span>
                <span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/my_doSecond.do"</span><span class="nt">&gt;</span>doSecond<span class="nt">&lt;/prop&gt;</span>
            <span class="nt">&lt;/props&gt;</span>
        <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"myController"</span> <span class="na">class=</span><span class="s">"com.test.controller.MyController"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"methodNameResolver"</span> <span class="na">ref=</span><span class="s">"propertiesMethodNameResolver"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p>å¯¹doFirstæ–¹æ³•è¿›è¡Œè®¿é—®ï¼š<code class="language-plaintext highlighter-rouge">http://localhost:8080/é¡¹ç›®å/my_doFirst.do</code></p>
  </li>
  <li><strong>arameterMethodNameResolver</strong> :æ–¹æ³•åè§£æå™¨</li>
  <li>è¯¥æ–¹æ³•åè§£æå™¨ä¸­çš„æ–¹æ³•åä½œä¸ºè¯·æ±‚å‚æ•°çš„å€¼å‡ºç°ã€‚ä¾‹å¦‚è¯·æ±‚æ—¶å¯ä»¥å†™ä¸º /xxx?ooo=doFirstï¼Œåˆ™ä¼šè®¿é—® xxx æ‰€æ˜ å°„çš„å¤„ç†å™¨çš„ doFirst()æ–¹æ³•ã€‚å…¶ä¸­ ooo ä¸ºè¯¥è¯·æ±‚æ‰€æºå¸¦çš„å‚æ•°åï¼Œè€Œ doFirst åˆ™ä½œä¸ºå…¶å‚æ•°å€¼å‡ºç°</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨æ˜ å°„å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.handle.SimpleUrlHandlerMapping"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"mappings"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;props&gt;</span>
			<span class="nt">&lt;prop</span> <span class="na">key=</span><span class="s">"/my.do"</span><span class="nt">&gt;</span>myController<span class="nt">&lt;/prop&gt;</span>
		<span class="nt">&lt;/props&gt;</span>
	<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--é…ç½®æ–¹æ³•åè§£æå™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"parameterMethodNameResolver"</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"paramName"</span> <span class="na">value=</span><span class="s">"method"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>

<span class="c">&lt;!--æ³¨å†Œå¤„ç†å™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"myController"</span> <span class="na">class=</span><span class="s">"com.test.controller.MyController"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">"methodNameResolver"</span> <span class="na">ref=</span><span class="s">"parameterMethodNameResolver"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p>å¯¹doFirstæ–¹æ³•è¿›è¡Œè®¿é—®ï¼š<code class="language-plaintext highlighter-rouge">http://localhost:8080/é¡¹ç›®å/my.do?method=doFirst</code></p>
  </li>
  <li>
    <p>ä¸è¿‡ï¼Œæ‰“å¼€ ParameterMethodNameResolver æºç ï¼Œå‘ç°è¯¥ç±»ä¸­æœ‰ä¸€ä¸ªé»˜è®¤çš„å‚æ•° actionã€‚å³è‹¥ä¸æŒ‡å®šå‚æ•°åç§°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ action ä½œä¸ºå‚æ•°</p>
  </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParameterMethodNameResolver</span> <span class="kd">implements</span> <span class="nc">MethodNameResolver</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">DEFAULT_PARAM_NAME</span> <span class="o">=</span> <span class="s">"action"</span><span class="o">;</span>
</code></pre></div></div>

<ul>
  <li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ–¹æ³•åç§°è§£æå™¨ ParameterMethodNameResolver çš„æ³¨å†Œï¼Œå¯ä»¥ä¿®æ”¹ä¸ºå¦‚ä¸‹å½¢å¼ï¼Œå³ä¸æŒ‡å®š paramName çš„å±æ€§å€¼</li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--é…ç½®æ–¹æ³•åè§£æå™¨--&gt;</span>
<span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">"parameterMethodNameResolver"</span> <span class="na">class=</span><span class="s">"org.springframework.web.servlet.mvc.multiaction.ParameterMethodNameResolver"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/bean&gt;</span>
</code></pre></div></div>

<ul>
  <li>å¯¹doFirstæ–¹æ³•è¿›è¡Œè®¿é—®ï¼š<code class="language-plaintext highlighter-rouge">http://localhost:8080/é¡¹ç›®å/my.do?action=doFirst</code></li>
</ul>

<h3 id="modelandview">ModelAndView</h3>

<ul>
  <li>ModelAndView å³æ¨¡å‹ä¸è§†å›¾ï¼Œé€šè¿‡ addObject() æ–¹æ³•å‘æ¨¡å‹ä¸­æ·»åŠ æ•°æ®ï¼Œé€šè¿‡setViewName()æ–¹æ³•å‘æ¨¡å‹æ·»åŠ è§†å›¾åç§°</li>
</ul>

<h4 id="æ¨¡å‹">æ¨¡å‹</h4>

<ul>
  <li><strong>æ¨¡å‹çš„æœ¬è´¨å°±æ˜¯ HashMap</strong></li>
  <li>è·Ÿè¸ª addObject()æ–¹æ³•ï¼Œå¯ä»¥çŸ¥é“è¿™é‡Œçš„æ¨¡å‹å°±æ˜¯ ModelMapï¼Œè€Œ ModelMap çš„æœ¬è´¨å°±æ˜¯ä¸ª HashMapï¼Œå‘æ¨¡å‹ä¸­æ·»åŠ æ•°æ®ï¼Œå°±æ˜¯å‘ HashMap ä¸­æ·»åŠ æ•°æ®ã€‚</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ModelAndViewç±»çš„addObjectæ–¹æ³•</span>
<span class="kd">public</span> <span class="nc">ModelAndView</span> <span class="nf">addObject</span><span class="o">(</span><span class="nc">Object</span> <span class="n">attributeValue</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">getModelMap</span><span class="o">().</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">attributeValue</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

<span class="c1">//è·å–ModelMap</span>
<span class="kd">public</span> <span class="nc">ModelMap</span> <span class="nf">getModelMap</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">model</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ModelMap</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">model</span><span class="o">;</span>
    <span class="o">}</span>
<span class="c1">//è€Œ ModelMap çš„æœ¬è´¨å°±æ˜¯ä¸ª HashMap</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModelMap</span> <span class="kd">extends</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span>
<span class="c1">//è€Œ ModelMap çš„æœ¬è´¨å°±æ˜¯ä¸ª HashMap</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinkedHashMap</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">HashMap</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span>
</code></pre></div></div>

<ul>
  <li>
    <p>ä»ä»¥ä¸Šä»£ç è·Ÿè¸ªå¯çŸ¥ï¼Œå‘ ModelAndView ä¸­æ·»åŠ æ•°æ®ï¼Œå°±æ˜¯å‘ HashMap ä¸­æ·»åŠ æ•°æ®</p>
  </li>
  <li><strong>HashMap æ˜¯ä¸€ä¸ªå•å‘æŸ¥æ‰¾æ•°ç»„</strong></li>
  <li>HashMap çš„æœ¬è´¨æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨æ•°ç»„ï¼Œçœ‹ HashMap çš„æºç ï¼Œå…¶ç”¨äºå­˜æ”¾æ•°æ®çš„åº•å±‚æ•°æ®ç»“æ„ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œè€Œæ•°ç»„å…ƒç´ ä¸ºä¸€ä¸ª Nodeå¯¹è±¡</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="cm">/**
     * The table, initialized on first use, and resized as
     * necessary. When allocated, length is always a power of two.
     * (We also tolerate length zero in some operations to allow
     * bootstrapping mechanics that are currently not needed.)
     */</span>
    <span class="kd">transient</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;[]</span> <span class="n">table</span><span class="o">;</span>
</code></pre></div></div>

<ul>
  <li>è·Ÿè¸ª Nodeç±»å¯çŸ¥ï¼Œå…¶ä¸º HashMap ç±»çš„å†…éƒ¨ç±»ï¼Œä¸ºä¸€ä¸ªå¯å•å‘é“¾è¡¨çš„æ•°æ®ç»“æ„ï¼šå› ä¸ºå…¶åªèƒ½é€šè¿‡ next æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ— æ³•æŸ¥æ‰¾ä¸Šä¸€ä¸ªå…ƒç´ </li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">static</span> <span class="kd">class</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="kt">int</span> <span class="n">hash</span><span class="o">;</span>
        <span class="kd">final</span> <span class="no">K</span> <span class="n">key</span><span class="o">;</span>
        <span class="no">V</span> <span class="n">value</span><span class="o">;</span>
        <span class="nc">Node</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">;</span>
</code></pre></div></div>

<ul>
  <li><strong>LinkedHashMap</strong></li>
  <li>LinkedHashMap çš„æœ¬è´¨æ˜¯ä¸€ä¸ª HashMapï¼Œä½†å…¶å°† Entry å†…éƒ¨ç±»è¿›è¡Œäº†æ‰©å±•ã€‚HashMap ä¸­
çš„ Entry æ˜¯å•å‘çš„ï¼Œåªèƒ½é€šè¿‡ next æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚è€Œ LinkedHashMap ä¸­çš„ Entry å˜ä¸ºäº†åŒå‘çš„ï¼Œå¯ä»¥é€šè¿‡ before æŸ¥æ‰¾ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œé€šè¿‡ after æŸ¥æ‰¾ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å³ä»æ€§èƒ½ä¸Šè¯´ï¼Œ LinkedHashMap çš„æ“ä½œæ€§èƒ½è¦é«˜äº HashMap</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">transient</span> <span class="nc">LinkedHashMap</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">head</span><span class="o">;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">static</span> <span class="kd">class</span> <span class="nc">Entry</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="nc">HashMap</span><span class="o">.</span><span class="na">Node</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="nc">Entry</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">before</span><span class="o">,</span> <span class="n">after</span><span class="o">;</span>
        <span class="nc">Entry</span><span class="o">(</span><span class="kt">int</span> <span class="n">hash</span><span class="o">,</span> <span class="no">K</span> <span class="n">key</span><span class="o">,</span> <span class="no">V</span> <span class="n">value</span><span class="o">,</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="no">K</span><span class="o">,</span><span class="no">V</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">hash</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">next</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>æˆ‘ä»¬åº”è¯¥æŒæ¡çš„æ˜¯ ModelAndView ä¸­çš„æ¨¡å‹å¯¹è±¡æ˜¯ ModelMapï¼Œå…¶æœ¬è´¨æ˜¯ä¸€ä¸ª HashMapï¼Œå‘ ModelMap ä¸­æ·»åŠ æ•°æ®å°±æ˜¯å‘ HashMap ä¸­æ·»åŠ æ•°æ®ã€‚åªä¸è¿‡ï¼Œè¿™ä¸ª ModelMap è¦æ¯” HashMap çš„æ€§èƒ½æ›´é«˜</li>
</ul>

<h4 id="è§†å›¾">è§†å›¾</h4>

<ul>
  <li>é€šè¿‡ setViewName()æŒ‡å®šè§†å›¾åç§°ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„è§†å›¾åç§°å°†ä¼šå¯¹åº”ä¸€ä¸ªè§†å›¾å¯¹è±¡ï¼Œä¸€èˆ¬æ˜¯ä¸ä¼šåœ¨è¿™é‡Œç›´æ¥å†™ä¸Šè¦è·³è½¬çš„é¡µé¢çš„</li>
  <li>è¿™ä¸ªè§†å›¾å¯¹è±¡ï¼Œå°†ä¼šè¢«å°è£…åœ¨ModelAndViewä¸­ï¼Œä¼ ç»™è§†å›¾è§£æå™¨æ¥è§£æï¼Œæœ€ç»ˆè½¬æ¢ä¸ºç›¸åº”çš„é¡µé¢</li>
  <li>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ View å¯¹è±¡æœ¬è´¨ä»…ä»…æ˜¯ä¸€ä¸ª String è€ŒçŸ£ã€‚åç»­çš„æ­¥éª¤ä¸­ï¼Œè¿˜ä¼šç»§ç»­å¯¹è¿™ä¸ª View å¯¹è±¡è¿›è¡Œè¿›ä¸€æ­¥çš„å°è£…</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ModelAndViewç±»ä¸­æœ‰ä¸ªæˆå‘˜å˜é‡ï¼šprivate Object view;</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setViewName</span><span class="o">(</span><span class="nc">String</span> <span class="n">viewName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">view</span> <span class="o">=</span> <span class="n">viewName</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>å½“ç„¶ï¼Œè‹¥å¤„ç†å™¨æ–¹æ³•è¿”å›çš„ ModelAndView ä¸­å¹¶æ²¡æœ‰æ•°æ®è¦æºå¸¦ï¼Œåˆ™å¯ç›´æ¥é€šè¿‡ModelAndView çš„å¸¦å‚æ„é€ å™¨å°†è§†å›¾åç§°æ”¾å…¥ ModelAndView ä¸­</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">ModelAndView</span><span class="o">(</span><span class="nc">String</span> <span class="n">viewName</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">view</span> <span class="o">=</span> <span class="n">viewName</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></div></div>

<h3 id="è§†å›¾è§£æå™¨">è§†å›¾è§£æå™¨</h3>

<ul>
  <li>è§†å›¾è§£æå™¨ ViewResolver æ¥å£è´Ÿè´£å°†å¤„ç†ç»“æœç”Ÿæˆ View è§†å›¾ã€‚å¸¸ç”¨çš„å®ç°ç±»æœ‰å››ç§ï¼š</li>
</ul>

<h4 id="internalresourceviewresolver">InternalResourceViewResolver</h4>

<ul>
  <li>è¯¥è§†å›¾è§£æå™¨ç”¨äºå®Œæˆå¯¹å½“å‰ Web åº”ç”¨å†…éƒ¨èµ„æºçš„å°è£…ä¸è·³è½¬</li>
  <li>å¯¹äºå†…éƒ¨èµ„æºçš„æŸ¥æ‰¾è§„åˆ™æ˜¯ï¼Œå°† ModelAndView ä¸­æŒ‡å®šçš„è§†å›¾åç§°ä¸ä¸ºè§†å›¾è§£æå™¨é…ç½®çš„å‰è¾ä¸åè¾ç›¸ç»“åˆçš„æ–¹å¼ï¼Œæ‹¼æ¥æˆä¸€ä¸ª Web åº”ç”¨å†…éƒ¨èµ„æºè·¯å¾„</li>
  <li>æ¥è§„åˆ™æ˜¯ï¼š å‰è¾ + è§†å›¾åç§° + åè¾</li>
  <li>InternalResourceView è§£æå™¨ä¼šæŠŠå¤„ç†å™¨æ–¹æ³•è¿”å›çš„æ¨¡å‹å±æ€§éƒ½å­˜æ”¾åˆ°å¯¹åº”çš„ request ä¸­ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘åˆ°ç›®æ ‡ URL</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"method"</span><span class="o">,</span><span class="s">"doSecond()"</span><span class="o">);</span>
<span class="c1">//å‘ModelAndViewå¯¹è±¡ä¸­æ·»åŠ viewï¼Œå³è¦è·³è½¬çš„é¡µé¢</span>
<span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"show"</span><span class="o">);</span>

<span class="c1">//è¿™æ ·å†™éœ€è¦é…ç½®è§†å›¾è§£æå™¨</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//å¦‚æœä¸é…ç½®è§†å›¾è§£æå™¨ä¹Ÿå¯ä»¥è¿™æ ·å†™</span>
<span class="n">mv</span><span class="o">.</span><span class="na">addObject</span><span class="o">(</span><span class="s">"method"</span><span class="o">,</span><span class="s">"doSecond()"</span><span class="o">);</span>
<span class="c1">//å‘ModelAndViewå¯¹è±¡ä¸­æ·»åŠ viewï¼Œå³è¦è·³è½¬çš„é¡µé¢</span>
<span class="n">mv</span><span class="o">.</span><span class="na">setViewName</span><span class="o">(</span><span class="s">"/WEB-INF/admin/show.jsp"</span><span class="o">);</span>
</code></pre></div></div>

<h4 id="beannameviewresolver">BeanNameViewResolver</h4>

<ul>
  <li>InternalResourceViewResolver è§£æå™¨å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œä½¿å…¶ä½¿ç”¨å¾ˆä¸çµæ´»ï¼š</li>
  <li>åªå¯ä»¥å®Œæˆå°†å†…éƒ¨èµ„æºå°è£…åçš„è·³è½¬ã€‚ä½†æ— æ³•è½¬å‘å¤–éƒ¨èµ„æºï¼Œå¦‚å¤–éƒ¨ç½‘é¡µ</li>
  <li>å¯¹äºå†…éƒ¨èµ„æºçš„å®šä¹‰ï¼Œä¹Ÿåªèƒ½å®šä¹‰ä¸€ç§æ ¼å¼çš„èµ„æºï¼šå­˜æ”¾äºåŒä¸€ç›®å½•çš„åŒä¸€æ–‡ä»¶ç±»å‹çš„èµ„æºæ–‡ä»¶</li>
  <li>BeanNameViewResolver è§†å›¾è§£æå™¨ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å°†èµ„æºå°è£…ä¸ºâ€œSpring å®¹å™¨ä¸­æ³¨å†Œçš„Bean å®ä¾‹â€ï¼ŒModelAndView é€šè¿‡è®¾ç½®è§†å›¾åç§°ä¸ºè¯¥ Bean çš„ id å±æ€§å€¼æ¥å®Œæˆå¯¹è¯¥èµ„æºçš„è®¿é—®ã€‚æ‰€ä»¥åœ¨ springmvc.xml ä¸­ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ª View è§†å›¾ Beanï¼Œè®©å¤„ç†å™¨ä¸­ ModelAndView é€šè¿‡å¯¹è¿™äº› Bean çš„ id çš„å¼•ç”¨æ¥å®Œæˆå‘ View ä¸­å°è£…èµ„æºçš„è·³è½¬</li>
</ul>

<h4 id="xmlviewresolver">XmlViewResolver</h4>

<ul>
  <li>å½“éœ€è¦å®šä¹‰çš„ View è§†å›¾å¯¹è±¡å¾ˆå¤šæ—¶ï¼Œå°±ä¼šä½¿ springmvc.xml æ–‡ä»¶å˜å¾—å¾ˆå¤§ï¼Œå¾ˆè‡ƒè‚¿ï¼Œä¸ä¾¿äºç®¡ç†ã€‚æ‰€ä»¥å¯ä»¥å°†è¿™äº› View è§†å›¾å¯¹è±¡ä¸“é—¨æŠ½å–å‡ºæ¥ï¼Œå•ç‹¬å®šä¹‰ä¸ºä¸€ä¸ª xml æ–‡ä»¶ã€‚è¿™æ—¶å°±éœ€è¦ä½¿ç”¨ XmlViewResolver è§£æå™¨äº†</li>
</ul>

<h4 id="resourcebundleviewresolver">ResourceBundleViewResolver</h4>

<ul>
  <li>å¯¹äº View è§†å›¾å¯¹è±¡çš„æ³¨å†Œï¼Œé™¤äº†ä½¿ç”¨ xml æ–‡ä»¶å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ properties æ–‡ä»¶ä¸­è¿›è¡Œæ³¨å†Œã€‚åªä¸è¿‡ï¼Œæ­¤æ—¶çš„è§†å›¾è§£æå™¨éœ€è¦æ›´æ¢ä¸º ResourceBundleViewResolver è§£æå™¨ã€‚</li>
</ul>

<h4 id="ä¼˜å…ˆçº§">ä¼˜å…ˆçº§</h4>

<ul>
  <li>æœ‰æ—¶ç»å¸¸éœ€è¦åº”ç”¨ä¸€äº›è§†å›¾è§£æå™¨ç­–ç•¥æ¥è§£æè§†å›¾åç§°ï¼Œå³å½“åŒæ—¶å­˜åœ¨å¤šä¸ªè§†å›¾è§£æå™¨å‡å¯è§£æModelAndView ä¸­çš„åŒä¸€è§†å›¾åç§°æ—¶ï¼Œå“ªä¸ªè§†å›¾è§£æå™¨ä¼šèµ·ä½œç”¨å‘¢ï¼Ÿ</li>
  <li>è§†å›¾è§£æå™¨æœ‰ä¸€ä¸ª <strong>order å±æ€§</strong>ï¼Œä¸“é—¨ç”¨äºè®¾ç½®å¤šä¸ªè§†å›¾è§£æå™¨çš„ä¼˜å…ˆçº§ã€‚<strong>æ•°å­—è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚æ•°å­—ç›¸åŒï¼Œå…ˆæ³¨å†Œçš„ä¼˜å…ˆçº§é«˜</strong>ã€‚ä¸€èˆ¬ä¸ä¸º InternalResourceViewResolver è§£æå™¨æŒ‡å®šä¼˜å…ˆçº§ï¼Œå³è®©å…¶ä¼˜å…ˆçº§æ˜¯æœ€ä½çš„ã€‚</li>
</ul>
:ET