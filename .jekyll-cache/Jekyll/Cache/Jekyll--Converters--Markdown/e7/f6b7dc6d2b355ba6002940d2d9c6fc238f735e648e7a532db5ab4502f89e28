I"†<ul id="markdown-toc">
  <li><a href="#ä½¿ç”¨beanæŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•" id="markdown-toc-ä½¿ç”¨beanæŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•">ä½¿ç”¨@BeanæŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•</a>    <ul>
      <li><a href="#å•å®ä¾‹" id="markdown-toc-å•å®ä¾‹">å•å®ä¾‹</a></li>
      <li><a href="#å¤šå®ä¾‹" id="markdown-toc-å¤šå®ä¾‹">å¤šå®ä¾‹</a></li>
    </ul>
  </li>
  <li><a href="#initializingbeanæ¥å£" id="markdown-toc-initializingbeanæ¥å£">InitializingBeanæ¥å£</a></li>
  <li><a href="#disposablebeanæ¥å£" id="markdown-toc-disposablebeanæ¥å£">DisposableBeanæ¥å£</a>    <ul>
      <li><a href="#ä½¿ç”¨" id="markdown-toc-ä½¿ç”¨">ä½¿ç”¨</a></li>
    </ul>
  </li>
  <li><a href="#postconstruct" id="markdown-toc-postconstruct">@PostConstruct</a></li>
  <li><a href="#predestroy" id="markdown-toc-predestroy">@PreDestroy</a>    <ul>
      <li><a href="#ä½¿ç”¨-1" id="markdown-toc-ä½¿ç”¨-1">ä½¿ç”¨</a></li>
    </ul>
  </li>
  <li><a href="#beanpostprocessoræ¥å£" id="markdown-toc-beanpostprocessoræ¥å£">BeanPostProcessoræ¥å£</a>    <ul>
      <li><a href="#ä½¿ç”¨-2" id="markdown-toc-ä½¿ç”¨-2">ä½¿ç”¨</a></li>
      <li><a href="#åŸç†" id="markdown-toc-åŸç†">åŸç†</a></li>
      <li><a href="#åº•å±‚" id="markdown-toc-åº•å±‚">åº•å±‚</a></li>
      <li><a href="#è·å–iocå®¹å™¨" id="markdown-toc-è·å–iocå®¹å™¨">è·å–IOCå®¹å™¨</a></li>
      <li><a href="#æ•°æ®æ ¡éªŒ" id="markdown-toc-æ•°æ®æ ¡éªŒ">æ•°æ®æ ¡éªŒ</a></li>
    </ul>
  </li>
</ul>
<h3 id="ä½¿ç”¨beanæŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•">ä½¿ç”¨@BeanæŒ‡å®šåˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•</h3>

<ul>
  <li>ä½¿ç”¨@BeanæŒ‡å®šå®ä¾‹çš„åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•</li>
</ul>

<h4 id="å•å®ä¾‹">å•å®ä¾‹</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Car</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Car</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"car constructor..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"car...init..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"car...destroy..."</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * beançš„ç”Ÿå‘½å‘¨æœŸï¼šbeançš„åˆ›å»º-&gt;åˆå§‹åŒ–-&gt;é”€æ¯çš„è¿‡ç¨‹
 * å®¹å™¨ç®¡ç†beançš„ç”Ÿå‘½å‘¨æœŸï¼š
 * æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯çš„æ–¹æ³•ï¼šå®¹å™¨åœ¨beanè¿›è¡Œåˆ°å½“å‰çš„ç”Ÿå‘½å‘¨æœŸçš„æ—¶å€™ï¼Œæ¥è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•
 * æ„é€ ï¼ˆå¯¹è±¡åˆ›å»ºï¼‰ï¼š
 *      å•å®ä¾‹ï¼šåœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºå¯¹è±¡
 *      å¤šå®ä¾‹ï¼šåœ¨æ¯æ¬¡è·å–çš„æ—¶å€™æ¥åˆ›å»ºå¯¹è±¡
 * åˆå§‹åŒ–æ–¹æ³•ï¼š
 *      å¯¹è±¡åˆ›å»ºå®Œæˆï¼Œå¹¶èµ‹å€¼å¥½ï¼Œè°ƒç”¨åˆå§‹åŒ–æ–¹æ³•
 * é”€æ¯æ–¹æ³•ï¼š
 *      å•å®ä¾‹çš„bean:åœ¨å®¹å™¨å…³é—­çš„æ—¶å€™è¿›è¡Œé”€æ¯
 *      å¤šå®ä¾‹çš„bean:å®¹å™¨ä¸ä¼šç®¡ç†è¿™ä¸ªbean,å®¹å™¨ä¸ä¼šè°ƒç”¨é”€æ¯çš„æ–¹æ³•
 *
 * 1)æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•ï¼›
 *          -æˆ‘ä»¬å¯ä»¥é€šè¿‡@Bean(initMethod = "init",destroyMethod = "destroy")æ¥æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•
 *          ç›¸å½“äºxmlé…ç½®æ–‡ä»¶beanæ ‡ç­¾é‡Œé¢çš„ init-method="" å’Œ destroy-method="" å±æ€§
 *
 *
 *
 */</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfigOfLifeCycle</span> <span class="o">{</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">initMethod</span> <span class="o">=</span> <span class="s">"init"</span><span class="o">,</span><span class="n">destroyMethod</span> <span class="o">=</span> <span class="s">"destroy"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Car</span> <span class="nf">car</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Car</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//1.åˆ›å»ºIOCå®¹å™¨</span>
        <span class="nc">AnnotationConfigApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfigOfLifeCycle</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å®¹å™¨åˆ›å»ºå®Œæˆ"</span><span class="o">);</span>
        <span class="n">applicationContext</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">car</span> <span class="err">constructorâ€¦</span>
<span class="err">carâ€¦initâ€¦</span>
<span class="err">å®¹å™¨åˆ›å»ºå®Œæˆ</span>
<span class="err">carâ€¦destroyâ€¦</span>
</code></pre></div></div>

<h4 id="å¤šå®ä¾‹">å¤šå®ä¾‹</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfigOfLifeCycle</span> <span class="o">{</span>

    <span class="nd">@Scope</span><span class="o">(</span><span class="s">"prototype"</span><span class="o">)</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="n">initMethod</span> <span class="o">=</span> <span class="s">"init"</span><span class="o">,</span><span class="n">destroyMethod</span> <span class="o">=</span> <span class="s">"destroy"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Car</span> <span class="nf">car</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Car</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">å®¹å™¨åˆ›å»ºå®Œæˆ</span>

<span class="err">å½“beançš„ä½œç”¨åŸŸä¸ºå¤šä¾‹çš„æ—¶å€™ï¼Œåªæœ‰åœ¨è·å–çš„æ—¶å€™ï¼Œæ‰ä¼šåˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸”åœ¨IOCå®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œæ˜¯ä¸è¿›è¡Œé”€æ¯çš„</span>
</code></pre></div></div>

<h3 id="initializingbeanæ¥å£">InitializingBeanæ¥å£</h3>

<ul>
  <li>InitializingBeanæ¥å£ï¼šåœ¨BeanFactoryè®¾ç½®å®Œbeançš„å±æ€§å€¼ä¹‹åè¿›è¡Œè°ƒç”¨ï¼Œç›¸å½“äºåˆå§‹åŒ–æ–¹æ³•</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">InitializingBean</span> <span class="o">{</span>

	<span class="cm">/**
	 * Invoked by a BeanFactory after it has set all bean properties supplied
	 * (and satisfied BeanFactoryAware and ApplicationContextAware).
	 * &lt;p&gt;This method allows the bean instance to perform initialization only
	 * possible when all bean properties have been set and to throw an
	 * exception in the event of misconfiguration.
	 * @throws Exception in the event of misconfiguration (such
	 * as failure to set an essential property) or if initialization fails.
	 */</span>
	<span class="kt">void</span> <span class="nf">afterPropertiesSet</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>

<span class="o">}</span>

</code></pre></div></div>

<h3 id="disposablebeanæ¥å£">DisposableBeanæ¥å£</h3>

<ul>
  <li>DisposableBeanæ¥å£ï¼šç”±beanå·¥å‚åœ¨é”€æ¯å•ä¾‹æ—¶è°ƒç”¨</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DisposableBean</span> <span class="o">{</span>

	<span class="cm">/**
	 * Invoked by a BeanFactory on destruction of a singleton.
	 * @throws Exception in case of shutdown errors.
	 * Exceptions will get logged but not rethrown to allow
	 * other beans to release their resources too.
	 */</span>
	<span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>

<span class="o">}</span>

</code></pre></div></div>

<h4 id="ä½¿ç”¨">ä½¿ç”¨</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Cat</span> <span class="kd">implements</span> <span class="nc">InitializingBean</span><span class="o">,</span> <span class="nc">DisposableBean</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Cat</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Cat...Contrustor..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Cat...destroy..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterPropertiesSet</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Cat...afterPropertiesSet..."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>ä½¿ç”¨åŒ…æ‰«æçš„æ–¹å¼è¿›è¡Œè£…é…</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * beançš„ç”Ÿå‘½å‘¨æœŸï¼šbeançš„åˆ›å»º-&gt;åˆå§‹åŒ–-&gt;é”€æ¯çš„è¿‡ç¨‹
 * å®¹å™¨ç®¡ç†beançš„ç”Ÿå‘½å‘¨æœŸï¼š
 * æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯çš„æ–¹æ³•ï¼šå®¹å™¨åœ¨beanè¿›è¡Œåˆ°å½“å‰çš„ç”Ÿå‘½å‘¨æœŸçš„æ—¶å€™ï¼Œæ¥è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•
 * æ„é€ ï¼ˆå¯¹è±¡åˆ›å»ºï¼‰ï¼š
 *      å•å®ä¾‹ï¼šåœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºå¯¹è±¡
 *      å¤šå®ä¾‹ï¼šåœ¨æ¯æ¬¡è·å–çš„æ—¶å€™æ¥åˆ›å»ºå¯¹è±¡
 * åˆå§‹åŒ–æ–¹æ³•ï¼š
 *      å¯¹è±¡åˆ›å»ºå®Œæˆï¼Œå¹¶èµ‹å€¼å¥½ï¼Œè°ƒç”¨åˆå§‹åŒ–æ–¹æ³•
 * é”€æ¯æ–¹æ³•ï¼š
 *      å•å®ä¾‹çš„bean:åœ¨å®¹å™¨å…³é—­çš„æ—¶å€™è¿›è¡Œé”€æ¯
 *      å¤šå®ä¾‹çš„bean:å®¹å™¨ä¸ä¼šç®¡ç†è¿™ä¸ªbean,å®¹å™¨ä¸ä¼šè°ƒç”¨é”€æ¯çš„æ–¹æ³•
 *
 * 1)æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•ï¼›
 *          -æˆ‘ä»¬å¯ä»¥é€šè¿‡@Bean(initMethod = "init",destroyMethod = "destroy")æ¥æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å’Œé”€æ¯æ–¹æ³•
 *          ç›¸å½“äºxmlé…ç½®æ–‡ä»¶beanæ ‡ç­¾é‡Œé¢çš„ init-method="" å’Œ destroy-method="" å±æ€§
 * 2)é€šè¿‡beanå®ç°InitializingBeanï¼ˆå®šä¹‰åˆå§‹åŒ–é€»è¾‘ï¼‰
 *               DisposableBeanï¼ˆå®šä¹‰é”€æ¯é€»è¾‘ï¼‰ï¼›
 *
 *
 */</span>
<span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">"com.ldc.bean"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfigOfLifeCycle</span> <span class="o">{</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="n">initMethod</span> <span class="o">=</span> <span class="s">"init"</span><span class="o">,</span><span class="n">destroyMethod</span> <span class="o">=</span> <span class="s">"destroy"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Car</span> <span class="nf">car</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Car</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//1.åˆ›å»ºIOCå®¹å™¨</span>
        <span class="nc">AnnotationConfigApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfigOfLifeCycle</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å®¹å™¨åˆ›å»ºå®Œæˆ"</span><span class="o">);</span>
        <span class="n">applicationContext</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Catâ€¦Contrustorâ€¦</span>
<span class="err">Catâ€¦afterPropertiesSetâ€¦</span>
<span class="err">car</span> <span class="err">constructorâ€¦</span>
<span class="err">carâ€¦initâ€¦</span>
<span class="err">å®¹å™¨åˆ›å»ºå®Œæˆ</span>
<span class="err">carâ€¦destroyâ€¦</span>
<span class="err">Catâ€¦destroyâ€¦</span>
</code></pre></div></div>

<h3 id="postconstruct">@PostConstruct</h3>

<h3 id="predestroy">@PreDestroy</h3>

<ul>
  <li>å¯ä»¥ä½¿ç”¨JSR250è§„èŒƒé‡Œé¢å®šä¹‰çš„ä¸¤ä¸ªæ³¨è§£ï¼š</li>
  <li>@PostConstruct :åœ¨beanåˆ›å»ºå®Œæˆå¹¶ä¸”å±æ€§èµ‹å€¼å®Œæˆï¼Œæ¥æ‰§è¡Œåˆå§‹åŒ–æ–¹æ³•</li>
  <li>@PreDestroy ï¼šåœ¨å®¹å™¨é”€æ¯beanä¹‹å‰é€šçŸ¥æˆ‘ä»¬æ¥è¿›è¡Œæ¸…ç†å·¥ä½œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Documented</span>
<span class="nd">@Retention</span> <span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">(</span><span class="no">METHOD</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">PostConstruct</span> <span class="o">{</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Documented</span>
<span class="nd">@Retention</span> <span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="nd">@Target</span><span class="o">(</span><span class="no">METHOD</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">PreDestroy</span> <span class="o">{</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="ä½¿ç”¨-1">ä½¿ç”¨</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...Contructor..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//åœ¨å¯¹è±¡åˆ›å»ºå¹¶èµ‹å€¼ä¹‹åè°ƒç”¨</span>
    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...@PostConstruct..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//åœ¨å®¹å™¨é”€æ¯å¯¹è±¡ä¹‹å‰è°ƒç”¨</span>
    <span class="nd">@PreDestroy</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...@PreDestroy..."</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//1.åˆ›å»ºIOCå®¹å™¨</span>
        <span class="nc">AnnotationConfigApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfigOfLifeCycle</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å®¹å™¨åˆ›å»ºå®Œæˆ"</span><span class="o">);</span>
        <span class="n">applicationContext</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-properties highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">Catâ€¦Contrustorâ€¦</span>
<span class="err">Catâ€¦afterPropertiesSetâ€¦</span>
<span class="err">Dogâ€¦Contructorâ€¦</span>
<span class="err">Dogâ€¦@PostConstructâ€¦</span>
<span class="err">car</span> <span class="err">constructorâ€¦</span>
<span class="err">carâ€¦initâ€¦</span>
<span class="err">å®¹å™¨åˆ›å»ºå®Œæˆ</span>
<span class="err">carâ€¦destroyâ€¦</span>
<span class="err">Dogâ€¦@PreDestroyâ€¦</span>
<span class="err">Catâ€¦destroyâ€¦</span>
</code></pre></div></div>

<h3 id="beanpostprocessoræ¥å£">BeanPostProcessoræ¥å£</h3>

<ul>
  <li>BeanPostProcessoræ¥å£ï¼šbeançš„åç½®å¤„ç†å™¨ï¼Œåœ¨beanåˆå§‹åŒ–å‰ååšä¸€äº›å¤„ç†å·¥ä½œï¼Œè¿™ä¸ªæ¥å£æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</li>
  <li>postProcessBeforeInitializationï¼šåœ¨åˆå§‹åŒ–ä¹‹å‰å·¥ä½œ</li>
  <li>postProcessAfterInitializationï¼šåœ¨åˆå§‹åŒ–ä¹‹åå·¥ä½œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BeanPostProcessor</span> <span class="o">{</span>

	<span class="cm">/**
	 * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;before&lt;/i&gt; any bean
	 * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}
	 * or a custom init-method). The bean will already be populated with property values.
	 * The returned bean instance may be a wrapper around the original.
	 * @param bean the new bean instance
	 * @param beanName the name of the bean
	 * @return the bean instance to use, either the original or a wrapped one;
	 * if {@code null}, no subsequent BeanPostProcessors will be invoked
	 * @throws org.springframework.beans.BeansException in case of errors
	 * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet
	 */</span>
	<span class="nc">Object</span> <span class="nf">postProcessBeforeInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span><span class="o">;</span>

	<span class="cm">/**
	 * Apply this BeanPostProcessor to the given new bean instance &lt;i&gt;after&lt;/i&gt; any bean
	 * initialization callbacks (like InitializingBean's {@code afterPropertiesSet}
	 * or a custom init-method). The bean will already be populated with property values.
	 * The returned bean instance may be a wrapper around the original.
	 * &lt;p&gt;In case of a FactoryBean, this callback will be invoked for both the FactoryBean
	 * instance and the objects created by the FactoryBean (as of Spring 2.0). The
	 * post-processor can decide whether to apply to either the FactoryBean or created
	 * objects or both through corresponding {@code bean instanceof FactoryBean} checks.
	 * &lt;p&gt;This callback will also be invoked after a short-circuiting triggered by a
	 * {@link InstantiationAwareBeanPostProcessor#postProcessBeforeInstantiation} method,
	 * in contrast to all other BeanPostProcessor callbacks.
	 * @param bean the new bean instance
	 * @param beanName the name of the bean
	 * @return the bean instance to use, either the original or a wrapped one;
	 * if {@code null}, no subsequent BeanPostProcessors will be invoked
	 * @throws org.springframework.beans.BeansException in case of errors
	 * @see org.springframework.beans.factory.InitializingBean#afterPropertiesSet
	 * @see org.springframework.beans.factory.FactoryBean
	 */</span>
	<span class="nc">Object</span> <span class="nf">postProcessAfterInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span><span class="o">;</span>

<span class="o">}</span>

</code></pre></div></div>

<h4 id="ä½¿ç”¨-2">ä½¿ç”¨</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBeanPostProcessor</span> <span class="kd">implements</span> <span class="nc">BeanPostProcessor</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">postProcessBeforeInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"postProcessBeforeInitialization..."</span><span class="o">+</span><span class="n">beanName</span><span class="o">+</span><span class="s">"=&gt;"</span><span class="o">+</span><span class="n">bean</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">postProcessAfterInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">bean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"postProcessAfterInitialization..."</span><span class="o">+</span><span class="n">beanName</span><span class="o">+</span><span class="s">"=&gt;"</span><span class="o">+</span><span class="n">bean</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">bean</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test01</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">//1.åˆ›å»ºIOCå®¹å™¨</span>
        <span class="nc">AnnotationConfigApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfigOfLifeCycle</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"å®¹å™¨åˆ›å»ºå®Œæˆ"</span><span class="o">);</span>
        <span class="n">applicationContext</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>postProcessBeforeInitializationâ€¦org.springframework.context.event.internalEventListenerProcessor=&gt;org.springframework.context.event.EventListenerMethodProcessor@36f0f1be
postProcessAfterInitializationâ€¦org.springframework.context.event.internalEventListenerProcessor=&gt;org.springframework.context.event.EventListenerMethodProcessor@36f0f1be

postProcessBeforeInitializationâ€¦org.springframework.context.event.internalEventListenerFactory=&gt;org.springframework.context.event.DefaultEventListenerFactory@6ee12bac
postProcessAfterInitializationâ€¦org.springframework.context.event.internalEventListenerFactory=&gt;org.springframework.context.event.DefaultEventListenerFactory@6ee12bac

postProcessBeforeInitializationâ€¦mainConfigOfLifeCycle=&gt;com.ldc.config.MainConfigOfLifeCycleEnhancerBySpringCGLIBEnhancerBySpringCGLIB27d6c7d3@64c87930
postProcessAfterInitializationâ€¦mainConfigOfLifeCycle=&gt;com.ldc.config.MainConfigOfLifeCycleEnhancerBySpringCGLIBEnhancerBySpringCGLIB27d6c7d3@64c87930

Catâ€¦Contrustorâ€¦
postProcessBeforeInitializationâ€¦cat=&gt;com.ldc.bean.Cat@525f1e4e
Catâ€¦afterPropertiesSetâ€¦
postProcessAfterInitializationâ€¦cat=&gt;com.ldc.bean.Cat@525f1e4e

Dogâ€¦Contructorâ€¦
postProcessBeforeInitializationâ€¦dog=&gt;com.ldc.bean.Dog@5ea434c8
Dogâ€¦@PostConstructâ€¦
postProcessAfterInitializationâ€¦dog=&gt;com.ldc.bean.Dog@5ea434c8

car constructorâ€¦
postProcessBeforeInitializationâ€¦car=&gt;com.ldc.bean.Car@1d548a08
carâ€¦initâ€¦
postProcessAfterInitializationâ€¦car=&gt;com.ldc.bean.Car@1d548a08

å®¹å™¨åˆ›å»ºå®Œæˆ
carâ€¦destroyâ€¦
Dogâ€¦@PreDestroyâ€¦
Catâ€¦destroyâ€¦

</code></pre></div></div>

<h4 id="åŸç†">åŸç†</h4>

<ul>
  <li>å‰ç½®å¤„ç†å™¨è°ƒç”¨çš„æ–¹æ³•ï¼šè°ƒç”¨getBeanPostProcessors()æ–¹æ³•æ‰¾åˆ°å®¹å™¨é‡Œé¢çš„æ‰€æœ‰çš„BeanPostProcessorï¼ŒæŒ¨ä¸ªéå†ï¼Œè°ƒç”¨BeanPostProcessorçš„postProcessBeforeInitializationæ–¹æ³•ï¼Œä¸€æ—¦è°ƒç”¨postProcessBeforeInitializationæ–¹æ³•çš„è¿”å›å€¼ä¸ºnullçš„æ—¶å€™ï¼Œå°±ç›´æ¥è·³å‡ºéå† ï¼Œåé¢çš„BeanPostProcessor çš„postProcessBeforeInitializationä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">applyBeanPostProcessorsBeforeInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">existingBean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">BeansException</span> <span class="o">{</span>

		<span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">existingBean</span><span class="o">;</span>
		<span class="k">for</span> <span class="o">(</span><span class="nc">BeanPostProcessor</span> <span class="n">beanProcessor</span> <span class="o">:</span> <span class="n">getBeanPostProcessors</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">beanProcessor</span><span class="o">.</span><span class="na">postProcessBeforeInitialization</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">beanName</span><span class="o">);</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>åç½®å¤„ç†å™¨è°ƒç”¨çš„æ–¹æ³•ï¼šè°ƒç”¨getBeanPostProcessors()æ–¹æ³•æ‰¾åˆ°å®¹å™¨é‡Œé¢çš„æ‰€æœ‰çš„BeanPostProcessorï¼ŒæŒ¨ä¸ªéå†ï¼Œè°ƒç”¨BeanPostProcessorçš„postProcessAfterInitializationæ–¹æ³•ï¼Œä¸€æ—¦è°ƒç”¨postProcessAfterInitializationæ–¹æ³•çš„è¿”å›å€¼ä¸ºnullçš„æ—¶å€™ï¼Œå°±ç›´æ¥è·³å‡ºéå† ï¼Œåé¢çš„BeanPostProcessor çš„postProcessAfterInitializationä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="nc">Object</span> <span class="nf">applyBeanPostProcessorsAfterInitialization</span><span class="o">(</span><span class="nc">Object</span> <span class="n">existingBean</span><span class="o">,</span> <span class="nc">String</span> <span class="n">beanName</span><span class="o">)</span><span class="kd">throws</span> <span class="nc">BeansException</span> <span class="o">{</span>

		<span class="nc">Object</span> <span class="n">result</span> <span class="o">=</span> <span class="n">existingBean</span><span class="o">;</span>
		<span class="k">for</span> <span class="o">(</span><span class="nc">BeanPostProcessor</span> <span class="n">beanProcessor</span> <span class="o">:</span> <span class="n">getBeanPostProcessors</span><span class="o">())</span> <span class="o">{</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">beanProcessor</span><span class="o">.</span><span class="na">postProcessAfterInitialization</span><span class="o">(</span><span class="n">result</span><span class="o">,</span> <span class="n">beanName</span><span class="o">);</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
				<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
			<span class="o">}</span>
		<span class="o">}</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">;</span>
	<span class="o">}</span>

</code></pre></div></div>

<h4 id="åº•å±‚">åº•å±‚</h4>

<ul>
  <li>Springåº•å±‚å¯¹ BeanPostProcessor çš„ä½¿ç”¨ï¼š</li>
  <li>beanèµ‹å€¼ï¼Œæ³¨å…¥å…¶ä»–ç»„ä»¶ï¼Œ<code class="language-plaintext highlighter-rouge">@Autowired</code>,ç”Ÿå‘½å‘¨æœŸæ³¨è§£ç­‰åŠŸèƒ½,<code class="language-plaintext highlighter-rouge">@Async</code>ç­‰ç­‰éƒ½æ˜¯ä½¿ç”¨<code class="language-plaintext highlighter-rouge">BeanPostProcessor</code>æ¥å®Œæˆçš„</li>
</ul>

<h4 id="è·å–iocå®¹å™¨">è·å–IOCå®¹å™¨</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Dog</span> <span class="kd">implements</span> <span class="nc">ApplicationContextAware</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Dog</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...Contructor..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//åœ¨å¯¹è±¡åˆ›å»ºå¹¶èµ‹å€¼ä¹‹åè°ƒç”¨</span>
    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...@PostConstruct..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//åœ¨å¯¹è±¡é”€æ¯ä¹‹å‰è°ƒç”¨</span>
    <span class="nd">@PreDestroy</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Dog...@PreDestroy..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setApplicationContext</span><span class="o">(</span><span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">BeansException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">applicationContext</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ•°æ®æ ¡éªŒ">æ•°æ®æ ¡éªŒ</h4>

<ul>
  <li>å®é™…ä¸ŠBeanPostProcessoræ¥å£è¿˜æœ‰å¾ˆå¤šçš„å®ç°ç±»ï¼Œæ¯”å¦‚è¯´BeanValidationPostProcessorï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥åšæ•°æ®æ ¡éªŒçš„</li>
</ul>
:ET