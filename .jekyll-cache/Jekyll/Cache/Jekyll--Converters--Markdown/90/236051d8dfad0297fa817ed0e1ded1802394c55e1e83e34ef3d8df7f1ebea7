I"¢÷<ul id="markdown-toc">
  <li><a href="#æ‡’åŠ è½½" id="markdown-toc-æ‡’åŠ è½½">æ‡’åŠ è½½</a></li>
  <li><a href="#æ¡ä»¶æ³¨å†Œ" id="markdown-toc-æ¡ä»¶æ³¨å†Œ">æ¡ä»¶æ³¨å†Œ</a>    <ul>
      <li><a href="#æ¡ä»¶" id="markdown-toc-æ¡ä»¶">æ¡ä»¶</a></li>
      <li><a href="#æ ‡æ³¨ç±»ä¸Š" id="markdown-toc-æ ‡æ³¨ç±»ä¸Š">æ ‡æ³¨ç±»ä¸Š</a></li>
    </ul>
  </li>
  <li><a href="#import" id="markdown-toc-import">@import</a>    <ul>
      <li><a href="#æ–¹æ³•1" id="markdown-toc-æ–¹æ³•1">æ–¹æ³•1</a></li>
      <li><a href="#æ–¹æ³•2" id="markdown-toc-æ–¹æ³•2">æ–¹æ³•2</a></li>
      <li><a href="#æ–¹æ³•3" id="markdown-toc-æ–¹æ³•3">æ–¹æ³•3</a></li>
    </ul>
  </li>
  <li><a href="#factorybean" id="markdown-toc-factorybean">FactoryBean</a>    <ul>
      <li><a href="#æ³¨å†Œå·¥å‚æœ¬èº«" id="markdown-toc-æ³¨å†Œå·¥å‚æœ¬èº«">æ³¨å†Œå·¥å‚æœ¬èº«</a></li>
    </ul>
  </li>
</ul>
<h3 id="æ‡’åŠ è½½">æ‡’åŠ è½½</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Lazy-bean</code>æ‡’åŠ è½½</li>
  <li>æ‡’åŠ è½½ï¼šæ˜¯ä¸“é—¨é’ˆå¯¹äºå•å®ä¾‹çš„beançš„</li>
  <li>å•å®ä¾‹çš„beanï¼šé»˜è®¤æ˜¯åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºå¯¹è±¡ï¼›</li>
  <li>æ‡’åŠ è½½ï¼šå®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¸åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼ˆè·å–ï¼‰Beançš„æ—¶å€™æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶è¿›è¡Œåˆå§‹åŒ–</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * æ‡’åŠ è½½ï¼šæ˜¯ä¸“é—¨é’ˆå¯¹äºå•å®ä¾‹çš„beançš„
     *       1.å•å®ä¾‹çš„beanï¼šé»˜è®¤æ˜¯åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºå¯¹è±¡ï¼›
     *       2.æ‡’åŠ è½½ï¼šå®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¸åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼ˆè·å–ï¼‰Beançš„æ—¶å€™æ¥åˆ›å»ºå¯¹è±¡ï¼Œå¹¶è¿›è¡Œåˆå§‹åŒ–
     * @return
     */</span>
    <span class="nd">@Lazy</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"person"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ç»™IOCå®¹å™¨ä¸­æ·»åŠ Person..."</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfig2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"IOCå®¹å™¨åˆ›å»ºå®Œæˆ..."</span><span class="o">);</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IOCå®¹å™¨åˆ›å»ºå®Œæˆâ€¦

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåªæœ‰IOCå®¹å™¨å¯åŠ¨äº†ï¼Œè€Œä½œç”¨åŸŸä¸ºå•ä¾‹çš„beanå¹¶æ²¡æœ‰è¢«åˆ›å»ºï¼›
</code></pre></div></div>

<ul>
  <li>è€Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è·å–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è¿è¡Œç»“æœï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test02</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfig2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"IOCå®¹å™¨åˆ›å»ºå®Œæˆ..."</span><span class="o">);</span>
        <span class="nc">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Person</span><span class="o">)</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"person"</span><span class="o">);</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>IOCå®¹å™¨åˆ›å»ºå®Œæˆâ€¦
ç»™IOCå®¹å™¨ä¸­æ·»åŠ Personâ€¦

ä»è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬è°ƒç”¨äº†getBean()æ–¹æ³•è·å–çš„æ—¶å€™ï¼Œbeançš„å®ä¾‹å¯¹è±¡æ‰ä¼šè¢«åˆ›å»ºï¼›è€Œä¸”åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼›ä½œç”¨åŸŸè¿˜æ˜¯å•å®ä¾‹çš„ï¼
</code></pre></div></div>

<h3 id="æ¡ä»¶æ³¨å†Œ">æ¡ä»¶æ³¨å†Œ</h3>

<ul>
  <li>@Conditionalï¼šæŒ‰ç…§æ¡ä»¶æ³¨å†Œbean</li>
  <li>ç°åœ¨æœ‰ä¸¤ä¸ªbeanï¼š bill å’Œ linus ï¼Œç°åœ¨æˆ‘ä»¬æƒ³æŒ‰ç…§æ“ä½œç³»ç»Ÿçš„ä¸åŒæ¥é€‰æ‹©æ˜¯å¦åœ¨IOCå®¹å™¨é‡Œé¢æ³¨å†Œbeanï¼š</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ(â€œbillâ€)
1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ(â€œlinusâ€)
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ³¨è§£ï¼švalueå€¼ä¼ çš„æ˜¯å®ç°äº†Conditionè¿™ä¸ªæ¥å£çš„ç±»çš„æ•°ç»„</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">({</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">,</span> <span class="nc">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Conditional</span> <span class="o">{</span>

	<span class="cm">/**
	 * All {@link Condition}s that must {@linkplain Condition#matches match}
	 * in order for the component to be registered.
	 */</span>
	<span class="nc">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">Condition</span><span class="o">&gt;[]</span> <span class="nf">value</span><span class="o">();</span>

<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ¡ä»¶">æ¡ä»¶</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * åˆ¤æ–­æ“ä½œç³»ç»Ÿæ˜¯å¦ä¸ºLinuxç³»ç»Ÿ
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">LinuxCondition</span> <span class="kd">implements</span> <span class="nc">Condition</span> <span class="o">{</span>
    <span class="cm">/**
     *  ConditionContext : åˆ¤æ–­æ¡ä»¶èƒ½ä½¿ç”¨çš„ä¸Šä¸‹æ–‡(ç¯å¢ƒ)
     *  AnnotatedTypeMetadata : æ³¨é‡Šä¿¡æ¯
     * @return
     */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">ConditionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//åˆ¤æ–­æ˜¯å¦ä¸ºLinuxç³»ç»Ÿ</span>
        <span class="c1">//1.èƒ½è·å–åˆ°IOCå®¹å™¨é‡Œé¢çš„BeanFactory</span>
        <span class="nc">ConfigurableListableBeanFactory</span> <span class="n">beanFactory</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getBeanFactory</span><span class="o">();</span>

        <span class="c1">//2.è·å–ç±»åŠ è½½å™¨</span>
        <span class="nc">ClassLoader</span> <span class="n">classLoader</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getClassLoader</span><span class="o">();</span>
        <span class="c1">//3.èƒ½è·å–å½“å‰ç¯å¢ƒçš„ä¿¡æ¯</span>
        <span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>
        <span class="c1">//4.è·å–åˆ°beanå®šä¹‰çš„æ³¨å†Œç±»</span>
        <span class="nc">BeanDefinitionRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getRegistry</span><span class="o">();</span>
		 <span class="c1">//å¯ä»¥åˆ¤æ–­å®¹å™¨ä¸­beançš„æ³¨å†Œæƒ…å†µï¼Œä¹Ÿå¯ä»¥ç»™å®¹å™¨ä¸­æ³¨å†Œbean</span>
        <span class="kt">boolean</span> <span class="n">definition</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="na">containsBeanDefinition</span><span class="o">(</span><span class="s">"person"</span><span class="o">);</span>
        <span class="c1">//è·å–æ“ä½œç³»ç»Ÿ</span>
        <span class="nc">String</span> <span class="n">property</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"os.name"</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">property</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"linux"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * åˆ¤æ–­æ“ä½œç³»ç»Ÿæ˜¯å¦ä¸ºWindowsç³»ç»Ÿ
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WindowsCondition</span> <span class="kd">implements</span> <span class="nc">Condition</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">ConditionContext</span> <span class="n">context</span><span class="o">,</span> <span class="nc">AnnotatedTypeMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//3.èƒ½è·å–å½“å‰ç¯å¢ƒçš„ä¿¡æ¯</span>
        <span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>
        <span class="c1">//è·å–æ“ä½œç³»ç»Ÿ</span>
        <span class="nc">String</span> <span class="n">property</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"os.name"</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">property</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"Windows"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>å½“ä¸¤ä¸ªæ¡ä»¶å†™å¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ç»™å®¹å™¨æ³¨å†Œbeanå°±å¯ä»¥å†™äº†ï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>
    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test03</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfig2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">//æˆ‘ä»¬å¯ä»¥è·å–å½“å‰çš„æ“ä½œç³»ç»Ÿæ˜¯ä»€ä¹ˆï¼š</span>
        <span class="nc">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>
        <span class="c1">//åŠ¨æ€çš„è·å–ç¯å¢ƒå˜é‡çš„å€¼ï¼šWindows 7</span>
        <span class="nc">String</span> <span class="n">property</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"os.name"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">property</span><span class="o">);</span>

        <span class="c1">//è·å–IOCå®¹å™¨ç±»å‹ä¸ºPersonç±»å‹çš„beançš„åå­—ä¸€å…±æœ‰å“ªäº›</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">definitionNames</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBeanNamesForType</span><span class="o">(</span><span class="nc">Person</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">definitionNames</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">//æˆ‘ä»¬ä¹Ÿå¯ä»¥æ¥è·å–ç±»å‹ä¸ºPersonç±»å‹çš„å¯¹è±¡</span>
        <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Person</span><span class="o">&gt;</span> <span class="n">persons</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBeansOfType</span><span class="o">(</span><span class="nc">Person</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">persons</span><span class="o">.</span><span class="na">values</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Windows 7
bill
Person{name=â€˜Bill Gatesâ€™, age=62}
</code></pre></div></div>

<h4 id="æ ‡æ³¨ç±»ä¸Š">æ ‡æ³¨ç±»ä¸Š</h4>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Conditional</code> çš„è¿™ä¸ªæ³¨è§£è¿˜å¯ä»¥æ ‡æ³¨åœ¨ç±»ä¸Šï¼Œå¯¹å®¹å™¨ä¸­çš„ç»„ä»¶è¿›è¡Œç»Ÿä¸€è®¾ç½®ï¼šæ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>

</code></pre></div></div>

<h3 id="import">@import</h3>

<ul>
  <li>å¯ä»¥ä½¿ç”¨@importæ³¨è§£ç»™å®¹å™¨ä¸­å¿«é€Ÿå¯¼å…¥ä¸€ä¸ªç»„ä»¶</li>
</ul>

<h4 id="æ–¹æ³•1">æ–¹æ³•1</h4>

<ul>
  <li>ä½¿ç”¨<code class="language-plaintext highlighter-rouge">@Import(Color.class)</code>æ³¨è§£</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="c1">//å¿«é€Ÿå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å</span>
<span class="nd">@Import</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>

    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š
     * 1ï¼‰ã€æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰
     * ã€å±€é™äºè¦æ±‚æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœå¯¼å…¥çš„ç¬¬ä¸‰æ–¹æ²¡æœ‰æ·»åŠ è¿™äº›æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ³¨å†Œä¸ä¸Šäº†ã€‘
     *
     * 2ï¼‰ã€@Bean[å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶]
     * 3ï¼‰ã€@Import[å¿«é€Ÿçš„ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶]ï¼ˆ1ï¼‰ã€ @Import(è¦å¯¼å…¥å®¹å™¨ä¸­çš„ç»„ä»¶);å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨çš„æ³¨			å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
     */</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Color</span> <span class="o">{</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">@Import</code>è¿™ä¸ªæ³¨è§£ä¹Ÿæ˜¯å¯ä»¥å¯¼å…¥å¤šä¸ªç»„ä»¶çš„ï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Target</span><span class="o">(</span><span class="nc">ElementType</span><span class="o">.</span><span class="na">TYPE</span><span class="o">)</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Import</span> <span class="o">{</span>

	<span class="cm">/**
	 * {@link Configuration}, {@link ImportSelector}, {@link ImportBeanDefinitionRegistrar}
	 * or regular component classes to import.
	 */</span>
	<span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">value</span><span class="o">();</span>

<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="c1">//å¿«é€Ÿå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å</span>
<span class="nd">@Import</span><span class="o">({</span><span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">Red</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>


    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š
     * 1ï¼‰ã€æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰
     * ã€å±€é™äºè¦æ±‚æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœå¯¼å…¥çš„ç¬¬ä¸‰æ–¹æ²¡æœ‰æ·»åŠ è¿™äº›æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ³¨å†Œä¸ä¸Šäº†ã€‘
     *
     * 2ï¼‰ã€@Bean[å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶]
     * 3ï¼‰ã€@Import[å¿«é€Ÿçš„ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶] ï¼ˆ1ï¼‰ã€ @Import(è¦å¯¼å…¥å®¹å™¨ä¸­çš„ç»„ä»¶);å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨çš„			æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
     */</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ–¹æ³•2">æ–¹æ³•2</h4>

<ul>
  <li>ä½¿ç”¨importSelectoræ¥å£</li>
  <li>ImportSelectoræ˜¯ä¸€ä¸ªæ¥å£ï¼š<strong>è¿”å›éœ€è¦çš„ç»„ä»¶çš„å…¨ç±»åçš„æ•°ç»„ï¼›</strong></li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ImportSelector</span> <span class="o">{</span>

	<span class="cm">/**
	 * Select and return the names of which class(es) should be imported based on
	 * the {@link AnnotationMetadata} of the importing @{@link Configuration} class.
	 */</span>
	<span class="nc">String</span><span class="o">[]</span> <span class="nf">selectImports</span><span class="o">(</span><span class="nc">AnnotationMetadata</span> <span class="n">importingClassMetadata</span><span class="o">);</span>

<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>è‡ªå®šä¹‰é€»è¾‘è¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶ï¼Œéœ€è¦å®ç° ImportSelector  è¿™ä¸ªæ¥å£ï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//è‡ªå®šä¹‰é€»è¾‘è¿”å›éœ€è¦å¯¼å…¥çš„ç»„ä»¶</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyImportSelector</span> <span class="kd">implements</span> <span class="nc">ImportSelector</span> <span class="o">{</span>
    <span class="c1">//è¿”å›å€¼å°±æ˜¯è¦å¯¼å…¥åˆ°å®¹å™¨ä¸­çš„ç»„ä»¶çš„å…¨ç±»å</span>
    <span class="c1">//AnnotationMetadata ï¼šå½“å‰æ ‡æ³¨@Importæ³¨è§£çš„ç±»çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span><span class="o">[]</span> <span class="nf">selectImports</span><span class="o">(</span><span class="nc">AnnotationMetadata</span> <span class="n">importingClassMetadata</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//æ–¹æ³•ä¸è¦è¿”å›nullå€¼</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]{</span><span class="s">"com.ldc.bean.Blue"</span><span class="o">,</span><span class="s">"com.ldc.bean.Yellow"</span><span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="c1">//å¿«é€Ÿå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å</span>
<span class="nd">@Import</span><span class="o">({</span><span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">Red</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">MyImportSelector</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>


    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š
     * 1ï¼‰ã€æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰
     * ã€å±€é™äºè¦æ±‚æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœå¯¼å…¥çš„ç¬¬ä¸‰æ–¹æ²¡æœ‰æ·»åŠ è¿™äº›æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ³¨å†Œä¸ä¸Šäº†ã€‘
     *
     * 2ï¼‰ã€@Bean[å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶]
     * 3ï¼‰ã€@Import[å¿«é€Ÿçš„ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶]
     *      ï¼ˆ1ï¼‰ã€ @Import(è¦å¯¼å…¥å®¹å™¨ä¸­çš„ç»„ä»¶);å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨çš„æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
     *      ï¼ˆ2ï¼‰ã€ ImportSelector ï¼šè¿”å›éœ€è¦çš„ç»„ä»¶çš„å…¨ç±»åçš„æ•°ç»„ï¼›
     */</span>
<span class="o">}</span>

</code></pre></div></div>

<h4 id="æ–¹æ³•3">æ–¹æ³•3</h4>

<ul>
  <li>ä½¿ç”¨ImportBeanDefinitionRegistraræ¥å£æ‰‹åŠ¨æ·»åŠ bean</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ImportBeanDefinitionRegistrar</span> <span class="o">{</span>

	<span class="cm">/**
	 * Register bean definitions as necessary based on the given annotation metadata of
	 * the importing {@code @Configuration} class.
	 * &lt;p&gt;Note that {@link BeanDefinitionRegistryPostProcessor} types may &lt;em&gt;not&lt;/em&gt; be
	 * registered here, due to lifecycle constraints related to {@code @Configuration}
	 * class processing.
	 * @param importingClassMetadata annotation metadata of the importing class
	 * @param registry current bean definition registry
	 */</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">registerBeanDefinitions</span><span class="o">(</span>
			<span class="nc">AnnotationMetadata</span> <span class="n">importingClassMetadata</span><span class="o">,</span> <span class="nc">BeanDefinitionRegistry</span> <span class="n">registry</span><span class="o">);</span>

<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>å®šä¹‰ä¸€ä¸ªMyImportBeanDefinitionRegistrarç±»å¹¶ä¸”å®ç°ImportBeanDefinitionRegistrarè¿™ä¸ªæ¥å£</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyImportBeanDefinitionRegistrar</span> <span class="kd">implements</span> <span class="nc">ImportBeanDefinitionRegistrar</span> <span class="o">{</span>
    <span class="cm">/**
     *
     * AnnotationMetadata å½“å‰ç±»çš„æ³¨è§£ä¿¡æ¯
     * BeanDefinitionRegistry BeanDefinitionæ³¨å†Œç±»
     *
     * æˆ‘ä»¬æŠŠæ‰€æœ‰éœ€è¦æ·»åŠ åˆ°å®¹å™¨ä¸­çš„beané€šè¿‡BeanDefinitionRegistryé‡Œé¢çš„registerBeanDefinitionæ–¹æ³•æ¥æ‰‹åŠ¨çš„è¿›è¡Œæ³¨å†Œ
     */</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">registerBeanDefinitions</span><span class="o">(</span><span class="nc">AnnotationMetadata</span> <span class="n">importingClassMetadata</span><span class="o">,</span> <span class="nc">BeanDefinitionRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//åˆ¤æ–­IOCå®¹å™¨é‡Œé¢æ˜¯å¦å«æœ‰è¿™ä¸¤ä¸ªç»„ä»¶</span>
        <span class="kt">boolean</span> <span class="n">definition</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="na">containsBeanDefinition</span><span class="o">(</span><span class="s">"com.ldc.bean.Red"</span><span class="o">);</span>
        <span class="kt">boolean</span> <span class="n">definition2</span> <span class="o">=</span> <span class="n">registry</span><span class="o">.</span><span class="na">containsBeanDefinition</span><span class="o">(</span><span class="s">"com.ldc.bean.Blue"</span><span class="o">);</span>
        <span class="c1">//å¦‚æœæœ‰çš„è¯ï¼Œæˆ‘å°±æŠŠRainBowçš„beançš„å®ä¾‹ç»™æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">definition</span> <span class="o">&amp;&amp;</span> <span class="n">definition2</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//æŒ‡å®šbeançš„å®šä¹‰ä¿¡æ¯ï¼Œå‚æ•°é‡Œé¢æŒ‡å®šè¦æ³¨å†Œçš„beançš„ç±»å‹ï¼šRainBow.class</span>
            <span class="nc">RootBeanDefinition</span> <span class="n">rootBeanDefinition</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RootBeanDefinition</span><span class="o">(</span><span class="nc">RainBow</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="c1">//æ³¨å†Œä¸€ä¸ªbeanï¼Œå¹¶ä¸”æŒ‡å®šbeanå</span>
            <span class="n">registry</span><span class="o">.</span><span class="na">registerBeanDefinition</span><span class="o">(</span><span class="s">"rainBow"</span><span class="o">,</span> <span class="n">rootBeanDefinition</span> <span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="c1">//å¿«é€Ÿå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å</span>
<span class="nd">@Import</span><span class="o">({</span><span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">Red</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">MyImportSelector</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">MyImportBeanDefinitionRegistrar</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>


    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š
     * 1ï¼‰ã€æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰
     * ã€å±€é™äºè¦æ±‚æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœå¯¼å…¥çš„ç¬¬ä¸‰æ–¹æ²¡æœ‰æ·»åŠ è¿™äº›æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ³¨å†Œä¸ä¸Šäº†ã€‘
     *
     * 2ï¼‰ã€@Bean[å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶]
     * 3ï¼‰ã€@Import[å¿«é€Ÿçš„ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶]
     *      ï¼ˆ1ï¼‰ã€ @Import(è¦å¯¼å…¥å®¹å™¨ä¸­çš„ç»„ä»¶);å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨çš„æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
     *      ï¼ˆ2ï¼‰ã€ ImportSelector ï¼šè¿”å›éœ€è¦çš„ç»„ä»¶çš„å…¨ç±»åçš„æ•°ç»„ï¼›åœ¨springbootä¸­ç”¨çš„è¾ƒå¤š
     *      ï¼ˆ3ï¼‰ã€ ImportBeanDefinitionRegistrar : æ‰‹åŠ¨æ³¨å†Œbeanåˆ°å®¹å™¨ä¸­
     */</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalRequiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
mainConfig2
com.ldc.bean.Color
com.ldc.bean.Red
com.ldc.bean.Blue
com.ldc.bean.Yellow
bill
rainBow
</code></pre></div></div>

<h3 id="factorybean">FactoryBean</h3>

<ul>
  <li>ä½¿ç”¨FactoryBeanå·¥å‚è¿›è¡Œç»„ä»¶æ³¨å†Œ</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">FactoryBean</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>

	<span class="cm">/**
	 * Return an instance (possibly shared or independent) of the object
	 * managed by this factory.
	 * &lt;p&gt;As with a {@link BeanFactory}, this allows support for both the
	 * Singleton and Prototype design pattern.
	 * &lt;p&gt;If this FactoryBean is not fully initialized yet at the time of
	 * the call (for example because it is involved in a circular reference),
	 * throw a corresponding {@link FactoryBeanNotInitializedException}.
	 * &lt;p&gt;As of Spring 2.0, FactoryBeans are allowed to return {@code null}
	 * objects. The factory will consider this as normal value to be used; it
	 * will not throw a FactoryBeanNotInitializedException in this case anymore.
	 * FactoryBean implementations are encouraged to throw
	 * FactoryBeanNotInitializedException themselves now, as appropriate.
	 * @return an instance of the bean (can be {@code null})
	 * @throws Exception in case of creation errors
	 * @see FactoryBeanNotInitializedException
	 */</span>
	<span class="no">T</span> <span class="nf">getObject</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span><span class="o">;</span>

	<span class="cm">/**
	 * Return the type of object that this FactoryBean creates,
	 * or {@code null} if not known in advance.
	 * &lt;p&gt;This allows one to check for specific types of beans without
	 * instantiating objects, for example on autowiring.
	 * &lt;p&gt;In the case of implementations that are creating a singleton object,
	 * this method should try to avoid singleton creation as far as possible;
	 * it should rather estimate the type in advance.
	 * For prototypes, returning a meaningful type here is advisable too.
	 * &lt;p&gt;This method can be called &lt;i&gt;before&lt;/i&gt; this FactoryBean has
	 * been fully initialized. It must not rely on state created during
	 * initialization; of course, it can still use such state if available.
	 * &lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; Autowiring will simply ignore FactoryBeans that return
	 * {@code null} here. Therefore it is highly recommended to implement
	 * this method properly, using the current state of the FactoryBean.
	 * @return the type of object that this FactoryBean creates,
	 * or {@code null} if not known at the time of the call
	 * @see ListableBeanFactory#getBeansOfType
	 */</span>
	<span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getObjectType</span><span class="o">();</span>

	<span class="cm">/**
	 * Is the object managed by this factory a singleton? That is,
	 * will {@link #getObject()} always return the same object
	 * (a reference that can be cached)?
	 * &lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; If a FactoryBean indicates to hold a singleton object,
	 * the object returned from {@code getObject()} might get cached
	 * by the owning BeanFactory. Hence, do not return {@code true}
	 * unless the FactoryBean always exposes the same reference.
	 * &lt;p&gt;The singleton status of the FactoryBean itself will generally
	 * be provided by the owning BeanFactory; usually, it has to be
	 * defined as singleton there.
	 * &lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; This method returning {@code false} does not
	 * necessarily indicate that returned objects are independent instances.
	 * An implementation of the extended {@link SmartFactoryBean} interface
	 * may explicitly indicate independent instances through its
	 * {@link SmartFactoryBean#isPrototype()} method. Plain {@link FactoryBean}
	 * implementations which do not implement this extended interface are
	 * simply assumed to always return independent instances if the
	 * {@code isSingleton()} implementation returns {@code false}.
	 * @return whether the exposed object is a singleton
	 * @see #getObject()
	 * @see SmartFactoryBean#isPrototype()
	 */</span>
	<span class="kt">boolean</span> <span class="nf">isSingleton</span><span class="o">();</span>

<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>åˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ä¸”å®ç° FactoryBean æ¥å£ï¼š</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//åˆ›å»ºä¸€ä¸ªSpringå®šä¹‰çš„FactoryBean</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ColorFactoryBean</span> <span class="kd">implements</span> <span class="nc">FactoryBean</span><span class="o">&lt;</span><span class="nc">Color</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="c1">//è¿”å›ä¸€ä¸ªColorå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šæ·»åŠ åˆ°å®¹å™¨ä¸­</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Color</span> <span class="nf">getObject</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"ColorFactoryBean...getBean..."</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Color</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">//è¿”å›çš„ç±»å‹</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getObjectType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">//æ§åˆ¶æ˜¯å¦ä¸ºå•ä¾‹</span>
    <span class="c1">// trueï¼šè¡¨ç¤ºçš„å°±æ˜¯ä¸€ä¸ªå•å®ä¾‹ï¼Œåœ¨å®¹å™¨ä¸­ä¿å­˜ä¸€ä»½</span>
    <span class="c1">// false:å¤šå®ä¾‹ï¼Œæ¯æ¬¡è·å–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„bean</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSingleton</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<ul>
  <li>åœ¨é…ç½®ç±»é‡Œé¢è¿›è¡Œé…ç½®ï¼šå¯ä»¥çœ‹åˆ°è¡¨é¢ä¸Šæˆ‘ä»¬è£…é…çš„æ˜¯ColorFactoryBeanè¿™ä¸ªç±»å‹ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘ä»¬è£…é…çš„æ˜¯Colorè¿™ä¸ªbeançš„å®ä¾‹</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="c1">//æ»¡è¶³å½“å‰æ¡ä»¶ï¼Œè¿™ä¸ªç±»ä¸­é…ç½®çš„æ‰€æœ‰beanæ³¨å†Œæ‰èƒ½ç”Ÿæ•ˆ</span>
<span class="nd">@Conditional</span><span class="o">({</span><span class="nc">WindowsCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="c1">//å¿«é€Ÿå¯¼å…¥ç»„ä»¶ï¼Œidé»˜è®¤æ˜¯ç»„ä»¶çš„å…¨ç±»å</span>
<span class="nd">@Import</span><span class="o">({</span><span class="nc">Color</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">Red</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">MyImportSelector</span><span class="o">.</span><span class="na">class</span><span class="o">,</span><span class="nc">MyImportBeanDefinitionRegistrar</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainConfig2</span> <span class="o">{</span>

    <span class="cm">/**
     * @Conditional:æ˜¯SpringBootåº•å±‚å¤§é‡ä½¿ç”¨çš„æ³¨è§£ï¼ŒæŒ‰ç…§ä¸€å®šçš„æ¡ä»¶æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ»¡è¶³æ¡ä»¶ ç»™å®¹å™¨æ³¨å†Œbean
     */</span>

    <span class="cm">/**
     *  ç°åœ¨ä¸‹é¢çš„ä¸¤ä¸ªbeanæ³¨å†Œåˆ°IOCå®¹å™¨æ˜¯è¦æ¡ä»¶çš„ï¼š
     *  1.å¦‚æœç³»ç»Ÿæ˜¯windowsï¼Œç»™å®¹å™¨æ³¨å†Œ("bill")
     *  1.å¦‚æœç³»ç»Ÿæ˜¯linuxï¼Œç»™å®¹å™¨æ³¨å†Œ("linus")
     * @return
     */</span>


    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"bill"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person01</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"Bill Gates"</span><span class="o">,</span><span class="mi">62</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Conditional</span><span class="o">({</span><span class="nc">LinuxCondition</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="nd">@Bean</span><span class="o">(</span><span class="s">"linus"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Person</span> <span class="nf">person02</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Person</span><span class="o">(</span><span class="s">"linus"</span><span class="o">,</span><span class="mi">48</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * ç»™å®¹å™¨ä¸­æ³¨å†Œç»„ä»¶ï¼š
     * 1ï¼‰ã€æ‰«æ+ç»„ä»¶æ ‡æ³¨æ³¨è§£ï¼ˆ@Controller/@Service/@Repository/@Componentï¼‰
     * ã€å±€é™äºè¦æ±‚æ˜¯è‡ªå·±å†™çš„ç±»ï¼Œå¦‚æœå¯¼å…¥çš„ç¬¬ä¸‰æ–¹æ²¡æœ‰æ·»åŠ è¿™äº›æ³¨è§£ï¼Œé‚£ä¹ˆå°±æ³¨å†Œä¸ä¸Šäº†ã€‘
     *
     * 2ï¼‰ã€@Bean[å¯¼å…¥çš„ç¬¬ä¸‰æ–¹åŒ…é‡Œé¢çš„ç»„ä»¶]
     * 3ï¼‰ã€@Import[å¿«é€Ÿçš„ç»™å®¹å™¨ä¸­å¯¼å…¥ä¸€ä¸ªç»„ä»¶]
     *      ï¼ˆ1ï¼‰ã€ @Import(è¦å¯¼å…¥å®¹å™¨ä¸­çš„ç»„ä»¶);å®¹å™¨ä¸­å°±ä¼šè‡ªåŠ¨çš„æ³¨å†Œè¿™ä¸ªç»„ä»¶ï¼Œidé»˜è®¤æ˜¯å…¨ç±»å
     *      ï¼ˆ2ï¼‰ã€ ImportSelector ï¼šè¿”å›éœ€è¦çš„ç»„ä»¶çš„å…¨ç±»åçš„æ•°ç»„ï¼›
     *      ï¼ˆ3ï¼‰ã€ ImportBeanDefinitionRegistrar : æ‰‹åŠ¨æ³¨å†Œbeanåˆ°å®¹å™¨ä¸­
     *
     * 4ï¼‰ã€ä½¿ç”¨Springæä¾›çš„FactoryBeanï¼ˆå·¥å‚beanï¼‰
     *      ï¼ˆ1ï¼‰ã€é»˜è®¤è·å–åˆ°çš„æ˜¯å·¥å‚beanè°ƒç”¨getObjectåˆ›å»ºçš„å¯¹è±¡
     *      ï¼ˆ2ï¼‰ã€è¦è·å–å·¥å‚beanæœ¬èº«ï¼Œæˆ‘ä»¬éœ€è¦ç»™idå‰é¢åŠ ä¸Šä¸€ä¸ªâ€œ&amp;â€ç¬¦å·ï¼š&amp;colorFactoryBean
     */</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">ColorFactoryBean</span> <span class="nf">colorFactoryBean</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">ColorFactoryBean</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test4</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfig2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">printBeans</span><span class="o">(</span><span class="n">applicationContext</span><span class="o">);</span>
        <span class="nc">Object</span> <span class="n">colorFactoryBean</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"colorFactoryBean"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"beançš„ç±»å‹ï¼š"</span><span class="o">+</span><span class="n">colorFactoryBean</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printBeans</span><span class="o">(</span><span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">definitionNames</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBeanDefinitionNames</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">definitionNames</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalRequiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
mainConfig2
com.ldc.bean.Color
com.ldc.bean.Red
com.ldc.bean.Blue
com.ldc.bean.Yellow
bill
colorFactoryBean
rainBow
ColorFactoryBeanâ€¦getBeanâ€¦
beançš„ç±»å‹ï¼šclass com.ldc.bean.Color
</code></pre></div></div>

<h4 id="æ³¨å†Œå·¥å‚æœ¬èº«">æ³¨å†Œå·¥å‚æœ¬èº«</h4>

<ul>
  <li>å¦‚æœæˆ‘ä»¬å°±æƒ³è¦è·å–è¿™ä¸ªå·¥å‚beanï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨idçš„å‰é¢åŠ ä¸Šä¸€ä¸ªâ€&amp;â€ç¬¦å·</li>
</ul>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test4</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ApplicationContext</span> <span class="n">applicationContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AnnotationConfigApplicationContext</span><span class="o">(</span><span class="nc">MainConfig2</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">printBeans</span><span class="o">(</span><span class="n">applicationContext</span><span class="o">);</span>

        <span class="c1">//å·¥å‚beanè·å–çš„æ˜¯è°ƒç”¨getObjectæ–¹æ³•åˆ›å»ºçš„å¯¹è±¡</span>
        <span class="nc">Object</span> <span class="n">colorFactoryBean</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"colorFactoryBean"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"beançš„ç±»å‹ï¼š"</span><span class="o">+</span><span class="n">colorFactoryBean</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>

        <span class="c1">//å¦‚æœæˆ‘ä»¬å°±æƒ³è¦è·å–è¿™ä¸ªå·¥å‚beanï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨idçš„å‰é¢åŠ ä¸Šä¸€ä¸ª"&amp;"ç¬¦å·</span>
        <span class="nc">Object</span> <span class="n">colorFactoryBean2</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="s">"&amp;colorFactoryBean"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"beançš„ç±»å‹ï¼š"</span><span class="o">+</span><span class="n">colorFactoryBean2</span><span class="o">.</span><span class="na">getClass</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printBeans</span><span class="o">(</span><span class="nc">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">String</span><span class="o">[]</span> <span class="n">definitionNames</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBeanDefinitionNames</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">String</span> <span class="n">name</span> <span class="o">:</span> <span class="n">definitionNames</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>org.springframework.context.annotation.internalConfigurationAnnotationProcessor
org.springframework.context.annotation.internalAutowiredAnnotationProcessor
org.springframework.context.annotation.internalRequiredAnnotationProcessor
org.springframework.context.annotation.internalCommonAnnotationProcessor
org.springframework.context.event.internalEventListenerProcessor
org.springframework.context.event.internalEventListenerFactory
mainConfig2
com.ldc.bean.Color
com.ldc.bean.Red
com.ldc.bean.Blue
com.ldc.bean.Yellow
bill
colorFactoryBean
rainBow
ColorFactoryBeanâ€¦getBeanâ€¦
colorFactoryBeançš„ç±»å‹ï¼šclass com.ldc.bean.Color
colorFactoryBean2çš„ç±»å‹ï¼šclass com.ldc.bean.ColorFactoryBean
</code></pre></div></div>

:ET